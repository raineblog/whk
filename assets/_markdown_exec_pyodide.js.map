{"version":3,"file":"_markdown_exec_pyodide.js","names":["_sessions","getSession","name","pyodide","globals","get","writeOutput","element","string","innerHTML","clearOutput","async","evaluatePython","editor","output","session","setStdout","batched","Option","result","code","getValue","runPythonAsync","error","toString","hljs","highlightElement","initPyodide","loadPyodide","loadPackage","getTheme","document","body","getAttribute","setTheme","currentTheme","light","dark","querySelector","removeAttribute","setAttribute","updateTheme","MutationObserver","mutations","forEach","mutation","attributeName","newColorScheme","target","observe","attributes","attributeFilter","setupPyodide","idPrefix","install","themeLight","themeDark","minLines","maxLines","ace","edit","run","getElementById","clear","setMode","setOption","resize","pyodidePromise","length","micropip","pyimport","package","join","onclick","parentElement","addEventListener","event","ctrlKey","key","toLowerCase","preventDefault","click"],"sources":["assets/_markdown_exec_pyodide.js"],"mappings":"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","ignoreList":[],"sourcesContent":["var _sessions = {};\n\nfunction getSession(name, pyodide) {\n    if (!(name in _sessions)) {\n        _sessions[name] = pyodide.globals.get(\"dict\")();\n    }\n    return _sessions[name];\n}\n\nfunction writeOutput(element, string) {\n    element.innerHTML += string + '\\n';\n}\n\nfunction clearOutput(element) {\n    element.innerHTML = '';\n}\n\nasync function evaluatePython(pyodide, editor, output, session) {\n    pyodide.setStdout({ batched: (string) => { writeOutput(output, new Option(string).innerHTML); } });\n    let result, code = editor.getValue();\n    clearOutput(output);\n    try {\n        result = await pyodide.runPythonAsync(code, { globals: getSession(session, pyodide) });\n    } catch (error) {\n        writeOutput(output, new Option(error.toString()).innerHTML);\n    }\n    if (result) writeOutput(output, new Option(result).innerHTML);\n    hljs.highlightElement(output);\n}\n\nasync function initPyodide() {\n    try {\n        let pyodide = await loadPyodide();\n        await pyodide.loadPackage(\"micropip\");\n        return pyodide;\n    } catch(error) {\n        return null;\n    }\n}\n\nfunction getTheme() {\n    return document.body.getAttribute('data-md-color-scheme');\n}\n\nfunction setTheme(editor, currentTheme, light, dark) {\n    // https://gist.github.com/RyanNutt/cb8d60997d97905f0b2aea6c3b5c8ee0\n    if (currentTheme === \"default\") {\n        editor.setTheme(\"ace/theme/\" + light);\n        document.querySelector(`link[title=\"light\"]`).removeAttribute(\"disabled\");\n        document.querySelector(`link[title=\"dark\"]`).setAttribute(\"disabled\", \"disabled\");\n    } else if (currentTheme === \"slate\") {\n        editor.setTheme(\"ace/theme/\" + dark);\n        document.querySelector(`link[title=\"dark\"]`).removeAttribute(\"disabled\");\n        document.querySelector(`link[title=\"light\"]`).setAttribute(\"disabled\", \"disabled\");\n    }\n}\n\nfunction updateTheme(editor, light, dark) {\n    // Create a new MutationObserver instance\n    const observer = new MutationObserver((mutations) => {\n        // Loop through the mutations that occurred\n        mutations.forEach((mutation) => {\n            // Check if the mutation was a change to the data-md-color-scheme attribute\n            if (mutation.attributeName === 'data-md-color-scheme') {\n                // Get the new value of the attribute\n                const newColorScheme = mutation.target.getAttribute('data-md-color-scheme');\n                // Update the editor theme\n                setTheme(editor, newColorScheme, light, dark);\n            }\n        });\n    });\n\n    // Configure the observer to watch for changes to the data-md-color-scheme attribute\n    observer.observe(document.body, {\n        attributes: true,\n        attributeFilter: ['data-md-color-scheme'],\n    });\n}\n\nasync function setupPyodide(\n    idPrefix,\n    install = null,\n    themeLight = 'tomorrow',\n    themeDark = 'tomorrow_night',\n    session = null,\n    minLines = 5,\n    maxLines = 30,\n) {\n    const editor = ace.edit(idPrefix + \"editor\");\n    const run = document.getElementById(idPrefix + \"run\");\n    const clear = document.getElementById(idPrefix + \"clear\");\n    const output = document.getElementById(idPrefix + \"output\");\n\n    updateTheme(editor, themeLight, themeDark);\n\n    editor.session.setMode(\"ace/mode/python\");\n    setTheme(editor, getTheme(), themeLight, themeDark);\n\n    editor.setOption(\"minLines\", minLines);\n    editor.setOption(\"maxLines\", maxLines);\n\n    // Force editor to resize after setting options\n    editor.resize();\n\n    writeOutput(output, \"Initializing...\");\n    let pyodide = await pyodidePromise;\n    if (install && install.length) {\n        try {\n            micropip = pyodide.pyimport(\"micropip\");\n            for (const package of install)\n                await micropip.install(package);\n            clearOutput(output);\n        } catch (error) {\n            clearOutput(output);\n            writeOutput(output, `Could not install one or more packages: ${install.join(\", \")}\\n`);\n            writeOutput(output, new Option(error.toString()).innerHTML);\n        }\n    } else {\n        clearOutput(output);\n    }\n    run.onclick = () => evaluatePython(pyodide, editor, output, session);\n    clear.onclick = () => clearOutput(output);\n    output.parentElement.parentElement.addEventListener(\"keydown\", (event) => {\n        if (event.ctrlKey && event.key.toLowerCase() === 'enter') {\n            event.preventDefault();\n            run.click();\n        }\n    });\n}\n\nvar pyodidePromise = initPyodide();\n"]}