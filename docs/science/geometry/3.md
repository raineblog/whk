# 圆曲初步

## 一般问题

### 圆锥截线

用一平面去截双顶圆锥，得到的截线就是圆锥曲线。

不妨设 $\alpha$ 指母线与轴的夹角（$0<\alpha<90^\circ$），切平面与轴的夹角为 $\beta$（$0\le\beta\le90^\circ$）。

则所得截线的离心率 $e$ 仅由这两个角决定：

$$
e = \dfrac{\cos\beta}{\cos\alpha}
$$

角度—类型—离心率的对照：

- $\beta > \alpha$：椭圆，且 $e < 1$；$\beta = 90^\circ$ 时 $e=0$，为圆。
- $\beta = \alpha$：抛物线，$e = 1$（此时平面与某条母线平行）。
- $\beta < \alpha$：双曲线，$e > 1$（平面切到两片圆锥）。

更加具体的几何构造，由于代数手段可以简单的解决，请自行查阅丹德林球。

![alt text](image-15.png)

离心率与行星运动，以牛顿大炮为例：

- 以第一宇宙速度发射：圆形。

- 大于第一宇宙速度，小于第二宇宙速度：椭圆形。

- 第二宇宙速度：抛物线。

- 大于第二宇宙速度：双曲线。

此处忽略太阳引力的影响。

### 二次曲线

二次曲线（二次平面曲线）是圆锥曲线的别称，本身圆锥曲线就包括我们熟知的椭圆、双曲线、抛物线之外的一些“退化”的图像，但是我们在高中课本中最常讨论的是他们的标准形式，也就是说我们已经将这些退化的图形踢出了，我们为了保持与课本的一定对应关系，我们此处讨论这些退化的，或者更一般的圆锥曲线，统一按照“二次曲线”来称呼。

- 圆锥曲线是平面上满足距某定点（焦点）的距离与距某定直线（准线）的距离之比为常数 $e$ 的点的轨迹。

    其中 $e$ 称为离心率：$e<1$ 为椭圆，$e=1$ 为抛物线，$e>1$ 为双曲线，特殊的 $e=0$ 为圆。

- 圆锥曲线的极坐标定义：

    $$
    \rho=\dfrac{ep}{1\pm e\cos\theta}=\dfrac{L}{1\pm e\cos\theta}
    $$

    这个形式极为简洁，其中 $L$ 为半通径，在椭圆中有 $L=a(1-e^2)$，常在焦点三角形中用到，我们会在那里详细解释。

在笛卡尔坐标系内，二元二次方程的图像可以表示圆锥曲线，并且所有圆锥曲线都以这种方式引出，它的一个标准形式为：

$$
f(x,y)=Ax^2+Bxy+Cy^2+Dx+Ey+F=0
$$

五点作圆锥曲线：

- 我们发现六个系数 $A,B,C,D,E,F$ 齐次于比例，故参数空间是五维。通常情况下，平面上任意五个点，只要没有四个或四个以上的点共线，就能唯一地确定一条圆锥曲线。这条曲线是否退化，取决于这五个点的具体位置。

- 我们不妨带入这五个点（公式略），这是一个有 $5$ 个方程、$6$ 个未知数的齐次线性方程组。根据线性代数理论，这样的方程组总是有非零解。如果解空间的维数是 $1$，那么所有的非零解都是成比例的，它们对应同一条圆锥曲线。

- 五个点唯一确定了一条圆锥曲线。若任意三点不共线，则可以确定唯一一个非退化的圆锥曲线。这五个点的位置关系直接决定了最终曲线的类型。例如，如果五个点构成一个凸五边形，那么它们确定的曲线必定是椭圆。如果一个点“远离”其他四个点，则很可能形成双曲线或抛物线。

一旦通过五个点解出了方程 $Ax^2 + Bxy + Cy^2 + Dx + Ey + F = 0$ 的系数 $A, B, C$，我们就可以通过代数方法来判断其类型。在此之前，我们先引入二次曲线的矩阵形式表达，我们不妨记二次项矩阵为 $Q$：

$$
Q=\bmatrix{A & B/2 \\ B/2 & C}
$$

以及在齐次坐标下的增广矩阵 $M$：

$$
M=\bmatrix{A & B/2 & D/2 \\ B/2 & C & E/2 \\ D/2 & E/2 & F}
$$

这样，二次曲线就可以被表示为：

$$
f(x,y)=\bmatrix{x & y} Q \bmatrix{x \\ y} + \bmatrix{D & E}\bmatrix{x \\ y} + F = 0
$$

或者用齐次坐标下的增广矩阵形式：

$$
f(x,y)=\bmatrix{x & y & 1} M \bmatrix{x \\ y \\ 1} = 0
$$

这里面有经典的三大不变量与一半不变量，我们为了方便书写取一部分（部分字母可能存在差异，这里仅供参考）例如：

$$
\Delta_3=\det M
$$

$$
\Delta_2=\det Q=AC-\dfrac{B^2}{4}
$$

对于后者，我们通常使用它的一个变体，即：

$$
\delta=-4\Delta_2=B^2-4AC
$$

一个二次曲线是否退化是由 $\Delta_3$ 决定的，而其具体的形状是由 $\delta(\Delta_2)$ 决定的：

- 如果 $\Delta_3\neq 0$，则曲线是非退化的（标准的圆锥曲线）。

    - 如果 $\delta<0$ 即 $\Delta_2>0$，则曲线为椭圆。

    - 如果 $\delta=0$ 即 $\Delta_2=0$，则曲线为抛物线。

    - 如果 $\delta>0$ 即 $\Delta_2<0$，则曲线为双曲线。

        特殊的，当 $A+C=0$ 时，其渐近线相互垂直，称为直角双曲线。

- 如果 $\Delta_3=0$，则曲线是退化的（点、一两条线或无图形）。

    - 如果 $\delta<0$ 即 $\Delta_2>0$，一个点或无实数图形。

        这种情况下，通常可以求解中心点坐标 $x_0,y_0$，如果 $f(x_0,y_0)=0$ 就是一个点，否则无实数图形。
    
    - 如果 $\delta=0$ 即 $\Delta_2=0$，两条平行（或重合）直线，或无实数图形。

        由于 $Ax^2+Bxy+Cy^2$ 是一个完全平方，我们知道它是平行直线，且方向向量为 $(\sqrt{C},-\sqrt{A})$，设直线方程为 $\sqrt{A}x+\sqrt{C}y+k=0$，带入原方程消去变量，得到一个关于 $k$ 的二次方程，解出两个 $k$ 即可得到两条平行直线（如果有重根就是一条重合直线，如果无解即为没有实数图形）。

        当 $B=0$ 时，还有一些简单方法，但是意义不大。

    - 如果 $\delta>0$ 即 $\Delta_2<0$，两条相交直线。

        将原方程看作关于 $x$（或 $y$）的二次方程，用求根公式解出 $x$（或 $y$）。

        $$
        \Delta=(By+D)^2-4A(Cy^2+Ey+F)
        $$

        是一个关于 $y$（或 $x$）的完全平方式，开方后会得到两个线性方程。

有一些分类可以用矩阵的秩（$\rank M$）快速解决，但是这过于超纲且难以理解，请自行查阅。

/// note | 对角化

我们知道 $xy$ 项代表坐标轴相对曲线主轴的旋转，旋转角 $\theta$ 记为使新坐标系 $(x',y')$ 下的 $x'y'$ 项系数为零的角度，满足双角公式 $\cot\theta=\dfrac{A-C}{B}$ $\tan 2\theta=\dfrac{B}{A-C}$。我们需要求出新坐标系下的二项次系数，不妨记 $\lambda_1,\lambda_2$ 是矩阵 $Q$ 的特征值，即

$$
\lambda^2-(A+C)\lambda+(AC-B^2/4)=0
$$

或者

$$
\lambda^2-(A+C)\lambda+\Delta_2=0
$$

二次方程变为：

$$
\lambda_1x'^2+\lambda_2y'^2+D'x'+E'y'+F=0
$$

其中 $D',E'$ 是原 $D,E$ 在新坐标系下的分量。

///

/// note | 消除平移

对于有中心对称的曲线（椭圆、双曲线），其中心 $(x_0,y_0)$ 是函数 $f(x,y)$ 的梯度为零的点，我们列出：

$$
\dfrac{\partial f}{\partial x}=2Ax+By+D=0
$$

$$
\dfrac{\partial f}{\partial y}=Bx+2Cy+E=0
$$

解得：

$$
\left\{\begin{aligned}
x_0&=\dfrac{BE-2CD}{B^2-4AC}&=\dfrac{BE-2CD}{\delta}\\
y_0&=\dfrac{BD-2AE}{B^2-4AC}&=\dfrac{BD-2AE}{\delta}
\end{aligned}\right.
$$

注意到 $\delta=0$ 是显然无解的，这再次说明抛物线没有中心。

///

/// note | 标准方程

我们先将任一坐标 $(x,y)$ 旋转 $\theta$，然后将坐标原点平移到 $(x_0,y_0)$，即可得到二次曲线的标准方程：

$$
\lambda_1(x'')^2+\lambda_2(y'')^2+F'=0
$$

常数项可以通过将 $(x_0,y_0)$ 带入原方程得到，也有更优雅的公式：

$$
F'=f(x_0,y_0)=\dfrac{\Delta_3}{\Delta_2}
$$

如果二次曲线是椭圆，则根据上面的方程，其参数 $a,b$ 分别为：

$$
\left\{\environment{aligned}{
a^2&=-\dfrac{\Delta_3}{\lambda_1\Delta_2}\\
b^2&=-\dfrac{\Delta_3}{\lambda_2\Delta_2}
}\right.
$$

然后我们就可以按部就班的求出新坐标系下的焦点坐标（求出 $c$ 即可）：

$$
c^2=|a^2-b^2|=\vert{\dfrac{\Delta_3(\lambda_1-\lambda_2)}{\Delta_2\lambda_1\lambda_2}}=\vert{\dfrac{\Delta_3(\lambda_1-\lambda_2)}{\Delta_2^2}}
$$

将焦点坐标变换回原始坐标系即可：

$$
\pmatrix{x\\y}=\pmatrix{\cos\theta&-\sin\theta\\\sin\theta&\cos\theta}\pmatrix{x''\\ y''}+\pmatrix{x_0\\ y_0}
$$

将 $F_{1,2}''$ 的坐标（注意焦点在哪个坐标轴上）代入上式，即可得到原始坐标系下的焦点坐标。

离心率统一公式：

$$
e={\sqrt {\frac {2{\sqrt {(A-C)^{2}+B^{2}}}}{\eta (A+C)+{\sqrt {(A-C)^{2}+B^{2}}}}}}
$$

此处 $\eta=-\sgn\Delta_3$，即 $\Delta_3$ 为负则 $\eta =1$，否则 $\eta=-1$。

///

### 参数方程

参数方程和函数相似，都是由一些在指定的集合的数，称为参数或自变数，以决定因变数的结果。

我们知道，几何中常见的方程是 $y$ 关于 $x$ 的方程，但是我们也可以将 $x,y$ 均视为因变量，钦定其为关于 $t$ 或 $\theta$ 的方程，称为参数方程。

- 普通方程转为参数方程：利用参数方程，可以很方便的表示不能用函数表达，或者常规的方程难以表达的曲线。

- 参数方程转为普通方程：消去参数，或者将参数用 $x,y$ 表示，然后解没有参数的方程。

参数方程可以用于消元，当两个未知量具有明显的几何意义，可以设出参数方程。

容易知道：

$$
\boxed{\begin{cases}
x&=a+r\cos\theta\\
y&=b+r\sin\theta
\end{cases}}
$$

可以表示一个圆。

容易知道

$$
\boxed{\begin{cases}
x&=a\cos\theta\\
y&=b\sin\theta
\end{cases}}
$$

可以表示一个中心在原点的椭圆。

容易知道

$$
\boxed{\begin{cases}
x&=\dfrac{a}{\cos\theta}\\
y&=b\tan\theta
\end{cases}}
$$

可以表示一个中心在原点的双曲线。

### 仿射变换

我们在坐标系部分讲解了线性变换，我们知道线性变换后

- 直线变换后依然是直线。

- 直线比例保持不变。

- 原点变换后依然是原点。

而我们称仿射变换是指在对一个向量空间进行一次线性变换并接上一个**平移**，变换为另一个向量空间。伸缩、平移、对称等都是仿射变换，

![alt text](image-2.png){ width="80%" }

事实上：

- 平行直线依然平行。

- 共线的点依然共线。

- 直线变换后依然是直线。

- 直线上的线段比例保持不变。

使用一增广矩阵与一增广向量，需要所有向量在其末端扩长 $1$ 且所有矩阵都于底部添加一排零，右边扩长一列转换向量，及右下角添加一个 $1$。

$$
\begin{bmatrix}{\vec {y}}\\1\end{bmatrix}=\left[{\begin{array}{ccc|c}\,&A&&{\vec {b}}\ \\0&\ldots &0&1\end{array}}\right]{\begin{bmatrix}{\vec {x}}\\1\end{bmatrix}}
$$

等价于

$$
\vec {y}=A{\vec {x}}+{\vec {b}}
$$

对于一个椭圆

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1
$$

我们不妨令 $x'=\dfrac{b}{a}x$，则

$$
x'^2+y^2=b^2
$$

我们不妨令 $y'=\dfrac{a}{b}y$，则

$$
x^2+y'^2=a^2
$$

这样就通过伸缩变换将椭圆变成了圆；一般的，我们讨论变换

$$
f:\begin{cases}
x'&=mx\\
y'&=ny
\end{cases}
$$

- 任意面积 $S$ 变为 $nm$ 倍：$S'=nm\cdot S$。

- 有椭圆第三定义。

双曲线也可以用仿射变换，此时令

$$
f:\begin{cases}
x&=ax'\\
y&=biy'
\end{cases}
$$

带入双曲线方程

$$
\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}=x^2+y^2=1
$$

也就是一个单位圆，但是此时引入复数是不完全明智的，可能会存在一些伪证，我们通常需要进行验证才能得到结论，因此双曲线的仿射变换不常用。

## 一般性质

### 切线方程

方法一（判别式）：

- 我们知道相切即有且仅有一个交点，利用判别式：

    设切线为 $y=kx+b$，联立曲线方程，令判别式 $\Delta=0$。

方法二（求导法）：

-  我们令曲线方程为 $F(x,y)=0$，对 $F$ 求导。

- 我们利用导数中讲的隐函数求导：

    将 $y$ 看作 $f(x)$，利用链式法则进行求导。

- 或者更简单的，我们利用偏导：

    $$
    y'=-\dfrac{F_x}{F_y}
    $$

    其中
    
    $$
    \begin{aligned}
    F_x&=\dfrac{\partial F}{\partial x}(x,y)\\
    F_y&=\dfrac{\partial F}{\partial y}(x,y)
    \end{aligned}
    $$

- 对于求导后的结果，带入曲线上的点即可得到曲线在该处的切线。

经过推导，我们得出椭圆的切线方程

$$
\dfrac{x_0x}{a^2}+\dfrac{y_0y}{b^2}=1
$$

同理，双曲线的切线方程

$$
\dfrac{x_0x}{a^2}-\dfrac{y_0y}{b^2}=1
$$

对于一般的圆锥曲线

$$
Ax^2+Bxy+Cy^2+Dx+Ey+F=0
$$

其切线方程就是

$$
Ax_0x+B\cdot\dfrac{x_0y+xy_0}{2}+Cy_0y+D\cdot\dfrac{x_0+x}{2}+E\cdot\dfrac{y_0+y}{2}+F=0
$$

也就是说我们替换

$$
\begin{cases}
x^2&\gets x_0x\\
y^2&\gets y_0y\\
x&\gets\dfrac{x_0+x}{2}\\
y&\gets\dfrac{y_0+y}{2}\\
xy&\gets\dfrac{x_0y+xy_0}{2}
\end{cases}
$$

得到的就是 $F$ 在 $(x_0,y_0)$ 处的切线方程。

切点弦方程：设过椭圆外一点 $A=(x_0,y_0)$ 有椭圆的切线 $AB,AC$，其中 $B=(x_1,y_1),C=(x_2,y_2)$ 为切点，则 $BC$ 的方程也为

$$
\dfrac{x_0x}{a^2}+\dfrac{y_0y}{b^2}=1
$$

证明：根据 $AB,AC$ 是切线，列出 $AB,AC$ 的直线方程

$$
\begin{cases}
\dfrac{x_1x}{a^2}+\dfrac{y_1y}{b^2}=1\\
\dfrac{x_2x}{a^2}+\dfrac{y_2y}{b^2}=1\\
\end{cases}
$$

我们知道 $A(x_0,y_0)$ 在这两条直线上，因此带入 $(x,y)=(x_0,y_0)$

$$
\begin{cases}
\dfrac{x_1x_0}{a^2}+\dfrac{y_1y_0}{b^2}=1\\
\dfrac{x_2x_0}{a^2}+\dfrac{y_2y_0}{b^2}=1\\
\end{cases}
$$

因此不妨令直线

$$
\dfrac{x_0x}{a^2}+\dfrac{y_0y}{b^2}=1
$$

则一定有 $B(x_1,y_1),C(x_2,y_2)$ 一定在这条直线上。

### 距离定义

1. 到两定点的距离之商为定值（不等于 $1$）的点的轨迹是阿波罗尼斯圆；
2. 到两定点的距离之和为定值（大于两定点的距离）的点的轨迹是椭圆；
3. 到两定点的距离之差的绝对值为定值（大于 $0$ 且小于两定点的距离）的点的轨迹是双曲线；
4. 到两定点的距离之积为定值（该定值为正数）的点的轨迹是卡西尼卵形线。

阿波罗尼斯圆（简称阿氏圆）已知平面上两点 $A,B$，则所有满足 $PA/PB=k$（$k\neq1$）的点 $P$ 的轨迹是一个圆。

$$
\boxed{\dfrac{(x-x_a)^2+(y-y_a)^2}{(x-x_b)^2+(y-y_b)^2}=k^2}
$$

整理可以得到圆的方程，但是阿波罗尼斯圆的常见找法是，在 $AB$ 所在直线上找到满足条件的两个点，以两点中点为圆心作圆即可。

阿氏圆的性质：$\triangle POA\backsim\triangle POB$，根据相似。

卡西尼卵形线，是平面内到两个定点的距离之积为常数的点的轨迹，我们不妨设两顶点 $F_1=(-c,0),F_2=(c,0)$，曲线上的点 $P(x,y)$ 满足

$$
|PF_1|\cdot|PF_2|=b^2
$$

卵形线的形状与比值 $b/c$ 有关：

- 如果 $b/c$ 大于 $1$，则轨迹是一条闭曲线。

- 如果 $b/c$ 小于 $1$，则轨迹是两条不相连的闭曲线。

- 如果 $b/c$ 等于 $1$，则是伯努利双扭线。

![](Cassini-3kurv.svg){ width="60%" }

伯努利双纽线的形状类似无穷大的符号，是双曲线关于圆心在双曲线中心的圆的反演图形。

![](992px-Lemniskate_hyperbel.svg.png){ width="80%" }

### 光学性质

费马原理：当一束光经过镜子的反射，那么入射角等于出射角，可以证明，这个路径是最短的。

/// details | 证明
设光线从 $F_1$ 经过直线 $\ell$ 的反射到达 $F_2$ 点，我们将 $F_1$ 关于 $\ell$ 对称的点设为 $F_1'$

![alt text](image-10.png){ width="40%" }

则 $P$ 点位于 $F_1'F_2$ 与 $\ell$ 的交点上，这就是将军饮马模型，也容易证明，入射角和出射角是相等的。
///

椭圆的光学性质：从一个焦点发出的光线，经过椭圆的反射后一定经过另一个焦点。

/// details | 证明
如图，容易知道，我们只需要证明 $\angle DAF_1=\angle DAF_2$ 即可，

![alt text](image-3.png){ width="60%" }

根据角平分线逆定理，只需要证

$$
\dfrac{AF_1}{AF_2}=\dfrac{MF_1}{MF_2}
$$

但是这比较复杂，我们发现费马定理可以非常容易的解决这个问题。

![alt text](image-11.png){ width="40%" }

不妨设 $X$ 是 $\ell$ 上任意一点，则根据 $P$ 在椭圆上、$X$ 在椭圆外，

$$
XF_1+XF_2\ge PF_1+PF_2
$$

取等当且仅当 $P=X$，因此 $P$ 就是费马定理的点，符合入射角等于出射角。
///

抛物线的光学性质：从焦点发出的光线，经过抛物线的反射后，一定平行于抛物线的轴。

/// details | 证明
假设 $P$ 为抛物线上一点，做到准线的垂线，垂足为 $P'$，如图

![alt text](image-9.png){ width="40%" }

我们不妨证明锅 $P$ 点的切线 $\ell$ 恰好平分 $\angle FPP'$。

不妨假设角平分线 $\ell'$ 与抛物线相交与 $P,Q$ 两点，做 $QQ'$ 垂直于准线。根据抛物线的定义，有 $FP=PP'$，因此也有 $QF=QP'$，又因为 $FQ=QQ'$，因此 $P=Q$，即 $\ell=\ell'$，证毕。

我们也可以证明角相等，

![alt text](image-8.png){ width="60%" }

不难得到，只需要证 $\angle FPQ=\angle FQP$ 即可。

不妨证明 $FP=FQ$，容易想到，列出直线方程直接求解，得到点的坐标即可。
///

双曲线的光学性质：从一个焦点发出的光线，经过双曲线的发射后反向延长经过另一个焦点。

/// details | 证明
与椭圆类似，我们取作差的将军饮马模型，即延长线上的点最小。

与抛物线类似，我们用两边之差小于第三边，也可以证明。
///

椭圆的旁心：在椭圆上任取两点 $P,Q$，做 $F_1PF_2,F_1QF_2$ 的外角角平分线，根据光学性质，也就是说 $PR,QR$ 都是椭圆的切线，交于一点 $R$，连接 $RF_1$，则 $RF_1\perp PQ$。

证明：我们知道 $R$ 是一个旁切圆的圆心，与 $PQ$ 相切与 $F'$（我们要证明它和 $F_1$ 重合），设椭圆与 $F_2P,F_2Q$ 相切于 $X,Y$，则 $F'P+PF_2=XF_2$，$F'Q+QF_2=YF_2$，因为 $RX=RY$ 所以 $XF_2=YF_2$，因此 $F'=F_1$ 即为椭圆焦点。

## 椭圆

### 第一定义

到两个定点 $F_1$、$F_2$ 的距离之和为定值（大于 $|F_1F_2|$）的点所形成的轨迹称为椭圆。这两个定点叫做椭圆的焦点，两焦点间的距离叫做椭圆的焦距，焦距的一半称为半焦距。

我们不妨设 $F_1=(-c,0),F_2=(c,0)$ 为焦点的椭圆经过 $M$ 点，且 $M$ 到 $F_1,F_2$ 的局里之和为 $2a$，其中 $a>c$，那么写出方程：

$$
\sqrt{(x-c)^2+y^2}+\sqrt{(x+c)^2+y^2}=2a
$$

我们把一个根号移到另一侧，然后两边平方，整理后再平方，可以得到：

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{a^2-c^2}=1
$$

不妨令 $b=\sqrt{a^2-c^2}$，那么**椭圆的标准方程**：

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1(a>b>0)
$$

这个椭圆的焦点在 $x$ 轴上，容易知道焦点在 $y$ 轴上的椭圆

$$
\dfrac{x^2}{b^2}+\dfrac{y^2}{a^2}=1(a>b>0)
$$

注意 $c^2=a^2-b^2$ 这个式子很重要。

容易知道椭圆上一点 $P$，横坐标为 $x_0$，到两个焦点 $F_1,F_2$ 的距离分别为

$$
PF_1=a+\dfrac{c}{a}x_0=a+ex_0
$$

$$
PF_2=a-\dfrac{c}{a}x_0=a-ex_0
$$

### 第二定义

到一定点 $F_1$ 的距离与到一定直线的距离之比为定值（小于 $1$）的点所形成的轨迹称为椭圆。该定直线称为准线。

我们不妨设 $F_1=(c,0),F_2=(-c,0)$，同样还有一个 $a$ 那么：

$$
\sqrt{(x-c)^2+y^2}+\sqrt{(x+c)^2+y^2}=2a
$$

不妨写出这个式子的共轭根式，

$$
\sqrt{(x-c)^2+y^2}-\sqrt{(x+c)^2+y^2}=\dfrac{2cx}{a}
$$

容易知道他们的乘积就是 $4cx$，因此写出其共轭根式为上式，联立两式，不难得到

$$
\sqrt{(x-c)^2+y^2}=\dfrac{c}{a}\vert{x-\dfrac{a^2}{c}}
$$

容易知道准线方程为

$$
x=\dfrac{a^2}{c}
$$

因为我们是取的右焦点，因此这个准线也称为右准线；同理取左焦点

$$
x=-\dfrac{a^2}{c}
$$

称为左准线，而比值就是 $\dfrac{c}{a}$，这称为离心率，我们后面再说。

### 几何性质

我们注意到对于

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1(a>b>0)
$$

有

$$
x^2=a^2\paren{1-\dfrac{y^2}{b^2}}
$$

因此

$$
-a\le x\le a
$$

同理

$$
-b\le y\le b
$$

也就是说，椭圆整个图形都在一个中心在原点、长为 $b$ 高为 $a$ 的矩形中心，矩形与椭圆焦点分为上下左右四个。

椭圆有两条对称轴（两个坐标轴）和一个对称中心（原点）。

椭圆的离心率，定义为

$$
e=\dfrac{c}{a}=\sqrt{1-\dfrac{b^2}{a^2}}\in(0,1)
$$

特别的，圆的离心率为零；离心率越大，椭圆越扁平。

通径：我们过一个焦点，做焦点连线的垂线，与椭圆交于两点 $P,Q$，这个线段称为椭圆的通径，有公式

$$
PQ=\dfrac{2b^2}{a}
$$

上述结论可以作如下推广：过焦点 $F$ 作 $n$ 条夹角相等的射线交椭圆于 $P_1, P_2, \cdots, P_n$，则

$$
\frac{1}{|FP_1|} + \frac{1}{|FP_2|} + \cdots + \frac{1}{|FP_n|} = \frac{na}{b^2}
$$

椭圆的面积：$S=\pi ab$（$a,b$ 分别为长半轴、短半轴的长）。

证明：根据仿射变换显然。或利用微积分，此处略。

### 第三定义

第三定义，即点差法。在椭圆

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1
$$

上，有两个点 $P,Q$，设 $M$ 为 $PQ$ 中点，则

$$
k_{PQ}=-\dfrac{b^2}{a^2}\cdot\dfrac{x_M}{y-M}
$$

反过来，若直线 $PQ$ 的斜率为 $k$，则 $M$ 在定直线

$$
\ell:\dfrac{x}{a^2}+\dfrac{ky}{b^2}=0
$$

上，也可以说，$PQ$ 与 $OM$ 斜率之积

$$
k_{PQ}\cdot k_{OM}=-\dfrac{b^2}{a^2}
$$

证明即“点差”设出点的坐标，然后做差。

/// details | 证明
不妨设

$$
P(x_1,y_1),Q(x_2,y_2)
$$

因此

$$
\begin{cases}
\dfrac{x_1^2}{a^2}+\dfrac{y_1^2}{b^2}&=1\\
\dfrac{x_2^2}{a^2}+\dfrac{y_2^2}{b^2}&=1
\end{cases}
$$

做差，得到

$$
(x_1-x_2)\cdot\dfrac{x_1+x_2}{a^2}+(y_1-y_2)\cdot\dfrac{y_1+y_2}{b^2}=0
$$

根据中点

$$
\begin{cases}
x_1+x_2&=2x_M\\
y_1+y_2&=2y_M
\end{cases}
$$

因此

$$
(x_1-x_2)\cdot\dfrac{x_M}{a^2}+(y_1-y_2)\cdot\dfrac{y_M}{b^2}
$$

又因为斜率

$$
k=\dfrac{y_1-y_2}{x_1-x_2}
$$

因此就有

$$
\dfrac{x_M}{a^2}+k\cdot\dfrac{y_M}{b^2}=0
$$

即为上面第二条结论，整理得第一条结论。
///

可以根据仿射变换轻松得到，因此我们类比，如果 $AB$ 过抛物线中心（类似于圆心），$P$ 是椭圆上异于 $A,B$ 的一个点，则

$$
k_{PA}\cdot k_{PB}=-\dfrac{b^2}{a^2}
$$

已知动直线 $\ell$ 与椭圆 $\dfrac{x^2}{A^2} + \dfrac{y^2}{B^2} = 1$ 交于 $P(x_1, y_1)$， $Q(x_2, y_2)$ 两个不同的点，且 $\triangle OPQ$ 的面积记为 $S_{\triangle OPQ}$，其中 $O$ 为坐标原点。我们有如下的框架图：

$$
\begin{cases}
k_{OP} \cdot k_{OQ} = -\dfrac{B^2}{A^2}\\
S_{\triangle OPQ} = \dfrac{1}{2}AB\\
y_1^2 + y_2^2 = B^2\\
x_1^2 + x_2^2 = A^2
\end{cases}
$$

已知 $E(x_0, y_0)$ 是椭圆 $\dfrac{x^2}{A^2} + \dfrac{y^2}{B^2} = 1$ 上任意一点，从原点 $O$ 引圆 $E:(x-x_0)^2+(y-y_0)^2=r^2$ 的两条切线，分别交椭圆于 $P, Q$ 两点。若 $x_0^2 \ne r^2$，则我们有如下的三个互为等价的结论：

$$
\begin{cases}
\dfrac{1}{A^2} + \dfrac{1}{B^2} = \dfrac{1}{r^2} \\
S_{\triangle OPQ} = \dfrac{1}{2}AB \\
k_{OP} \cdot k_{OQ} = -\dfrac{B^2}{A^2}
\end{cases}
$$

此外还可以推导出：

$$
|OP|^2 + |OQ|^2 = A^2 + B^2
$$

这个结论并非等价，有很多条件也能推出来。

已知椭圆 $C: \dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} = 1(a>b>0)$，不过原点 $O$ 的直线 $\ell$ 与椭圆 $C$ 相交于 $A,B$ 两点，设 $OA, \ell, OB$ 的斜率分别为 $k_1, k, k_2$。则有：

$$
k_1 \cdot k_2 = k^2\implies|OA|^2 + |OB|^2 = a^2 + b^2
$$

### 等角共轭

椭圆的等角共轭：过椭圆外一点 $P$ 做切线 $PX,PY$，切点为 $X,Y$。连接 $PF_1,PF_2$，则 $\angle XPF_1=\angle YPF_2$。

![alt text](image-12.png){ width="50%" }

我们将 $F_1,F_2$ 分别关于 $PX,PY$ 对称，得到 $F_1',F_2'$，根据初中几何容易知道，$\triangle PF_1'F_2\cong\triangle PF_1F_2'$，两顶角减去公共部分 $\angle F_1PF_2$，即可得到。

根据已经证明的全等，因此 $\angle PF_1X = \angle PF_1'F_2 = \angle PF_1F_2' = \angle PF_1Y$，也就是说对于曲线外一点 $P$ 与焦点的连线一定平分两个切点与这个焦点所构成的角。

双曲线有着类似的性质，但是需要注意切点是否位于同一分支上。

![alt text](image-13.png){ width="40%" }

此时有 $\angle F_1PX = \pi - \angle F_2PY$。

蒙日圆：若过椭圆外一点 $P$ 做椭圆的两条切线相互垂直，则 $P$ 的轨迹为一个圆，轨迹方程为

$$
x^2+y^2=a^2+b^2
$$

证明：不妨做 $F_1$ 关于 $PX$ 的对称点 $F_1'$，不难得到 $\angle F_1'PF_2=\angle XPY=90^\circ$，

![alt text](image-14.png){ width="40%" }

又因为 $PF_1'=PF_1$，也就是说只需要令

$$
PF_1^2+PF_2^2=F_1F_2^2
$$

即可，我们设 $P(x,y)$，而 $F_1F_2=2a$，带入得

$$
(x+c)^2+y^2+(x-c)^2+y^2=4a^2
$$

整理即可得到上面的轨迹方程。

对双曲线而言，这样的圆并不总存在。当双曲线的两条渐近线所成角为锐角时，该圆的半径为虚数；若两条渐近线互相垂直，则该圆退化为双曲线的中心这一点。

还有一些奇怪的结论。

- 过点 $P$ 作圆锥曲线的两条切线，若两切线的斜率之积为定值，则点 $P$ 的轨迹为某一圆锥曲线。

- 将一根绳子套在椭圆 $\alpha$ 上，并用铅笔把绳子绷紧。若使铅笔绕着椭圆转动，则它将描出另一条与 $\alpha$ 同焦的椭圆。

- 一条椭圆内接于一个凸四边形，且它的两个焦点分别落在该四边形的两条（不同的）对角线上，则该四边形两对对边长度的乘积相等。

## 双曲线

### 第一定义

到两定点 $F_1,F_2$ 距离之差的绝对值为常数（小于 $|F_1F_2|$）的点的轨迹称为双曲线。

与椭圆类似，我们设左焦点 $F_1=(-c,0)$ 和右焦点 $F_2=(c,0)$，距离之差为 $2a$，其中 $c>a>0$，有双曲线的一般方程

$$
\dfrac{x^2}{a^2}-\dfrac{y^2}{c^2-a^2}=1
$$

同样，令 $b=\sqrt{c^2-a^2}$ 即 $c^2=a^2+b^2$。

$$
\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}=1
$$

### 第二定义

到一定点 $F_1$ 的距离与到一定直线的距离之比为定值（大于 $1$）的点所形成的轨迹称为双曲线。该定直线称为准线。

与抛物线一样，我们可以得到

$$
\sqrt{(x-c)^2+y^2}=\dfrac{c}{a}\vert{x-\dfrac{a^2}{c}}
$$

但是此时 $\dfrac{c}{a}$ 应当是大于 $1$ 的，同理

$$
\sqrt{(x+c)^2+y^2}=\dfrac{c}{a}\vert{x+\dfrac{a^2}{c}}
$$

前者是右焦点与右准线，后者是左焦点与左准线，准线方程依旧是

$$
x=\pm\dfrac{a^2}{c}
$$

比值就是 $\dfrac{c}{a}$，这称为离心率，我们后面再说。

### 第三定义

双曲线的第三定义的主要区别在于，在椭圆的公式中去掉负号即可。

- $M,N$ 是双曲线 $C:\dfrac{x^2}{A^2}-\dfrac{y^2}{B^2}=\pm1$ 上的两点，则 $P$ 是 $MN$ 的中点，等价于

    $$
    k_{MN} \cdot k_{OP} = \dfrac{B^2}{A^2}
    $$

- 已知直线 $y=kx+m$ 与双曲线 $C: \dfrac{x^2}{A^2} - \dfrac{y^2}{B^2} = 1$ 的渐近线交于 $M, N$ 两点，则 $P$ 是 $MN$ 的中点，等价于

    $$
    k_{MN} \cdot k_{OP} = \dfrac{B^2}{A^2}
    $$

    令 $M(x_1, y_1), N(x_2, y_2)$，点 $M, N$ 在渐近线上，可得

    $$
    \begin{cases}
    \dfrac{x_2^2}{a^2} - \dfrac{y_2^2}{b^2} = 0 \\
    \dfrac{x_1^2}{a^2} - \dfrac{y_1^2}{b^2} = 0
    \end{cases}
    \implies \dfrac{y_2^2 - y_1^2}{x_2^2 - x_1^2} = \dfrac{b^2}{a^2} \implies \dfrac{y_2 - y_1}{x_2 - x_1} \cdot \dfrac{y_2 + y_1}{x_2 + x_1} = \dfrac{b^2}{a^2}
    $$

    由此可知 $k_{OP} \cdot k_{MN} = \dfrac{b^2}{a^2}$。

### 几何性质

我们知道

$$
x^2=a^2\paren{1+\dfrac{y^2}{b^2}}
$$

因此

$$
|x|\ge a
$$

即 $x\ge a$ 或 $x\le-a$，而 $y$ 为实数。

双曲线有两个顶点，左顶点 $A_1=(-a,0)$ 和右顶点 $A_2=(a,0)$，线段 $A_1A_2$ 称为实轴，$a$ 称为实半轴长。

另外，设 $B_1=(0,b)$ 和 $B_2=(0,-b)$，则 $B_1B_2$ 称为虚轴，目前来说这个 $b$ 没有什么特殊意义。

特别的，如果 $a=b$，则这个双曲线称为等轴双曲线。

双曲线有对称轴为坐标轴，对称中心为坐标原点。

双曲线有两条渐近线

$$
y=\pm\dfrac{b}{a}x
$$

也就是

$$
\dfrac{y}{b}\pm\dfrac{x}{a}=0
$$

或者

$$
\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}=0
$$

双曲线的离心率，定义为

$$
e=\dfrac{c}{a}=\sqrt{1+\dfrac{b^2}{a^2}}>1
$$

离心率越大，双曲线的开口越大。

### 双曲函数

双曲函数因为其性质极其类似三角函数，因此也称为双曲三角函数。

我们知道三角函数 $\sin\theta,\cos\theta$ 是在单位圆上引入一条倾角为 $\theta$ 的直线，与单位圆相交的点的坐标即为 $(\cos\theta,\sin\theta)$，类似的我们推出双曲函数的最初定义：倾角为 $\theta$ 的直线与双曲线 $x^2-y^2=1$ 交于点 $(\cosh\theta,\sinh\theta)$。

$$
\sinh x=\dfrac{e^x-e^{-x}}{2}
$$

$$
\cosh x=\dfrac{e^x+e^{-x}}{2}
$$

$$
\tanh x=\dfrac{\sinh x}{\cosh x}=\dfrac{e^x-e^{-x}}{e^x+e^{-x}}
$$

其图像如图

![](./Sinh_cosh_tanh.svg){ width="60%" }

我们在复数部分推导了欧拉公式，因此不难知道

$$
\begin{cases}
\cos x&=\cosh(ix)\\
\sin x&=-i\sinh(ix)
\end{cases}
$$

我们利用这个可以从三角函数的几乎所有公式迁移到双曲函数。

$$
\cosh^2x-\sinh^2x=1
$$

$$
\sinh(x\pm y)=\sinh x\cosh y\pm \cosh x\sinh y
$$

$$
\cosh(x\pm y)=\cosh x\cosh y\pm\sinh x\sinh y
$$

$$
\tanh (x\pm y)=\frac{\tanh x\pm \tanh y}{1\pm \tanh x\tanh y}
$$

$$
\sinh 2x=2\sinh x\cosh x
$$

$$
\cosh 2x=\cosh^2x+\sinh^2x
$$

$$
\tanh 2x=\frac{2\tanh x}{1+\tanh^2x}
$$

$$
(\sinh x)'=\cosh x
$$

$$
(\cosh x)'=\sinh x
$$

## 抛物线

### 一般方程

平面内与一个定点 $F$ 和一条定直线 $\ell$（不过 $F$）的距离相等的点的轨迹叫做抛物线。点 $F$ 叫做抛物线的焦点，直线 $\ell$ 叫做抛物线的准线。

![alt text](<desmos-graph (6).svg>){ width="40%" }

不妨设 $F$ 到准线的距离（焦准距）为 $p$ 且垂足为 $K$，容易知道，抛物线的顶点就是 $FK$ 的中点，即 $F=\paren{\dfrac{p}{2},0},K=\paren{-\dfrac{p}{2},0}$，不难得到抛物线的标准方程为

$$
y^2=2px(p>0)
$$

这个是开口朝向 $x$ 轴正半轴的，同理我们还有另外四个方向。

### 简单性质

对于抛物线

$$
y^2=2px(p>0)
$$

有 $x\ge0$，且关于 $y=0$ 对称，没有对称中心。

容易知道，二次函数

$$
f(x)=a^2+bx+c(a\neq0)
$$

就是一条抛物线且定点为

$$
\paren{-\dfrac{b}{2a},f\paren{-\dfrac{b}{2a}}}
$$

注意：抛物线的离心率恒为 $1$，而焦准距则衡量了开口大小。

### 特征梯形

过焦点的直线交抛物线与点 $A,B$ 过 $A,B$ 做准线 $\ell$ 的垂线 $AC,BC$，锁围成的直角梯形称为抛物线的特征直角梯形。

![alt text](image-1.png){ width="50%" }

$$
\angle CED=90^\circ
$$

$$
CF\cdot DF=EF^2
$$

$$
\angle AFE=\angle BFE
$$

证明，显然。

此外

$$
AB=\dfrac{2p}{\sin^2\angle AEF}
$$

即焦点弦公式。

![alt text](image-40.png)

![alt text](image-41.png)

![alt text](image-42.png)

![alt text](image-43.png)

![alt text](image-44.png)

![alt text](image-45.png)

![alt text](image-46.png)

### 几何性质

1. 抛物线的焦点关于任意一条切线的对称点一定在准线上。

    证明：做 $PP'\perp\ell$，根据椭圆的性质，$FP=PP'$。
    
    ![alt text](image-16.png){ width="40%" }

    因为 $FP'\perp\ell'$，因此 $\ell'$ 是 $\angle FPP'$ 角平分线，所以，$F$ 关于 $\ell'$ 的反射点即为 $P'$ 在准线上。

    推论：抛物线的焦点到其各条切线的投影点，均位于抛物线顶点处的切线上。

2. 假设抛物线在点 $X$ 和 $Y$ 的切线相交于点 $P$。那么 $PX'=PY'=PF$，其中 $X'$ 和 $Y'$ 是 $X$ 和 $Y$ 在抛物线准线上的投影，而 $F$ 是抛物线的焦点。

    证明：根据上一条，这两条切线分别是线段 $FX'$ 和 $FY'$ 的中垂线。因此，它们的交点即为三角形 $FX'Y'$ 的外接圆圆心。

    ![alt text](image-17.png){ width="90%" }

    推论：如果 $PX$ 和 $PY$ 是抛物线的切线，那么点 $P$ 在准线上的投影，是 $X$ 和 $Y$ 在准线上的投影点所构成线段的中点。

3. 做抛物线上两点 $X,Y$ 的切线，相交于点 $P$，若 $PX\perp PY$，则 $P$ 在抛物线的准线上。反过来，过准线上一点 $P$ 做抛物线的两条切线，则他们相互垂直。同时，$XY$ 一定过焦点 $F$ 且 $PF\perp XY$。

    证明：设 $X',Y'$ 为 $X,Y$ 到准线上的投影，因为 $P$ 在准线上，

    ![alt text](image-18.png){ width="40%" }
    
    那么 $XF=XX',YF=YY'$，因此可以得到两个三角形全等，那么 $\angle XPY=90^\circ$。

4. 我们做推广，两条切线为 $\varphi$ 或 $180^\circ-\varphi$ 的点的集合是一个以 $F$ 焦点，抛物线准线 $\ell$ 为准线的双曲线，其离心率等于 $|\cos\varphi|$。

    ![alt text](image-19.png){ width="40%" }

    注意到 $P$ 为 $\triangle FX'Y'$ 外心，因此 $\angle X'PY'=360^\circ-2\varphi$，那么 $P$ 到准线的距离为 $PF|\cos(180^\circ-\varphi)|=PF|\cos\varphi|$，证毕。

5. 设 $PX$ 和 $PY$ 为过点 $P$ 的抛物线的两条切线，并设 $l$ 为过 $P$ 且平行于抛物线轴的直线。那么直线 $PY$ 与 $l$ 的夹角等于 $\angle XPF$，且 $\triangle XFP\backsim\triangle PFY$。由此可推知，$FP$ 是角 $XFY$ 的角平分线。

    设 $X'$ 和 $Y'$ 是 $X$ 和 $Y$ 在准线上的投影。那么，点 $F$、$X'$ 和 $Y'$位于一个以 $P$ 为圆心的圆上，
    
    ![alt text](image-20.png){ width="40%" }

    因此 $\angle X'Y'F = \dfrac{1}{2}\angle X'PF = \angle XPF$。因为 $\ell$ 垂直于 $X'Y'$，因此 $PY$ 与 $\ell$ 的夹角等于 $Y'F$ 与 $X'Y'$ 的夹角，而 $Y'F$ 垂直于 $PY$。

    由于 $l$ 平行于 $YY'$，$PY$ 与 $l$ 的夹角等于角 $PYY'$，根据光学性质，该角等于角 $FYP$。因此 $\angle FYP = \angle XPF$。类似地，$\angle FXP = \angle YPF$。因此 $\triangle XFP\backsim\triangle PFY$。 

6. 假设 $\triangle ABC$ 外切于一条抛物线，即直线 $AB$，$BC$，$CA$ 均与抛物线相切，那么 $\triangle ABC$ 的垂心始终过抛物线的准线。

    ![alt text](image-22.png){ width="40%" }

    兰伯特定理：由抛物线的三条切线所围成的三角形，其外接圆必经过抛物线的焦点。

    西姆松定理：点 $P$ 到 $\triangle ABC$ 各边的投影共线，当且仅当 $P$ 位于该三角形的外接圆上。

    斯坦纳线定理：一个三角形外接圆上任意一点（该点不为三角形顶点）关于三角形三边的对称点，这三个对称点是共线的，并且这条直线（称为斯坦纳线）必经过该三角形的垂心。
