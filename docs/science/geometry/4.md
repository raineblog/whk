# 解析几何

## 联立直线

双曲线联立直线，一定要先把一般方程化为整式。

注意直线不一定都可以表示为 $y=kx+b$，平行于 $y$ 轴的斜率不存在。

### 椭圆与直线

椭圆与直线有三种情况，相切、相交、相离

我们设椭圆的一般方程

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1
$$

不妨先化为整式

$$
b^2x^2+a^2y^2=a^2b^2
$$

设直线方程为 $y=kx+m$，带入

$$
\begin{aligned}
b^2x^2+a^2(kx+m)^2&=a^2b^2\\
b^2x^2+a^2(k^2x^2+m^2+2kmx)&=a^2b^2
\end{aligned}
$$

化简得到

$$
(b^2+a^2k^2)x^2+2kma^2x+a^2m^2-a^2b^2=0
$$

我们知道

$$
\begin{aligned}
\Delta&=4k^2m^2a^4-4a^2(m^2-b^2)(b^2+a^2k^2)\\
&=4a^2[k^2m^2a^2-(m^2-b^2)(b^2+a^2k^2)]\\
&=4a^2b^2(b^2+a^2k^2-m^2)
\end{aligned}
$$

- 相交：$b^2+a^2k^2-m^2\ge0$。
- 相切：$b^2+a^2k^2-m^2=0$。
- 相离：$b^2+a^2k^2-m^2<0$。

如果相交，此时两交点之间的距离有

$$
\begin{aligned}
|AB|&=\sqrt{k^2+1}\cdot|x_a-x_b|\\
&=\sqrt{k^2+1}\cdot\dfrac{2ab\sqrt{b^2+a^2k^2-m^2}}{b^2+a^2k^2}
\end{aligned}
$$

前者为硬解定理，后者为弦长公式。

### 双曲线与直线

根据双曲线的两条渐近线，因此双曲线与直线有也有三种情况，相切、相交、相离

我们设双曲线的一般方程

$$
\dfrac{x^2}{a^2}-\dfrac{y^2}{b^2}=1
$$

不妨先化为整式

$$
b^2x^2-a^2y^2=a^2b^2
$$

设直线方程为 $y=kx+m$，带入

$$
\begin{aligned}
b^2x^2-a^2(kx+m)^2&=a^2b^2\\
b^2x^2-a^2(k^2x^2+m^2+2kmx)&=a^2b^2
\end{aligned}
$$

化简得到

$$
(b^2-a^2k^2)x^2-2kma^2x-a^2m^2-a^2b^2=0
$$

我们分类讨论二项式系数

!!! note "如果 $b^2=a^2k^2$"

    即 $k=\pm\dfrac{b}{a}$，此时

    $$
    2kma^2x+a^2m^2+a^2b^2=0
    $$

    此时
    
    - 若 $m\neq0$，则有一个交点

    - 若 $m=0$，则无焦点。

    我们注意到这个 $k$ 就是渐近线斜率，也就是说平行于渐近线最多只有一个焦点。

!!! note "如果 $b^2\neq a^2k^2$"

    则讨论二次函数

    $$
    \begin{aligned}
    \Delta&=4k^2m^2a^4+4a^2(m^2+b^2)(b^2-a^2k^2)\\
    &=4a^2[k^2m^2a^2+(m^2+b^2)(b^2-a^2k^2)]\\
    &=4a^2b^2(b^2-a^2k^2+m^2)
    \end{aligned}
    $$

    - 相交：$b^2-a^2k^2+m^2\ge0$。
    - 相切：$b^2-a^2k^2+m^2=0$。
    - 相离：$b^2-a^2k^2+m^2<0$。

    如果相交，此时两交点之间的距离有

    $$
    \begin{aligned}
    |AB|&=\sqrt{k^2+1}\cdot|x_a-x_b|\\
    &=\sqrt{k^2+1}\cdot\dfrac{2ab\sqrt{b^2-a^2k^2+m^2}}{|b^2-a^2k^2|}
    \end{aligned}
    $$

    前者为硬解定理，后者为弦长公式。

注意，如果直线与双曲线有一个交点，则可能有两种情况。

### 抛物线与直线

不妨设抛物线

$$
y^2=2px
$$

联立直线 $y=kx+m$，得到

$$
k^2x^2+(2km-2p)x+m^2=0
$$

若 $k=0$，则有一个交点。

若 $k\neq0$，我们知道

$$
\Delta=4p^2-8kmp=4p(p-2km)
$$

因此：

- 若 $p-2km\ge0$：相交。

- 若 $p-2km=0$：相切。

- 若 $p-2km<0$：相离。

同样有弦长公式

$$
\begin{aligned}
|AB|&=\sqrt{k^2+1}\cdot|x_a-x_b|\\
&=\sqrt{k^2+1}\cdot\dfrac{\sqrt{p(p-2km)}}{k^2}
\end{aligned}
$$

如果我们知道直线与 $x$ 轴的交点，例如过抛物线的焦点，不妨设直线方程 $x=ky+m$，联立的时候直接带入，得到

$$
y^2-2pky-2pm=0
$$

此时就可以避免平方了。

## 基本问题

### 倒角公式

我们知道 $\theta=\theta_2-\theta_1$，如图

![alt text](image.png){ width="40%" }

因此，不妨

$$
\begin{aligned}
\tan\theta&=\dfrac{\tan\theta_2-\tan\theta_1}{1+\tan\theta_1+\tan\theta_2}\\
&=\dfrac{k_2-k_1}{1+k_1k_2}
\end{aligned}
$$

对于讨论垂直关系，更常用向量和斜率，或者勾股定理、射影定理等。

### 轨迹方程

要求轨迹方程，即得到方程式；要求轨迹，则用对应的定义来描述一个曲线。

直接求法：即根据圆锥曲线的定义，进行求解答方法，最常用的是椭圆和双曲线的第二定义。

间接求法：用所求点的坐标表示已知点的坐标，进行消元解决。

线段长度：

- 勾股定理、三角形点三边关系。

- 如果系数与离心率有关，考虑第二定义转化到点和到线的距离。

### 定点问题

- 根据特殊直线、对称性猜定点。

    对称性：关于轴对称，则对称过去交于一点。

- 证明定点，或用恒成立求顶点。

    证明，不妨表示直线上两点 $A,B$，用猜出的 $M$ 坐标验证 $k_{AM}=k_{MB}$。

!!! note "参变分离法"
    求定点
    
    $$
    (3k+1)x+2ky+4k-3=0
    $$
    
    不妨令 $k$ 为主元，

    $$
    (3x+2y+4)k+x-3=0
    $$

    因此令

    $$
    \begin{cases}
    3x+2y+4&=0\\
    x-3&=0
    \end{cases}
    $$

    因此定点 $\paren{3,-\dfrac{13}{2}}$。

    对于含参且参数的次数都是 $1$ 的，不妨以参数为主元，令常数和系数都为零。

## 基本思想

### 参数方程

参数方程和函数相似，都是由一些在指定的集合的数，称为参数或自变数，以决定因变数的结果。

我们知道，几何中常见的方程是 $y$ 关于 $x$ 的方程，但是我们也可以将 $x,y$ 均视为因变量，钦定其为关于 $t$ 或 $\theta$ 的方程，称为参数方程。

- 普通方程转为参数方程：利用参数方程，可以很方便的表示不能用函数表达，或者常规的方程难以表达的曲线。

- 参数方程转为普通方程：消去参数，或者将参数用 $x,y$ 表示，然后解没有参数的方程。

参数方程可以用于消元，当两个未知量具有明显的几何意义，可以设出参数方程。

容易知道：

$$
\boxed{\begin{cases}
x&=a+r\cos\theta\\
y&=b+r\sin\theta
\end{cases}}
$$

可以表示一个圆。

容易知道

$$
\boxed{\begin{cases}
x&=a\cos\theta\\
y&=b\sin\theta
\end{cases}}
$$

可以表示一个中心在原点的椭圆。

容易知道

$$
\boxed{\begin{cases}
x&=\dfrac{a}{\cos\theta}\\
y&=b\tan\theta
\end{cases}}
$$

可以表示一个中心在原点的双曲线。

### 仿射变换

我们在坐标系部分讲解了线性变换，我们知道线性变换后

- 直线变换后依然是直线。

- 直线比例保持不变。

- 原点变换后依然是原点。

而我们称仿射变换是指在对一个向量空间进行一次线性变换并接上一个**平移**，变换为另一个向量空间。伸缩、平移、对称等都是仿射变换，

![alt text](image-2.png){ width="80%" }

事实上：

- 平行直线依然平行。

- 共线的点依然共线。

- 直线变换后依然是直线。

- 直线上的线段比例保持不变。

使用一增广矩阵与一增广向量，需要所有向量在其末端扩长 $1$ 且所有矩阵都于底部添加一排零，右边扩长一列转换向量，及右下角添加一个 $1$。

$$
\begin{bmatrix}{\vec {y}}\\1\end{bmatrix}=\left[{\begin{array}{ccc|c}\,&A&&{\vec {b}}\ \\0&\ldots &0&1\end{array}}\right]{\begin{bmatrix}{\vec {x}}\\1\end{bmatrix}}
$$

等价于

$$
\vec {y}=A{\vec {x}}+{\vec {b}}
$$

对于一个椭圆

$$
\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1
$$

我们不妨令 $x'=\dfrac{b}{a}x$，则

$$
x'^2+y^2=b^2
$$

我们不妨令 $y'=\dfrac{a}{b}y$，则

$$
x^2+y'^2=a^2
$$

这样就通过伸缩变换将椭圆变成了圆；一般的，我们讨论变换

$$
f:\begin{cases}
x'&=mx\\
y'&=ny
\end{cases}
$$

- 任意面积 $S$ 变为 $nm$ 倍：$S'=nm\cdot S$。

- 有椭圆第三定义。

## 基本问题

### 切线方程

方法一（判别式）：

- 我们知道相切即有且仅有一个交点，利用判别式：

    设切线为 $y=kx+b$，联立曲线方程，令判别式 $\Delta=0$。

方法二（求导法）：

-  我们令曲线方程为 $F(x,y)=0$，对 $F$ 求导。

- 我们利用导数中讲的隐函数求导：

    将 $y$ 看作 $f(x)$，利用链式法则进行求导。

- 或者更简单的，我们利用偏导：

    $$
    y'=-\dfrac{F_x}{F_y}
    $$

    其中
    
    $$
    \begin{aligned}
    F_x&=\dfrac{\partial F}{\partial x}(x,y)\\
    F_y&=\dfrac{\partial F}{\partial y}(x,y)
    \end{aligned}
    $$

- 对于求导后的结果，带入曲线上的点即可得到曲线在该处的切线。

经过推导，我们得出椭圆的切线方程

$$
\dfrac{x_0x}{a^2}+\dfrac{y_0y}{b^2}=1
$$

同理，双曲线的切线方程

$$
\dfrac{x_0x}{a^2}-\dfrac{y_0y}{b^2}=1
$$

对于一般的圆锥曲线

$$
Ax^2+Bxy+Cy^2+Dx+Ey+F=0
$$

其切线方程就是

$$
Ax_0x+B\cdot\dfrac{x_0y+xy_0}{2}+Cy_0y+D\cdot\dfrac{x_0+x}{2}+E\cdot\dfrac{y_0+y}{2}+F=0
$$

也就是说我们替换

$$
\begin{cases}
x^2&\gets x_0x\\
y^2&\gets y_0y\\
x&\gets\dfrac{x_0+x}{2}\\
y&\gets\dfrac{y_0+y}{2}\\
xy&\gets\dfrac{x_0y+xy_0}{2}
\end{cases}
$$

得到的就是 $F$ 在 $(x_0,y_0)$ 处的切线方程。

### 切点弦方程

设过椭圆外一点 $A=(x_0,y_0)$ 有椭圆的切线 $AB,AC$，其中 $B=(x_1,y_1),C=(x_2,y_2)$ 为切点，则 $BC$ 的方程也为

$$
\dfrac{x_0x}{a^2}-\dfrac{y_0y}{b^2}=1
$$

证明：根据 $AB,AC$ 是切线，列出 $AB,AC$ 的直线方程

$$
\begin{cases}
\dfrac{x_1x}{a^2}+\dfrac{y_1y}{b^2}=1\\
\dfrac{x_2x}{a^2}+\dfrac{y_2y}{b^2}=1\\
\end{cases}
$$

我们知道 $A(x_0,y_0)$ 在这两条直线上，因此带入 $(x,y)=(x_0,y_0)$

$$
\begin{cases}
\dfrac{x_1x_0}{a^2}+\dfrac{y_1y_0}{b^2}=1\\
\dfrac{x_2x_0}{a^2}+\dfrac{y_2y_0}{b^2}=1\\
\end{cases}
$$

因此不妨令直线

$$
\dfrac{x_0x}{a^2}-\dfrac{y_0y}{b^2}=1
$$

则一定有 $B(x_1,y_1),C(x_2,y_2)$ 一定在这条直线上。

根据推导可以发现，焦点在 $x$ 轴上的抛物线（开口向左、右）外一点，纵坐标是切点纵坐标的算数平均值，横坐标是切点横坐标的几何平均值。

