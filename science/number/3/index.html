<article class="mkdocs-fragment"
         data-title="数论入门"
         data-url="science/number/3/">
  <h1 id="_1">数论入门</h1>
<h2 id="_2">因数</h2>
<h3 id="_3">整除</h3>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 能整除 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>，则记为 <span class="arithmatex"><span class="MathJax_Preview">a\mid b</span><script type="math/tex">a\mid b</script></span>，如 <span class="arithmatex"><span class="MathJax_Preview">2\mid 12</span><script type="math/tex">2\mid 12</script></span>. 若 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 不能整除 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>，则记为 <span class="arithmatex"><span class="MathJax_Preview">a\nmid b</span><script type="math/tex">a\nmid b</script></span>，如 <span class="arithmatex"><span class="MathJax_Preview">5\nmid 12</span><script type="math/tex">5\nmid 12</script></span>.</p>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">a\nmid b</span><script type="math/tex">a\nmid b</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">b\div a</span><script type="math/tex">b\div a</script></span> 存在余数 <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">0&lt;r&lt;a</span><script type="math/tex">0<r<a</script></span>，记 <span class="arithmatex"><span class="MathJax_Preview">r=a\ \mathrm{mod}\ b</span><script type="math/tex">r=a\ \mathrm{mod}\ b</script></span>. 例如，<span class="arithmatex"><span class="MathJax_Preview">3\ \mathrm{mod}\ 2=1</span><script type="math/tex">3\ \mathrm{mod}\ 2=1</script></span>.</p>
<p>整除具有以下性质：</p>
<ol>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a\mid b</span><script type="math/tex">a\mid b</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">a\mid c</span><script type="math/tex">a\mid c</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\forall x,y</span><script type="math/tex">\forall x,y</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">a\mid xb+yc</span><script type="math/tex">a\mid xb+yc</script></span>.</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a\mid b</span><script type="math/tex">a\mid b</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">b\mid c</span><script type="math/tex">b\mid c</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a\mid c</span><script type="math/tex">a\mid c</script></span>.</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a\mid b</span><script type="math/tex">a\mid b</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">b\mid a</span><script type="math/tex">b\mid a</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a=\pm b</span><script type="math/tex">a=\pm b</script></span>.</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">m\neq 0</span><script type="math/tex">m\neq 0</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a\mid b</span><script type="math/tex">a\mid b</script></span>，当且仅当 <span class="arithmatex"><span class="MathJax_Preview">ma\mid mb</span><script type="math/tex">ma\mid mb</script></span>.</li>
</ol>
<h3 id="_4">最大公因数与最小公倍数</h3>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 是两个不为 <span class="arithmatex"><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span> 的整数，能使 <span class="arithmatex"><span class="MathJax_Preview">d\mid a</span><script type="math/tex">d\mid a</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">d\mid b</span><script type="math/tex">d\mid b</script></span> 成立的最大整数 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>，称为 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 的最大公因数，记作 <span class="arithmatex"><span class="MathJax_Preview">\gcd(a,b)</span><script type="math/tex">\gcd(a,b)</script></span>.</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 是两个不为 <span class="arithmatex"><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span> 的整数，能使 <span class="arithmatex"><span class="MathJax_Preview">a\mid d</span><script type="math/tex">a\mid d</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">b\mid d</span><script type="math/tex">b\mid d</script></span> 成立的最小整数 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>，称为 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 的最小公倍数，记作 <span class="arithmatex"><span class="MathJax_Preview">\mathrm{lcm}(a,b)</span><script type="math/tex">\mathrm{lcm}(a,b)</script></span>.</p>
<ul>
<li><span class="arithmatex"><span class="MathJax_Preview">\forall a,b\in\N,\ \gcd(a,b)\cdot\mathrm{lcm}(a,b)=ab</span><script type="math/tex">\forall a,b\in\N,\ \gcd(a,b)\cdot\mathrm{lcm}(a,b)=ab</script></span></li>
</ul>
<p>证明：设 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle d=\gcd(a,b),a_0=\frac{a}{d},b_0=\frac{b}{d}</span><script type="math/tex">\displaystyle d=\gcd(a,b),a_0=\frac{a}{d},b_0=\frac{b}{d}</script></span>. 根据最大公因数的定义，有 <span class="arithmatex"><span class="MathJax_Preview">\gcd(a_0,b_0)=1</span><script type="math/tex">\gcd(a_0,b_0)=1</script></span>。<span class="arithmatex"><span class="MathJax_Preview">\\\ \ \ \ \ \ \ \ \ \text{}</span><script type="math/tex">\\\ \ \ \ \ \ \ \ \ \text{}</script></span> 再根据最小公倍数的定义，有 <span class="arithmatex"><span class="MathJax_Preview">\mathrm{lcm}(a,b)=a_0\cdot b_0</span><script type="math/tex">\mathrm{lcm}(a,b)=a_0\cdot b_0</script></span>. <span class="arithmatex"><span class="MathJax_Preview">\\\ \ \ \ \ \ \ \ \ \text{}</span><script type="math/tex">\\\ \ \ \ \ \ \ \ \ \text{}</script></span> 于是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\mathrm{lcm}(a,b)=\mathrm{lcm}(a_0\cdot d,b_0\cdot d)=\mathrm{lcm}(a_0,b_0)\cdot d=a_0\cdot b_0\cdot d=\frac{a\cdot b}{d}</span><script type="math/tex">\displaystyle\mathrm{lcm}(a,b)=\mathrm{lcm}(a_0\cdot d,b_0\cdot d)=\mathrm{lcm}(a_0,b_0)\cdot d=a_0\cdot b_0\cdot d=\frac{a\cdot b}{d}</script></span>，原命题得证。</p>
<ul>
<li>九章算术 更相减损术： <span class="arithmatex"><span class="MathJax_Preview">\gcd(a,b)=\gcd(b,a-b)=\gcd(a,a-b),\gcd(2a,2b)=2\gcd(a,b)</span><script type="math/tex">\gcd(a,b)=\gcd(b,a-b)=\gcd(a,a-b),\gcd(2a,2b)=2\gcd(a,b)</script></span>.</li>
</ul>
<p>证明：<span class="arithmatex"><span class="MathJax_Preview">d\mid a,d\mid b\implies d\mid(a-b)</span><script type="math/tex">d\mid a,d\mid b\implies d\mid(a-b)</script></span>.</p>
<ul>
<li>欧几里得算法：<span class="arithmatex"><span class="MathJax_Preview">\forall a,b\in\N,b\neq 0,\gcd(a,b)=\gcd(b,a\ \mathrm{mod}\ b)</span><script type="math/tex">\forall a,b\in\N,b\neq 0,\gcd(a,b)=\gcd(b,a\ \mathrm{mod}\ b)</script></span>.</li>
</ul>
<p>证明：分类讨论。</p>
<ol>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a&lt;b</span><script type="math/tex">a<b</script></span>，则有 <span class="arithmatex"><span class="MathJax_Preview">\gcd(b,a\ \mathrm{mod}\ b)=\gcd(b,a)=\gcd(a,b)</span><script type="math/tex">\gcd(b,a\ \mathrm{mod}\ b)=\gcd(b,a)=\gcd(a,b)</script></span>.</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a\geq b</span><script type="math/tex">a\geq b</script></span>，不妨设 <span class="arithmatex"><span class="MathJax_Preview">a=q\cdot b+r\ (0\leq r&lt;b)</span><script type="math/tex">a=q\cdot b+r\ (0\leq r<b)</script></span>。显然 <span class="arithmatex"><span class="MathJax_Preview">r=a\ \mathrm{mod}\ b</span><script type="math/tex">r=a\ \mathrm{mod}\ b</script></span>. 对于 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 的任意公因数 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>，<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 因为 <span class="arithmatex"><span class="MathJax_Preview">d\mid a,d\mid q\cdot b</span><script type="math/tex">d\mid a,d\mid q\cdot b</script></span>，故 <span class="arithmatex"><span class="MathJax_Preview">d\mid (a-q\cdot b)</span><script type="math/tex">d\mid (a-q\cdot b)</script></span>，即 <span class="arithmatex"><span class="MathJax_Preview">d\mid r</span><script type="math/tex">d\mid r</script></span>. 因此 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> 也是 <span class="arithmatex"><span class="MathJax_Preview">b,r</span><script type="math/tex">b,r</script></span> 的公因数，反之亦成立。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 故 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 的公因数集合与 <span class="arithmatex"><span class="MathJax_Preview">b,a\ \mathrm{mod}\ b</span><script type="math/tex">b,a\ \mathrm{mod}\ b</script></span> 的公因数集合相同。于是它们的最大公因数也相等。</li>
</ol>
<h2 id="_5">裴蜀定理</h2>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">a,b\in\Z,ab\neq 0</span><script type="math/tex">a,b\in\Z,ab\neq 0</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\exist x,y\in\Z</span><script type="math/tex">\exist x,y\in\Z</script></span> 使 <span class="arithmatex"><span class="MathJax_Preview">ax+by=\gcd(a,b)=a(x+bu)+b(y-au)</span><script type="math/tex">ax+by=\gcd(a,b)=a(x+bu)+b(y-au)</script></span></p>
<p>由上易推出两个<strong>整数 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 互素的充分必要条件是 <span class="arithmatex"><span class="MathJax_Preview">\exist x,y\in\Z</span><script type="math/tex">\exist x,y\in\Z</script></span> 使得 <span class="arithmatex"><span class="MathJax_Preview">ax+by=1</span><script type="math/tex">ax+by=1</script></span>。</strong></p>
<p>比如要证明 <span class="arithmatex"><span class="MathJax_Preview">21n+4</span><script type="math/tex">21n+4</script></span> 与 <span class="arithmatex"><span class="MathJax_Preview">14n+3</span><script type="math/tex">14n+3</script></span> 互素，知道 <span class="arithmatex"><span class="MathJax_Preview">3(14n+3)-2(21n+4)=1</span><script type="math/tex">3(14n+3)-2(21n+4)=1</script></span> 即可。</p>
<p>例 1：证明 <span class="arithmatex"><span class="MathJax_Preview">n!+1</span><script type="math/tex">n!+1</script></span> 与 <span class="arithmatex"><span class="MathJax_Preview">(n+1)!+1</span><script type="math/tex">(n+1)!+1</script></span> 互素。</p>
<p>有 <span class="arithmatex"><span class="MathJax_Preview">(n+1)(n!+1)-[(n+1)!+1]=n</span><script type="math/tex">(n+1)(n!+1)-[(n+1)!+1]=n</script></span>，于是 <span class="arithmatex"><span class="MathJax_Preview">[d=\gcd(n!+1,(n+1)!+1)]|n</span><script type="math/tex">[d=\gcd(n!+1,(n+1)!+1)]|n</script></span>，又因为 <span class="arithmatex"><span class="MathJax_Preview">d|n!</span><script type="math/tex">d|n!</script></span>，结合 <span class="arithmatex"><span class="MathJax_Preview">d|(n!+1)</span><script type="math/tex">d|(n!+1)</script></span> 得到 <span class="arithmatex"><span class="MathJax_Preview">d=1</span><script type="math/tex">d=1</script></span>，原命题得证。</p>
<hr />
<p>例 2：记费马数 <span class="arithmatex"><span class="MathJax_Preview">F_k=2^{2^k}+1,k\geq 0</span><script type="math/tex">F_k=2^{2^k}+1,k\geq 0</script></span>，证明若 <span class="arithmatex"><span class="MathJax_Preview">m\neq n</span><script type="math/tex">m\neq n</script></span> 则 <span class="arithmatex"><span class="MathJax_Preview">\gcd(F_m,F_n)=1</span><script type="math/tex">\gcd(F_m,F_n)=1</script></span>.</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">m&gt;n</span><script type="math/tex">m>n</script></span>，只要利用 <span class="arithmatex"><span class="MathJax_Preview">F_n|(F_m-2)</span><script type="math/tex">F_n|(F_m-2)</script></span> 证明 <span class="arithmatex"><span class="MathJax_Preview">\exist x\in\Z</span><script type="math/tex">\exist x\in\Z</script></span> 使得 <span class="arithmatex"><span class="MathJax_Preview">F_m+xF_n=2</span><script type="math/tex">F_m+xF_n=2</script></span>【基本技巧例 2】</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">[d=\gcd(F_m,F_n)]|2</span><script type="math/tex">[d=\gcd(F_m,F_n)]|2</script></span>. <span class="arithmatex"><span class="MathJax_Preview">F_n</span><script type="math/tex">F_n</script></span> 显然为奇数故 <span class="arithmatex"><span class="MathJax_Preview">d=1</span><script type="math/tex">d=1</script></span>. 因此<strong>费马数两两互素。</strong></p>
<hr />
<p>例 3：设 <span class="arithmatex"><span class="MathJax_Preview">a&gt;1,m,n&gt;0</span><script type="math/tex">a>1,m,n>0</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">\boxed{\gcd(a^m-1,a^n-1)=a^{\gcd(m,n)}-1}</span><script type="math/tex">\boxed{\gcd(a^m-1,a^n-1)=a^{\gcd(m,n)}-1}</script></span></p>
<p>令 <span class="arithmatex"><span class="MathJax_Preview">D=\gcd(a^m-1,a^n-1)</span><script type="math/tex">D=\gcd(a^m-1,a^n-1)</script></span>，只要证明 <span class="arithmatex"><span class="MathJax_Preview">[a^{\gcd(m,n)}-1]|D</span><script type="math/tex">[a^{\gcd(m,n)}-1]|D</script></span> 及 <span class="arithmatex"><span class="MathJax_Preview">D|[a^{\gcd(m,n)}-1]</span><script type="math/tex">D|[a^{\gcd(m,n)}-1]</script></span> 即可。</p>
<p>显然 <span class="arithmatex"><span class="MathJax_Preview">[a^{\gcd(m,n)}-1]|(a^m-1)</span><script type="math/tex">[a^{\gcd(m,n)}-1]|(a^m-1)</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">[a^{\gcd(m,n)}-1]|(a^n-1)</span><script type="math/tex">[a^{\gcd(m,n)}-1]|(a^n-1)</script></span>，可以证明 <span class="arithmatex"><span class="MathJax_Preview">[a^{\gcd(m,n)}-1]|D</span><script type="math/tex">[a^{\gcd(m,n)}-1]|D</script></span>.</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">d=\gcd(m,n)</span><script type="math/tex">d=\gcd(m,n)</script></span>，可选 <span class="arithmatex"><span class="MathJax_Preview">u,v&gt;0</span><script type="math/tex">u,v>0</script></span>，使 <span class="arithmatex"><span class="MathJax_Preview">mu-nv=d</span><script type="math/tex">mu-nv=d</script></span>. 因此 <span class="arithmatex"><span class="MathJax_Preview">D|(a^m-1),D|(a^{mu}-1)</span><script type="math/tex">D|(a^m-1),D|(a^{mu}-1)</script></span>，扩展开来 <span class="arithmatex"><span class="MathJax_Preview">D|(a^{mu}-a^{nv})=a^{nv}(a^d-1)</span><script type="math/tex">D|(a^{mu}-a^{nv})=a^{nv}(a^d-1)</script></span>，故 <span class="arithmatex"><span class="MathJax_Preview">D|(a^d-1)</span><script type="math/tex">D|(a^d-1)</script></span>. 综合上述原命题得证。</p>
<hr />
<p>例 4：设 <span class="arithmatex"><span class="MathJax_Preview">m,n&gt;0,mn|(m^2+n^2)</span><script type="math/tex">m,n>0,mn|(m^2+n^2)</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">m=n</span><script type="math/tex">m=n</script></span>.</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">\gcd(m,n)=d,m=m_1d,n=n_1d,\gcd(m_1,n_1)=1</span><script type="math/tex">\gcd(m,n)=d,m=m_1d,n=n_1d,\gcd(m_1,n_1)=1</script></span>①. 已知化为 <span class="arithmatex"><span class="MathJax_Preview">m_1n_1|(m_1^2+n_1^2)</span><script type="math/tex">m_1n_1|(m_1^2+n_1^2)</script></span>，从而 <span class="arithmatex"><span class="MathJax_Preview">m_1|n_1^2,n_1|m_1^2</span><script type="math/tex">m_1|n_1^2,n_1|m_1^2</script></span>. 结合①可得 <span class="arithmatex"><span class="MathJax_Preview">m_1=n_1=1,m=n</span><script type="math/tex">m_1=n_1=1,m=n</script></span>.</p>
<hr />
<p>例 5：设 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 为正奇数，证明 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{i=1}^ni</span><script type="math/tex">\displaystyle\sum_{i=1}^ni</script></span> 整除 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{i=1}^ni^k</span><script type="math/tex">\displaystyle\sum_{i=1}^ni^k</script></span>.</p>
<p>等价于证明 <span class="arithmatex"><span class="MathJax_Preview">n|2\displaystyle\sum_{i=1}^ni^k</span><script type="math/tex">n|2\displaystyle\sum_{i=1}^ni^k</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">(n+1)|2\displaystyle\sum_{i=1}^ni^k</span><script type="math/tex">(n+1)|2\displaystyle\sum_{i=1}^ni^k</script></span>，显然</p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{aligned}2\sum_{i=1}^ni^k&amp;=[1^k+(n-1)^k]+[2^k+(n-2)^k]+\dots+[(n-1)^k+1^k]+2n^k\\&amp;=[1^k+n^k]+[2^k+(n-1)^k]+\dots+[n^k+1^k]\end{aligned}</div>
<script type="math/tex; mode=display">\begin{aligned}2\sum_{i=1}^ni^k&=[1^k+(n-1)^k]+[2^k+(n-2)^k]+\dots+[(n-1)^k+1^k]+2n^k\\&=[1^k+n^k]+[2^k+(n-1)^k]+\dots+[n^k+1^k]\end{aligned}</script>
</div>
<p>是 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">n+1</span><script type="math/tex">n+1</script></span> 的倍数。</p>
<p>由上可知，为了证明 <span class="arithmatex"><span class="MathJax_Preview">b|a</span><script type="math/tex">b|a</script></span>，只需将 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 分解成若干个两两互素的整数 <span class="arithmatex"><span class="MathJax_Preview">b_1,b_2,\dots,b_n</span><script type="math/tex">b_1,b_2,\dots,b_n</script></span> 之积，证明 <span class="arithmatex"><span class="MathJax_Preview">b_i|a</span><script type="math/tex">b_i|a</script></span> 即可。</p>
<h2 id="_6">质数</h2>
<ul>
<li>定义：一个正整数无法被除了 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> 和它自身之外的任何自然数整除，则成为质数，否则为合数。</li>
<li>数量：对于一个足够大的整数 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>，不超过 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的质数有 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\pi(x)\approx\frac{N}{\ln N}</span><script type="math/tex">\displaystyle\pi(x)\approx\frac{N}{\ln N}</script></span> 个，所以第 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个质数约为 <span class="arithmatex"><span class="MathJax_Preview">n\ln n</span><script type="math/tex">n\ln n</script></span>.</li>
<li>
<p>判定：试除法，若 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 为合数，则存在一个能整除 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的数 <span class="arithmatex"><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">2 \leq T \leq \sqrt{N}</span><script type="math/tex">2 \leq T \leq \sqrt{N}</script></span>.</p>
</li>
<li>
<p>算数基本定理：<span class="arithmatex"><span class="MathJax_Preview">N = p_1^{c_1}p_2^{c_2}\dots p_n^{c_n}</span><script type="math/tex">N = p_1^{c_1}p_2^{c_2}\dots p_n^{c_n}</script></span>，<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的正约数个数 <span class="arithmatex"><span class="MathJax_Preview">=\red{\boxed{\displaystyle\prod_{i=1}^{n}(c_i+1)}}</span><script type="math/tex">=\red{\boxed{\displaystyle\prod_{i=1}^{n}(c_i+1)}}</script></span>，<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的所有正约数的和 <span class="arithmatex"><span class="MathJax_Preview">=\displaystyle\prod_{i=1}^{n}(\displaystyle\sum_{j=0}^{c_i}(p_i)^j)=\red{\boxed{\prod_{i=1}^n\frac{p_i^{c_i+1}-1}{p_i-1}}}</span><script type="math/tex">=\displaystyle\prod_{i=1}^{n}(\displaystyle\sum_{j=0}^{c_i}(p_i)^j)=\red{\boxed{\prod_{i=1}^n\frac{p_i^{c_i+1}-1}{p_i-1}}}</script></span>.</p>
</li>
</ul>
<p>一个正整数 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的约数个数上界为 <span class="arithmatex"><span class="MathJax_Preview">2\sqrt{N}</span><script type="math/tex">2\sqrt{N}</script></span>，<span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 每个数的约数个数的总和大约为 <span class="arithmatex"><span class="MathJax_Preview">N\log N</span><script type="math/tex">N\log N</script></span>.</p>
<ul>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">b|ac</span><script type="math/tex">b|ac</script></span>，若 <span class="arithmatex"><span class="MathJax_Preview">\gcd(b,c)=1</span><script type="math/tex">\gcd(b,c)=1</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">b|a</span><script type="math/tex">b|a</script></span>.</li>
<li>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">a,b\in\N^*</span><script type="math/tex">a,b\in\N^*</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 之积是一个整数的 <span class="arithmatex"><span class="MathJax_Preview">k(k\geq 2)</span><script type="math/tex">k(k\geq 2)</script></span> 次幂，若 <span class="arithmatex"><span class="MathJax_Preview">\gcd(a,b)=1</span><script type="math/tex">\gcd(a,b)=1</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 都是整数的 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 次幂。一般地，设正整数 <span class="arithmatex"><span class="MathJax_Preview">a,b,\dots,c</span><script type="math/tex">a,b,\dots,c</script></span> 之积是一个整数的 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 次幂，且 <span class="arithmatex"><span class="MathJax_Preview">a,b,\dots,c</span><script type="math/tex">a,b,\dots,c</script></span> 两两互质，则 <span class="arithmatex"><span class="MathJax_Preview">a,b,\dots,c</span><script type="math/tex">a,b,\dots,c</script></span> 都是整数的 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 次幂。</p>
</li>
<li>
<p>对任意正整数 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 及质数 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，记 <span class="arithmatex"><span class="MathJax_Preview">p^c\Vert m</span><script type="math/tex">p^c\Vert m</script></span> 表示 <span class="arithmatex"><span class="MathJax_Preview">p^c|m</span><script type="math/tex">p^c|m</script></span> 但 <span class="arithmatex"><span class="MathJax_Preview">p^{c+1}\nmid m</span><script type="math/tex">p^{c+1}\nmid m</script></span>，即 <span class="arithmatex"><span class="MathJax_Preview">p^c</span><script type="math/tex">p^c</script></span> 是 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的标准分解中出现的 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的幂。</p>
</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">n&gt;1,p</span><script type="math/tex">n>1,p</script></span> 为质数，<span class="arithmatex"><span class="MathJax_Preview">p^{c_p}\Vert n!</span><script type="math/tex">p^{c_p}\Vert n!</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">c_p=\displaystyle\sum_{l=1}^{+\infty}\lfloor\frac{n}{p^l}\rfloor</span><script type="math/tex">c_p=\displaystyle\sum_{l=1}^{+\infty}\lfloor\frac{n}{p^l}\rfloor</script></span></li>
</ul>
<p>例 1：证明无穷数列 <span class="arithmatex"><span class="MathJax_Preview">10001,100010001,\dots</span><script type="math/tex">10001,100010001,\dots</script></span> 中无质数。</p>
<p>记 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle a_n=1+10^4+\dots+10^{4(n-1)}=\frac{10^{4n}-1}{10^4-1}</span><script type="math/tex">\displaystyle a_n=1+10^4+\dots+10^{4(n-1)}=\frac{10^{4n}-1}{10^4-1}</script></span>，接下来分 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为奇偶讨论即可。</p>
<div class="arithmatex">
<div class="MathJax_Preview">a_{2k}=\frac{10^{8k}-1}{10^4-1}=\frac{10^{8k}-1}{10^8-1}\cdot\frac{10^8-1}{10^4-1}</div>
<script type="math/tex; mode=display">a_{2k}=\frac{10^{8k}-1}{10^4-1}=\frac{10^{8k}-1}{10^8-1}\cdot\frac{10^8-1}{10^4-1}</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">a_{2k+1}=\frac{10^{4(2k+1)}-1}{10^4-1}=\frac{10^{2(2k+1)}-1}{10^2-1}\cdot\frac{10^{2(2k+1)}+1}{10^2+1}</div>
<script type="math/tex; mode=display">a_{2k+1}=\frac{10^{4(2k+1)}-1}{10^4-1}=\frac{10^{2(2k+1)}-1}{10^2-1}\cdot\frac{10^{2(2k+1)}+1}{10^2+1}</script>
</div>
<p>例 2：证明 <span class="arithmatex"><span class="MathJax_Preview">\forall n\in\N^*,n&gt;1,n^4+4^n</span><script type="math/tex">\forall n\in\N^*,n>1,n^4+4^n</script></span> 不是质数。</p>
<p><span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为偶数显然。<span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为奇数时，设 <span class="arithmatex"><span class="MathJax_Preview">n=2k+1</span><script type="math/tex">n=2k+1</script></span>，</p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{aligned}n^4+4^n&amp;=n^4+4\cdot 4^{2k}=n^4+4\cdot (2k)^4=n^4+4n^2\cdot(2^k)^2+4\cdot(2k)^4-4n^2\cdot(2^k)^2\\&amp;=(n^2+2\cdot 2^{2k})^2-(2n\cdot 2^k)^2=(n^2+2^{k+1}n+2^{2k+1})(n^2-2^{k+1}n+2^{2k+1})\end{aligned}</div>
<script type="math/tex; mode=display">\begin{aligned}n^4+4^n&=n^4+4\cdot 4^{2k}=n^4+4\cdot (2k)^4=n^4+4n^2\cdot(2^k)^2+4\cdot(2k)^4-4n^2\cdot(2^k)^2\\&=(n^2+2\cdot 2^{2k})^2-(2n\cdot 2^k)^2=(n^2+2^{k+1}n+2^{2k+1})(n^2-2^{k+1}n+2^{2k+1})\end{aligned}</script>
</div>
<p>即把 <span class="arithmatex"><span class="MathJax_Preview">4^n</span><script type="math/tex">4^n</script></span> 看成 <span class="arithmatex"><span class="MathJax_Preview">4y^4</span><script type="math/tex">4y^4</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">\red{\boxed{x^4+4y^4=(x^2+2y^2+2xy)(x^2+2y^2-2xy)}}</span><script type="math/tex">\red{\boxed{x^4+4y^4=(x^2+2y^2+2xy)(x^2+2y^2-2xy)}}</script></span></p>
<p>练 1：设 <span class="arithmatex"><span class="MathJax_Preview">a,b,c,d\in\N^*,ab=cd</span><script type="math/tex">a,b,c,d\in\N^*,ab=cd</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">a+b+c+d</span><script type="math/tex">a+b+c+d</script></span> 不是质数。</p>
<p>例 3：证明：若 <span class="arithmatex"><span class="MathJax_Preview">a,b\in\Z,2a^2+a=3b^2+b</span><script type="math/tex">a,b\in\Z,2a^2+a=3b^2+b</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a-b</span><script type="math/tex">a-b</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">2a+2b+1</span><script type="math/tex">2a+2b+1</script></span> 都为完全平方数。</p>
<p>已知化为 <span class="arithmatex"><span class="MathJax_Preview">(a-b)(2a+2b+1)=b^2</span><script type="math/tex">(a-b)(2a+2b+1)=b^2</script></span>，设 <span class="arithmatex"><span class="MathJax_Preview">d=\gcd(a-b,2a+2b+1)</span><script type="math/tex">d=\gcd(a-b,2a+2b+1)</script></span>，若 <span class="arithmatex"><span class="MathJax_Preview">d&gt;1</span><script type="math/tex">d>1</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> 有质因子 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>，<span class="arithmatex"><span class="MathJax_Preview">p|b^2\implies p|b</span><script type="math/tex">p|b^2\implies p|b</script></span>，<span class="arithmatex"><span class="MathJax_Preview">p|(a-b)\implies p|a\implies p|1</span><script type="math/tex">p|(a-b)\implies p|a\implies p|1</script></span>，这不可能，因此 <span class="arithmatex"><span class="MathJax_Preview">d=1</span><script type="math/tex">d=1</script></span>. 因为 <span class="arithmatex"><span class="MathJax_Preview">b^2</span><script type="math/tex">b^2</script></span> 是完全平方数，由此可得 <span class="arithmatex"><span class="MathJax_Preview">|a-b|，|2a+2b+1|</span><script type="math/tex">|a-b|，|2a+2b+1|</script></span> 也是完全平方。</p>
<p>只要证 <span class="arithmatex"><span class="MathJax_Preview">a-b</span><script type="math/tex">a-b</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">2a+2b+1</span><script type="math/tex">2a+2b+1</script></span> 不能同时 <span class="arithmatex"><span class="MathJax_Preview">&lt;0</span><script type="math/tex"><0</script></span> 即可。设 <span class="arithmatex"><span class="MathJax_Preview">a-b&lt;0</span><script type="math/tex">a-b<0</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">b-a=r^2</span><script type="math/tex">b-a=r^2</script></span>. 显然 <span class="arithmatex"><span class="MathJax_Preview">r|b,r|a</span><script type="math/tex">r|b,r|a</script></span>，令 <span class="arithmatex"><span class="MathJax_Preview">b=b_1r,a=a_1r</span><script type="math/tex">b=b_1r,a=a_1r</script></span>，代入题目 <span class="arithmatex"><span class="MathJax_Preview">a_1^2+6a_1r+3r^2+1=0</span><script type="math/tex">a_1^2+6a_1r+3r^2+1=0</script></span>，得 <span class="arithmatex"><span class="MathJax_Preview">a_1=-3r\pm\sqrt{6r^2-1}</span><script type="math/tex">a_1=-3r\pm\sqrt{6r^2-1}</script></span>，显然 <span class="arithmatex"><span class="MathJax_Preview">6r^2-1</span><script type="math/tex">6r^2-1</script></span> 应为完全平方数，而 <span class="arithmatex"><span class="MathJax_Preview">6r^2-1\equiv 2\ (\mathrm{mod}\ 3)</span><script type="math/tex">6r^2-1\equiv 2\ (\mathrm{mod}\ 3)</script></span>，矛盾，原命题得证。</p>
<h2 id="_7">不定方程</h2>
<p>例 1：证明两个连续正整数之积不能是完全平方或完全立方。</p>
<p>反证法，即设 <span class="arithmatex"><span class="MathJax_Preview">x(x+1)=y^2</span><script type="math/tex">x(x+1)=y^2</script></span> 有解，则 <span class="arithmatex"><span class="MathJax_Preview">(2x+1)^2=4y^2+1</span><script type="math/tex">(2x+1)^2=4y^2+1</script></span>，分解为</p>
<div class="arithmatex">
<div class="MathJax_Preview">(2x+1+2y)(2x+1-2y)=1\implies\begin{cases}2x+1+2y=1\\2x+1-2y=1\end{cases}\implies x=y=0</div>
<script type="math/tex; mode=display">(2x+1+2y)(2x+1-2y)=1\implies\begin{cases}2x+1+2y=1\\2x+1-2y=1\end{cases}\implies x=y=0</script>
</div>
<p>显然不可能。类似的，对于完全立方，由于 <span class="arithmatex"><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">x+1</span><script type="math/tex">x+1</script></span> 互质，可得它们都是立方数。设 <span class="arithmatex"><span class="MathJax_Preview">x=u^3,x+1=v^3,y=uv,v^3-u^3=1=(v-u)(v^2+uv+u^2)</span><script type="math/tex">x=u^3,x+1=v^3,y=uv,v^3-u^3=1=(v-u)(v^2+uv+u^2)</script></span>，显然不可能。</p>
<p>类似的，可证明连续两个正整数之积不能是整数的 <span class="arithmatex"><span class="MathJax_Preview">k(k\geq 2)</span><script type="math/tex">k(k\geq 2)</script></span> 次幂。</p>
<p>练 1：设 <span class="arithmatex"><span class="MathJax_Preview">k\in\N^*,k\geq 2</span><script type="math/tex">k\in\N^*,k\geq 2</script></span>，证明：连续三个正整数之积不能是整数的 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 次幂。</p>
<p>提示：<span class="arithmatex"><span class="MathJax_Preview">x(x^2-1)=y^k\implies a^kb^k=(ab)^k,1=a^{2k}-b^k=(a^2)^k-b^k</span><script type="math/tex">x(x^2-1)=y^k\implies a^kb^k=(ab)^k,1=a^{2k}-b^k=(a^2)^k-b^k</script></span>，导出矛盾。</p>
<hr />
<p>例 2：证明方程 <span class="arithmatex"><span class="MathJax_Preview">y^2+y=x+x^2+x^3</span><script type="math/tex">y^2+y=x+x^2+x^3</script></span> 没有 <span class="arithmatex"><span class="MathJax_Preview">x\neq 0</span><script type="math/tex">x\neq 0</script></span> 的整数解。</p>
<p>转化为 <span class="arithmatex"><span class="MathJax_Preview">(y-x)(y+x+1)=x^3</span><script type="math/tex">(y-x)(y+x+1)=x^3</script></span>，可以证明 <span class="arithmatex"><span class="MathJax_Preview">\gcd(y-x,y+x+1)=1</span><script type="math/tex">\gcd(y-x,y+x+1)=1</script></span>，设 <span class="arithmatex"><span class="MathJax_Preview">y-x=a^3,y+x+1=b^3,x=ab</span><script type="math/tex">y-x=a^3,y+x+1=b^3,x=ab</script></span>，可得 <span class="arithmatex"><span class="MathJax_Preview">b^3-a^3=(b-a)(b^2+ab+a^2)=2ab+1③</span><script type="math/tex">b^3-a^3=(b-a)(b^2+ab+a^2)=2ab+1③</script></span>，证明该方程无解即可。<span class="arithmatex"><span class="MathJax_Preview">ab&gt;0</span><script type="math/tex">ab>0</script></span> 时，<span class="arithmatex"><span class="MathJax_Preview">b-a\geq 1</span><script type="math/tex">b-a\geq 1</script></span>，③的左边 <span class="arithmatex"><span class="MathJax_Preview">\geq 3ab&gt;</span><script type="math/tex">\geq 3ab></script></span> 右边；<span class="arithmatex"><span class="MathJax_Preview">ab&lt;0</span><script type="math/tex">ab<0</script></span> 时，③的左边的绝对值 <span class="arithmatex"><span class="MathJax_Preview">\geq 2(a^2+b^2-|ab|)&gt;2|ab|&gt;</span><script type="math/tex">\geq 2(a^2+b^2-|ab|)>2|ab|></script></span> ③的右边的绝对值。因此原命题成立。</p>
<p>练 2：求方程 <span class="arithmatex"><span class="MathJax_Preview">(x^2-y^2)^2=1+16y</span><script type="math/tex">(x^2-y^2)^2=1+16y</script></span> 的所有整数解。</p>
<p>提示：<span class="arithmatex"><span class="MathJax_Preview">y\geq 0，|x|\geq</span><script type="math/tex">y\geq 0，|x|\geq</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">\leq y+1</span><script type="math/tex">\leq y+1</script></span>，均可得出 <span class="arithmatex"><span class="MathJax_Preview">(x^2-y^2)^2\geq(2y-1)^2</span><script type="math/tex">(x^2-y^2)^2\geq(2y-1)^2</script></span>，得 <span class="arithmatex"><span class="MathJax_Preview">(2y-1)^2\leq 1+16y</span><script type="math/tex">(2y-1)^2\leq 1+16y</script></span>，答案 <span class="arithmatex"><span class="MathJax_Preview">(x,y)=(\pm 1,0),(\pm 4,3)(\pm4,5)</span><script type="math/tex">(x,y)=(\pm 1,0),(\pm 4,3)(\pm4,5)</script></span>.</p>
<hr />
<p>例 3：设 <span class="arithmatex"><span class="MathJax_Preview">x,y,z\in\N^*,2x^x=y^y+z^z</span><script type="math/tex">x,y,z\in\N^*,2x^x=y^y+z^z</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">x=y=z</span><script type="math/tex">x=y=z</script></span>.</p>
<div class="arithmatex">
<div class="MathJax_Preview">(x+1)^{x+1}&gt;x^{x+1}+(x+1)x^x&gt;2x^x\implies y,z\leq x</div>
<script type="math/tex; mode=display">(x+1)^{x+1}>x^{x+1}+(x+1)x^x>2x^x\implies y,z\leq x</script>
</div>
<p>反之，设 <span class="arithmatex"><span class="MathJax_Preview">y\geq x+1</span><script type="math/tex">y\geq x+1</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">y^y+z^z&gt;(x+1)^{x+1}&gt;2x^x</span><script type="math/tex">y^y+z^z>(x+1)^{x+1}>2x^x</script></span>，矛盾。而 <span class="arithmatex"><span class="MathJax_Preview">y^y+z^z\leq x^x+x^x=2x^x</span><script type="math/tex">y^y+z^z\leq x^x+x^x=2x^x</script></span>，所以 <span class="arithmatex"><span class="MathJax_Preview">x=y=z</span><script type="math/tex">x=y=z</script></span>.</p>
<h2 id="_8">欧拉函数</h2>
<p><span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 中与 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 互质的数的个数被称为欧拉函数，记为 <span class="arithmatex"><span class="MathJax_Preview">\varphi(N)</span><script type="math/tex">\varphi(N)</script></span>. 用数学符号表示即为 <span class="arithmatex"><span class="MathJax_Preview">\varphi(N)=\displaystyle\sum_{i=1}^{N}[\gcd(i,N)=1]</span><script type="math/tex">\varphi(N)=\displaystyle\sum_{i=1}^{N}[\gcd(i,N)=1]</script></span>.</p>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">N = p_1^{c_1}p_2^{c_2}\dots p_n^{c_n}</span><script type="math/tex">N = p_1^{c_1}p_2^{c_2}\dots p_n^{c_n}</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\varphi(N)=N\times\frac{p_1-1}{p_1}\times\frac{p_2-1}{p_2}\times\dots\times\frac{p_n-1}{p_n}=N\cdot\displaystyle\prod_{质数p|N}\left(1-\frac{1}{p}\right)</span><script type="math/tex">\displaystyle\varphi(N)=N\times\frac{p_1-1}{p_1}\times\frac{p_2-1}{p_2}\times\dots\times\frac{p_n-1}{p_n}=N\cdot\displaystyle\prod_{质数p|N}\left(1-\frac{1}{p}\right)</script></span></p>
<p>证明：设 <span class="arithmatex"><span class="MathJax_Preview">p,q</span><script type="math/tex">p,q</script></span> 为 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的不同质因子，<span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 中 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的倍数有 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle \frac{N}{p}</span><script type="math/tex">\displaystyle \frac{N}{p}</script></span> 个，<span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 的倍数有 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle \frac{N}{q}</span><script type="math/tex">\displaystyle \frac{N}{q}</script></span> 个。若把 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle \frac{N}{p}+\frac{N}{q}</span><script type="math/tex">\displaystyle \frac{N}{p}+\frac{N}{q}</script></span> 个数去掉，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{N}{pq}</span><script type="math/tex">\displaystyle\frac{N}{pq}</script></span> 被计算了 <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span> 次（容斥原理）。因此， <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 中不与 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 含有相同质因子的 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> 数量为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle N-\frac{N}{p}-\frac{N}{q}+\frac{N}{pq}=N\left(1-\frac{1}{p}\right)\left(1-\frac{1}{q}\right)</span><script type="math/tex">\displaystyle N-\frac{N}{p}-\frac{N}{q}+\frac{N}{pq}=N\left(1-\frac{1}{p}\right)\left(1-\frac{1}{q}\right)</script></span>，对 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> 的全部质因子继续容斥即可得到公式。</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">3</span><script type="math/tex">3</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">5</span><script type="math/tex">5</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">6</span><script type="math/tex">6</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">7</span><script type="math/tex">7</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">8</span><script type="math/tex">8</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">9</span><script type="math/tex">9</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">10</span><script type="math/tex">10</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">11</span><script type="math/tex">11</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">12</span><script type="math/tex">12</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">13</span><script type="math/tex">13</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">14</span><script type="math/tex">14</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">15</span><script type="math/tex">15</script></span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\varphi(n)</span><script type="math/tex">\varphi(n)</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">6</span><script type="math/tex">6</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">6</span><script type="math/tex">6</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">10</span><script type="math/tex">10</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">12</span><script type="math/tex">12</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">6</span><script type="math/tex">6</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">8</span><script type="math/tex">8</script></span></td>
</tr>
</tbody>
</table>
<p>欧拉函数的性质：</p>
<ol>
<li><span class="arithmatex"><span class="MathJax_Preview">\forall n&gt;1</span><script type="math/tex">\forall n>1</script></span>，<span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 中与 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 互质的数的和为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{n\times\varphi(n)}{2}</span><script type="math/tex">\displaystyle\frac{n\times\varphi(n)}{2}</script></span>.</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 互质，则 <span class="arithmatex"><span class="MathJax_Preview">\varphi(ab)=\varphi(a)\varphi(b)</span><script type="math/tex">\varphi(ab)=\varphi(a)\varphi(b)</script></span>.</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为质数，<span class="arithmatex"><span class="MathJax_Preview">\varphi(p)=p-1</span><script type="math/tex">\varphi(p)=p-1</script></span>.</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为质数，<span class="arithmatex"><span class="MathJax_Preview">k\in\N^*,\varphi(p^k)=p^{k-1}\times(p-1)=p^k-p^{k-1}</span><script type="math/tex">k\in\N^*,\varphi(p^k)=p^{k-1}\times(p-1)=p^k-p^{k-1}</script></span>.</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为质数，若 <span class="arithmatex"><span class="MathJax_Preview">p\mid n</span><script type="math/tex">p\mid n</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">p^2\mid n</span><script type="math/tex">p^2\mid n</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\times p</span><script type="math/tex">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\times p</script></span>.</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为质数，若 <span class="arithmatex"><span class="MathJax_Preview">p\mid n</span><script type="math/tex">p\mid n</script></span> 但 <span class="arithmatex"><span class="MathJax_Preview">p^2\nmid n</span><script type="math/tex">p^2\nmid n</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\times (p-1)</span><script type="math/tex">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\times (p-1)</script></span>.</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为奇数，则 <span class="arithmatex"><span class="MathJax_Preview">\varphi(2n)=\varphi(n)</span><script type="math/tex">\varphi(2n)=\varphi(n)</script></span>.</li>
<li><span class="arithmatex"><span class="MathJax_Preview">\forall n\geq 3,\ n\in\N^*,\ 2\mid\varphi(n)</span><script type="math/tex">\forall n\geq 3,\ n\in\N^*,\ 2\mid\varphi(n)</script></span>.</li>
<li>欧拉反演：<span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{d\mid n}\varphi(d)=n</span><script type="math/tex">\displaystyle\sum_{d\mid n}\varphi(d)=n</script></span>.</li>
</ol>
<p>证明：</p>
<ol>
<li>因为 <span class="arithmatex"><span class="MathJax_Preview">\gcd(n,x)=\gcd(n,n-x)</span><script type="math/tex">\gcd(n,x)=\gcd(n,n-x)</script></span>，所以与 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 不互质的数 <span class="arithmatex"><span class="MathJax_Preview">x,n-x</span><script type="math/tex">x,n-x</script></span> 成对出现，平均值为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{n}{2}</span><script type="math/tex">\displaystyle\frac{n}{2}</script></span>. <span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 因此与 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 互质的数的平均值也是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{n}{2}</span><script type="math/tex">\displaystyle\frac{n}{2}</script></span>，进而得到性质 1。</li>
<li>根据欧拉函数的计算式可直接获得性质 2。</li>
<li>根据欧拉函数的定义可直接获得性质 3。</li>
<li>从 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">p^{k}</span><script type="math/tex">p^{k}</script></span> 中的所有数，除了 <span class="arithmatex"><span class="MathJax_Preview">p^{k-1}</span><script type="math/tex">p^{k-1}</script></span> 个 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的倍数外都与 <span class="arithmatex"><span class="MathJax_Preview">p^k</span><script type="math/tex">p^k</script></span> 互素。</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">p\mid n</span><script type="math/tex">p\mid n</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">p^2\mid n</span><script type="math/tex">p^2\mid n</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle n,\frac{n}{p}</span><script type="math/tex">\displaystyle n,\frac{n}{p}</script></span> 包含相同的质因子，只是 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的指数不同。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 按照欧拉函数的计算公式，<span class="arithmatex"><span class="MathJax_Preview">\displaystyle \frac{\varphi(n)}{\varphi(\frac{n}{p})}=\frac{n}{\frac{n}{p}}=p</span><script type="math/tex">\displaystyle \frac{\varphi(n)}{\varphi(\frac{n}{p})}=\frac{n}{\frac{n}{p}}=p</script></span>，得到性质 5。</li>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">p\mid n</span><script type="math/tex">p\mid n</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">p^2\mid n</span><script type="math/tex">p^2\mid n</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle n,\frac{n}{p}</span><script type="math/tex">\displaystyle n,\frac{n}{p}</script></span> 互质。因为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\varphi(p)</span><script type="math/tex">\displaystyle\varphi(n)=\varphi\left(\frac{n}{p}\right)\varphi(p)</script></span>，而 <span class="arithmatex"><span class="MathJax_Preview">\varphi(p)=p-1</span><script type="math/tex">\varphi(p)=p-1</script></span>，得到性质 6。</li>
<li><span class="arithmatex"><span class="MathJax_Preview">\forall m&lt;2n,m\in\N^*</span><script type="math/tex">\forall m<2n,m\in\N^*</script></span>，若 <span class="arithmatex"><span class="MathJax_Preview">2\mid m</span><script type="math/tex">2\mid m</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\gcd(m,2n)\neq 1</span><script type="math/tex">\gcd(m,2n)\neq 1</script></span>，也就是对欧拉函数的值没有贡献；<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 若 <span class="arithmatex"><span class="MathJax_Preview">2\nmid m</span><script type="math/tex">2\nmid m</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">\gcd(m,2n)=1</span><script type="math/tex">\gcd(m,2n)=1</script></span>，欧拉函数的值也就与 <span class="arithmatex"><span class="MathJax_Preview">2n</span><script type="math/tex">2n</script></span> 中的偶质因子无关。</li>
<li><span class="arithmatex"><span class="MathJax_Preview">n\geq 3</span><script type="math/tex">n\geq 3</script></span> 时，与 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 互质的数不可能为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{n}{2}\implies\forall x&lt;n,\gcd(x,n)=\gcd(n-x,n)</span><script type="math/tex">\displaystyle\frac{n}{2}\implies\forall x<n,\gcd(x,n)=\gcd(n-x,n)</script></span>，也就是存在一一对应关系。</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">f(n)=\displaystyle\sum_{d\mid n}\varphi(d)</span><script type="math/tex">f(n)=\displaystyle\sum_{d\mid n}\varphi(d)</script></span>，利用 <span class="arithmatex"><span class="MathJax_Preview">\varphi</span><script type="math/tex">\varphi</script></span> 是积性函数，得到：<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 若 <span class="arithmatex"><span class="MathJax_Preview">n,m</span><script type="math/tex">n,m</script></span> 互质，则 <span class="arithmatex"><span class="MathJax_Preview">f(nm)=\displaystyle\sum_{d\mid nm}\varphi(d)=\displaystyle\sum_{d\mid n}\varphi(d)\cdot\displaystyle\sum_{d\mid m}\varphi(d)=f(n)f(m)</span><script type="math/tex">f(nm)=\displaystyle\sum_{d\mid nm}\varphi(d)=\displaystyle\sum_{d\mid n}\varphi(d)\cdot\displaystyle\sum_{d\mid m}\varphi(d)=f(n)f(m)</script></span>，即 <span class="arithmatex"><span class="MathJax_Preview">f(n)</span><script type="math/tex">f(n)</script></span> 是积性函数。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 对于单个质因子有：<span class="arithmatex"><span class="MathJax_Preview">\begin{aligned}f(p^m)&amp;=\displaystyle\sum_{d\mid p^m}\varphi(d)=\displaystyle\sum_{i=0}^{m}\varphi(p^i)=\varphi(1)+\varphi(p)+\varphi(p^2)+\varphi(p^3)+\dots+\varphi(p^m)\\&amp;= 1+(p-1)+(p-1)p+(p-1)p^2+\dots+(p-1)p^{m-1}\\&amp;=1+(p-1)+(p^2-p)+(p^3-p^2)+\dots+(p^m-p^{m-1})=p^m\end{aligned} \\</span><script type="math/tex">\begin{aligned}f(p^m)&=\displaystyle\sum_{d\mid p^m}\varphi(d)=\displaystyle\sum_{i=0}^{m}\varphi(p^i)=\varphi(1)+\varphi(p)+\varphi(p^2)+\varphi(p^3)+\dots+\varphi(p^m)\\&= 1+(p-1)+(p-1)p+(p-1)p^2+\dots+(p-1)p^{m-1}\\&=1+(p-1)+(p^2-p)+(p^3-p^2)+\dots+(p^m-p^{m-1})=p^m\end{aligned} \\</script></span> 所以 <span class="arithmatex"><span class="MathJax_Preview">f(n)=\displaystyle\prod_{i=1}^{m}f(p_i^{c_i})=\displaystyle\prod_{i=1}^{m}p_i^{c_i}=n</span><script type="math/tex">f(n)=\displaystyle\prod_{i=1}^{m}f(p_i^{c_i})=\displaystyle\prod_{i=1}^{m}p_i^{c_i}=n</script></span></li>
</ol>
<h3 id="_9">积性函数与完全积性函数</h3>
<p>若函数 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 满足 <span class="arithmatex"><span class="MathJax_Preview">f(1)=1</span><script type="math/tex">f(1)=1</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">\forall x,y\in\N^{*},\gcd(x,y)=1</span><script type="math/tex">\forall x,y\in\N^{*},\gcd(x,y)=1</script></span> 都有 <span class="arithmatex"><span class="MathJax_Preview">f(xy)=f(x)f(y)</span><script type="math/tex">f(xy)=f(x)f(y)</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 是积性函数。</p>
<p>若函数 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 满足 <span class="arithmatex"><span class="MathJax_Preview">f(1)=1</span><script type="math/tex">f(1)=1</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">\forall x,y\in\N^{*}</span><script type="math/tex">\forall x,y\in\N^{*}</script></span> 都有 <span class="arithmatex"><span class="MathJax_Preview">f(xy)=f(x)f(y)</span><script type="math/tex">f(xy)=f(x)f(y)</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 是完全积性函数。</p>
<p>性质：</p>
<ol>
<li>若 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">g(x)</span><script type="math/tex">g(x)</script></span> 均为积性函数，则以下函数也为积性函数：
   $<span class="arithmatex"><span class="MathJax_Preview">\begin{aligned}h(x)&amp;=f(x^p) \\ h(x)&amp;=f^p(x) \\ h(x)&amp;=f(x)g(x) \\ h(x)&amp;=\displaystyle\sum_{d\mid x}f(d)g\left(\frac{x}{d}\right)\end{aligned}</span><script type="math/tex">\begin{aligned}h(x)&=f(x^p) \\ h(x)&=f^p(x) \\ h(x)&=f(x)g(x) \\ h(x)&=\displaystyle\sum_{d\mid x}f(d)g\left(\frac{x}{d}\right)\end{aligned}</script></span>$</li>
<li>设 <span class="arithmatex"><span class="MathJax_Preview">x=\displaystyle\prod p_i^{c_i}</span><script type="math/tex">x=\displaystyle\prod p_i^{c_i}</script></span>，</li>
</ol>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 为积性函数，则 <span class="arithmatex"><span class="MathJax_Preview">f(x)=\displaystyle\prod f(p_i^{c_i})</span><script type="math/tex">f(x)=\displaystyle\prod f(p_i^{c_i})</script></span>。</p>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> 为完全积性函数，则 <span class="arithmatex"><span class="MathJax_Preview">f(x)=\displaystyle\prod f^{c_i}(p_i)</span><script type="math/tex">f(x)=\displaystyle\prod f^{c_i}(p_i)</script></span>。</p>
<p>例子：</p>
<p>积性函数：<span class="arithmatex"><span class="MathJax_Preview">\varphi(n),\sigma _k(n)=\displaystyle\sum_{d\mid n}d^k,\sigma _0(n)</span><script type="math/tex">\varphi(n),\sigma _k(n)=\displaystyle\sum_{d\mid n}d^k,\sigma _0(n)</script></span> 通常简记为 <span class="arithmatex"><span class="MathJax_Preview">d(n)</span><script type="math/tex">d(n)</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">\tau(n)</span><script type="math/tex">\tau(n)</script></span>，<span class="arithmatex"><span class="MathJax_Preview">\sigma _1(n)</span><script type="math/tex">\sigma _1(n)</script></span> 通常简记为 <span class="arithmatex"><span class="MathJax_Preview">\sigma(n)</span><script type="math/tex">\sigma(n)</script></span>。</p>
<p>完全积性函数：<span class="arithmatex"><span class="MathJax_Preview">\varepsilon(n)=[n=1],\text{id}_k(n)=n^k,\text{id}_1(n)</span><script type="math/tex">\varepsilon(n)=[n=1],\text{id}_k(n)=n^k,\text{id}_1(n)</script></span> 通常简记为 <span class="arithmatex"><span class="MathJax_Preview">\text{id}(n),f(n)=1</span><script type="math/tex">\text{id}(n),f(n)=1</script></span>.</p>
<h2 id="_10">同余</h2>
<ul>
<li>平方数 <span class="arithmatex"><span class="MathJax_Preview">\mathrm{mod}\ 4\equiv 0</span><script type="math/tex">\mathrm{mod}\ 4\equiv 0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">1,\mathrm{mod}\ 8\equiv0</span><script type="math/tex">1,\mathrm{mod}\ 8\equiv0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">4,\mathrm{mod}\ 3\equiv 0</span><script type="math/tex">4,\mathrm{mod}\ 3\equiv 0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">1,\mathrm{mod}\ 5\equiv0</span><script type="math/tex">1,\mathrm{mod}\ 5\equiv0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">\pm 1</span><script type="math/tex">\pm 1</script></span>.</li>
<li>立方数 <span class="arithmatex"><span class="MathJax_Preview">\mathrm{mod}\ 9\equiv 0</span><script type="math/tex">\mathrm{mod}\ 9\equiv 0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">\pm 1</span><script type="math/tex">\pm 1</script></span>.</li>
<li>四次幂 <span class="arithmatex"><span class="MathJax_Preview">\mathrm{mod}\ 16\equiv 0</span><script type="math/tex">\mathrm{mod}\ 16\equiv 0</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>.</li>
</ul>
<p>例如可证明 <span class="arithmatex"><span class="MathJax_Preview">a,b,c,d\in\N^*,a^{4b+d}-a^{4c+d}</span><script type="math/tex">a,b,c,d\in\N^*,a^{4b+d}-a^{4c+d}</script></span> 能被 <span class="arithmatex"><span class="MathJax_Preview">240=2^4\times 3\times 5</span><script type="math/tex">240=2^4\times 3\times 5</script></span> 整除。</p>
<p>例 1：设 <span class="arithmatex"><span class="MathJax_Preview">a,b,c\in\Z,a+b+c=0,d=a^{1999}+b^{1999}+c^{1999}</span><script type="math/tex">a,b,c\in\Z,a+b+c=0,d=a^{1999}+b^{1999}+c^{1999}</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> 可被 <span class="arithmatex"><span class="MathJax_Preview">6</span><script type="math/tex">6</script></span> 整除。</p>
<div class="arithmatex">
<div class="MathJax_Preview">u^{1999}\equiv u(\mathrm{mod}\ 2)\implies d\equiv a+b+c\equiv 0(\mathrm{mod}\ 2)\implies2|d</div>
<script type="math/tex; mode=display">u^{1999}\equiv u(\mathrm{mod}\ 2)\implies d\equiv a+b+c\equiv 0(\mathrm{mod}\ 2)\implies2|d</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">u^3\equiv u(\mathrm{mod}\ 3)\implies u^{1999}\equiv u\cdot u^{1998}\equiv u\cdot u^{666}\equiv u\cdot u^{222}\equiv u^{75}\equiv u^{25}\equiv u^9\equiv u(\mathrm{mod}\ 3)</div>
<script type="math/tex; mode=display">u^3\equiv u(\mathrm{mod}\ 3)\implies u^{1999}\equiv u\cdot u^{1998}\equiv u\cdot u^{666}\equiv u\cdot u^{222}\equiv u^{75}\equiv u^{25}\equiv u^9\equiv u(\mathrm{mod}\ 3)</script>
</div>
<p>注意 <span class="arithmatex"><span class="MathJax_Preview">u^3\equiv u(\mathrm{mod}\ 3)</span><script type="math/tex">u^3\equiv u(\mathrm{mod}\ 3)</script></span> 是费马小定理的特殊情形。</p>
<p>练 1：设 <span class="arithmatex"><span class="MathJax_Preview">x,y,z\in\Z,(x-y)(y-z)(z-x)=x+y+z</span><script type="math/tex">x,y,z\in\Z,(x-y)(y-z)(z-x)=x+y+z</script></span>，证明 <span class="arithmatex"><span class="MathJax_Preview">27|(x+y+z)</span><script type="math/tex">27|(x+y+z)</script></span>.</p>
<p>只要证明 <span class="arithmatex"><span class="MathJax_Preview">x,y,z</span><script type="math/tex">x,y,z</script></span> 两两模 <span class="arithmatex"><span class="MathJax_Preview">3</span><script type="math/tex">3</script></span> 同余即可。</p>
<p>练 2：证明 <span class="arithmatex"><span class="MathJax_Preview">11,111,1111,\dots</span><script type="math/tex">11,111,1111,\dots</script></span> 不是完全平方数。只要知道 <span class="arithmatex"><span class="MathJax_Preview">11\ \mathrm{mod}\ 4\neq 0</span><script type="math/tex">11\ \mathrm{mod}\ 4\neq 0</script></span> 即可。</p>
<hr />
<p>例 2：数列 <span class="arithmatex"><span class="MathJax_Preview">\set{x_n}</span><script type="math/tex">\set{x_n}</script></span> 为 <span class="arithmatex"><span class="MathJax_Preview">1,3,5,11,\dots</span><script type="math/tex">1,3,5,11,\dots</script></span>，满足 <span class="arithmatex"><span class="MathJax_Preview">x_{n+1}=x_n+2x_{n-1}</span><script type="math/tex">x_{n+1}=x_n+2x_{n-1}</script></span>.</p>
<p>数列 <span class="arithmatex"><span class="MathJax_Preview">\set{y_n}</span><script type="math/tex">\set{y_n}</script></span> 为 <span class="arithmatex"><span class="MathJax_Preview">7,17,55,161,\dots</span><script type="math/tex">7,17,55,161,\dots</script></span>，满足 <span class="arithmatex"><span class="MathJax_Preview">y_{n+1}=2y_n+3y_{n-1}</span><script type="math/tex">y_{n+1}=2y_n+3y_{n-1}</script></span>. 证明：两个数列无相同项。</p>
<p>考虑以 <span class="arithmatex"><span class="MathJax_Preview">8</span><script type="math/tex">8</script></span> 为模，因为 <span class="arithmatex"><span class="MathJax_Preview">x_2\equiv 3,x_3\equiv 5</span><script type="math/tex">x_2\equiv 3,x_3\equiv 5</script></span>. 若 <span class="arithmatex"><span class="MathJax_Preview">x_{n-1}\equiv 3,x_n\equiv 5</span><script type="math/tex">x_{n-1}\equiv 3,x_n\equiv 5</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">x_{n+1}\equiv 3,x_{n+2}\equiv 5</span><script type="math/tex">x_{n+1}\equiv 3,x_{n+2}\equiv 5</script></span>.</p>
<p>显然 <span class="arithmatex"><span class="MathJax_Preview">\set{x_n}</span><script type="math/tex">\set{x_n}</script></span> 是模 <span class="arithmatex"><span class="MathJax_Preview">8</span><script type="math/tex">8</script></span> 后的周期数列，同理 <span class="arithmatex"><span class="MathJax_Preview">\set{y_n}</span><script type="math/tex">\set{y_n}</script></span> 也是（ <span class="arithmatex"><span class="MathJax_Preview">7,1,7,1,\dots</span><script type="math/tex">7,1,7,1,\dots</script></span> ），于是命题得证。</p>
<h3 id="_11">费马小定理与欧拉定理</h3>
<p>若整数 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 和整数 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 除以正整数 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的余数相等，则称 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 同余，记为 <span class="arithmatex"><span class="MathJax_Preview">a\equiv b\ (\mathrm{mod}\  m)</span><script type="math/tex">a\equiv b\ (\mathrm{mod}\  m)</script></span>.</p>
<p>并且注意到 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle k\ \mathrm{mod}\ i=k-\left\lfloor\frac{k}{i}\right\rfloor\cdot i</span><script type="math/tex">\displaystyle k\ \mathrm{mod}\ i=k-\left\lfloor\frac{k}{i}\right\rfloor\cdot i</script></span>，且同余满足同加性、同乘性、同幂性，但不满足同除性。</p>
<p>对于 <span class="arithmatex"><span class="MathJax_Preview">\forall a \in [0, m - 1]</span><script type="math/tex">\forall a \in [0, m - 1]</script></span>，集合 <span class="arithmatex"><span class="MathJax_Preview">\set{a+km\ (k\in\Z)}</span><script type="math/tex">\set{a+km\ (k\in\Z)}</script></span> 的所有数模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 同余，余数都是 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>. 该集合称为一个模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的同余类，简记为 <span class="arithmatex"><span class="MathJax_Preview">\overline{a}</span><script type="math/tex">\overline{a}</script></span>.</p>
<p>模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的同余类一共有 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 个，分别为 <span class="arithmatex"><span class="MathJax_Preview">\overline{0},\overline{1},\overline{2},\dots,\overline{m-1}</span><script type="math/tex">\overline{0},\overline{1},\overline{2},\dots,\overline{m-1}</script></span>. 它们构成 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的完全剩余系。</p>
<p><span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> ~ <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 中与 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 互质的数代表的同余类共有 <span class="arithmatex"><span class="MathJax_Preview">\varphi(m)</span><script type="math/tex">\varphi(m)</script></span> 个，它们构成 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的简化剩余系。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 例如，模 <span class="arithmatex"><span class="MathJax_Preview">10</span><script type="math/tex">10</script></span> 的简化剩余系为 <span class="arithmatex"><span class="MathJax_Preview">\set{\overline{1},\overline{3},\overline{7},\overline{9}}</span><script type="math/tex">\set{\overline{1},\overline{3},\overline{7},\overline{9}}</script></span>。</p>
<p>若从某个非空数集中任选两个元素（同一元素可重复选出），选出的这两个元素通过某种（或几种）运算后的得数仍是该数集中的元素，那么，就说该集合对于这种（或几种）运算是封闭的。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 例如若一个集合中的元素，如果能够做到做加法运算的结果还在这个集合中，就说这个集合对加法运算封闭。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 例如 <span class="arithmatex"><span class="MathJax_Preview">\N</span><script type="math/tex">\N</script></span> 对加法、乘法运算是封闭的；<span class="arithmatex"><span class="MathJax_Preview">\Z</span><script type="math/tex">\Z</script></span> 对加、减、乘法运算是封闭的；<span class="arithmatex"><span class="MathJax_Preview">\mathbb{Q}, \mathbb{C}</span><script type="math/tex">\mathbb{Q}, \mathbb{C}</script></span> 对四则运算是封闭的。</p>
<p>简化剩余系关于模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 乘法封闭。这是因为若 <span class="arithmatex"><span class="MathJax_Preview">a,b\ (1\leq a,b\leq m)</span><script type="math/tex">a,b\ (1\leq a,b\leq m)</script></span> 与 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 互质，则 <span class="arithmatex"><span class="MathJax_Preview">ab</span><script type="math/tex">ab</script></span> 也与 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 互质。<span class="arithmatex"><span class="MathJax_Preview">\\</span><script type="math/tex">\\</script></span> 由余数的定义得 <span class="arithmatex"><span class="MathJax_Preview">ab\ \mathrm{mod}\ m</span><script type="math/tex">ab\ \mathrm{mod}\ m</script></span> 也与 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 互质，即 <span class="arithmatex"><span class="MathJax_Preview">ab\ \mathrm{mod}\ m</span><script type="math/tex">ab\ \mathrm{mod}\ m</script></span> 也属于 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 的简化剩余系。</p>
<ul>
<li>费马小定理：若 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 是质数，则对于任意整数 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">a^p\equiv a\ (\mathrm{mod}\ p)</span><script type="math/tex">a^p\equiv a\ (\mathrm{mod}\ p)</script></span>.</li>
<li>欧拉定理：若正整数 <span class="arithmatex"><span class="MathJax_Preview">a,n</span><script type="math/tex">a,n</script></span> 互质，则 <span class="arithmatex"><span class="MathJax_Preview">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</script></span>.</li>
</ul>
<p>证明：设 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 的简化剩余系为 <span class="arithmatex"><span class="MathJax_Preview">\set{\overline{a_1},\overline{a_2},\dots,\overline{a_{\varphi(n)}}}</span><script type="math/tex">\set{\overline{a_1},\overline{a_2},\dots,\overline{a_{\varphi(n)}}}</script></span>. <span class="arithmatex"><span class="MathJax_Preview">\forall a_i,a_j</span><script type="math/tex">\forall a_i,a_j</script></span>，若 <span class="arithmatex"><span class="MathJax_Preview">a\cdot a_i\equiv a\cdot a_j\ (\mathrm{mod}\ n)</span><script type="math/tex">a\cdot a_i\equiv a\cdot a_j\ (\mathrm{mod}\ n)</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">a\cdot(a_i-a_j)\equiv 0.</span><script type="math/tex">a\cdot(a_i-a_j)\equiv 0.</script></span> 因为 <span class="arithmatex"><span class="MathJax_Preview">a,n</span><script type="math/tex">a,n</script></span> 互质，所以 <span class="arithmatex"><span class="MathJax_Preview">a_i\equiv a_j</span><script type="math/tex">a_i\equiv a_j</script></span>. 故当 <span class="arithmatex"><span class="MathJax_Preview">a_i\neq a_j</span><script type="math/tex">a_i\neq a_j</script></span> 时，<span class="arithmatex"><span class="MathJax_Preview">aa_i,aa_j</span><script type="math/tex">aa_i,aa_j</script></span> 也代表不同的同余类。</p>
<p>又因为简化剩余系关于模 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 乘法封闭，故 <span class="arithmatex"><span class="MathJax_Preview">\overline{aa_1}</span><script type="math/tex">\overline{aa_1}</script></span> 也在简化剩余系集合中。因此，集合 <span class="arithmatex"><span class="MathJax_Preview">\set{\overline{a_1},\overline{a_2},\dots,\overline{a_{\varphi(n)}}}</span><script type="math/tex">\set{\overline{a_1},\overline{a_2},\dots,\overline{a_{\varphi(n)}}}</script></span> 与集合 <span class="arithmatex"><span class="MathJax_Preview">\set{\overline{aa_1},\overline{aa_2},\dots,\overline{aa_{\varphi(n)}}}</span><script type="math/tex">\set{\overline{aa_1},\overline{aa_2},\dots,\overline{aa_{\varphi(n)}}}</script></span> 都能表示 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 的简化剩余系。综上所述：</p>
<div class="arithmatex">
<div class="MathJax_Preview">a^{\varphi(n)}a_1a_2\dots a_{\varphi(n)}\equiv(aa_1)(aa_2)\dots(aa_{\varphi(n)})\equiv a_1a_2\dots a_{\varphi(n)}\ (\mathrm{mod}\ n)</div>
<script type="math/tex; mode=display">a^{\varphi(n)}a_1a_2\dots a_{\varphi(n)}\equiv(aa_1)(aa_2)\dots(aa_{\varphi(n)})\equiv a_1a_2\dots a_{\varphi(n)}\ (\mathrm{mod}\ n)</script>
</div>
<p>因此 <span class="arithmatex"><span class="MathJax_Preview">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</script></span>。当 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为质数时，满足 <span class="arithmatex"><span class="MathJax_Preview">\varphi(p)=p-1</span><script type="math/tex">\varphi(p)=p-1</script></span>，两边同乘 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 即可得到费马小定理。</p>
<p>另外，当 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 是 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 的倍数，费马小定理显然成立。</p>
<hr />
<ul>
<li>欧拉定理的推论：若正整数 <span class="arithmatex"><span class="MathJax_Preview">a,n</span><script type="math/tex">a,n</script></span> 互质，则对于任意正整数 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">a^b\equiv a^{b\ \mathrm{mod}\ \varphi(n)}\ (\mathrm{mod}\ n)</span><script type="math/tex">a^b\equiv a^{b\ \mathrm{mod}\ \varphi(n)}\ (\mathrm{mod}\ n)</script></span></li>
</ul>
<p>证明：设 <span class="arithmatex"><span class="MathJax_Preview">b=q\cdot \varphi(n)+r</span><script type="math/tex">b=q\cdot \varphi(n)+r</script></span>，其中 <span class="arithmatex"><span class="MathJax_Preview">0\leq r&lt;\varphi(n)</span><script type="math/tex">0\leq r<\varphi(n)</script></span>，即 <span class="arithmatex"><span class="MathJax_Preview">r=b\ \mathrm{mod}\ \varphi(n)</span><script type="math/tex">r=b\ \mathrm{mod}\ \varphi(n)</script></span>. 于是有：</p>
<div class="arithmatex">
<div class="MathJax_Preview">a^b\equiv a^{q\cdot\varphi(n)+r}\equiv (a^{\varphi(n)})^q\cdot a^r\equiv 1^q\cdot a^r\equiv a^r\equiv a^{b\ \mathrm{mod}\ \varphi(n)}\ (\mathrm{mod}\ n)</div>
<script type="math/tex; mode=display">a^b\equiv a^{q\cdot\varphi(n)+r}\equiv (a^{\varphi(n)})^q\cdot a^r\equiv 1^q\cdot a^r\equiv a^r\equiv a^{b\ \mathrm{mod}\ \varphi(n)}\ (\mathrm{mod}\ n)</script>
</div>
<p>证毕。面对 <span class="arithmatex"><span class="MathJax_Preview">a+b,a-b,a\cdot b</span><script type="math/tex">a+b,a-b,a\cdot b</script></span> 这样的算式，可以在计算前先把 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 对 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 取模。面对 <span class="arithmatex"><span class="MathJax_Preview">a^b</span><script type="math/tex">a^b</script></span> 这样的乘方算式，可以先把底数对 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 取模、指数对 <span class="arithmatex"><span class="MathJax_Preview">\varphi(p)</span><script type="math/tex">\varphi(p)</script></span> 取模，再计算乘方。</p>
<p>即 <span class="arithmatex"><span class="MathJax_Preview">a^b\equiv (a\ \mathrm{mod}\ p)^{b\ \mathrm{mod}\ \varphi(p)}\ (\mathrm{mod}\ p)</span><script type="math/tex">a^b\equiv (a\ \mathrm{mod}\ p)^{b\ \mathrm{mod}\ \varphi(p)}\ (\mathrm{mod}\ p)</script></span></p>
<hr />
<ul>
<li>扩展欧拉定理</li>
</ul>
<p>$<span class="arithmatex"><span class="MathJax_Preview">a^b\equiv\begin{cases}a^{b\ \mathrm{mod}\ \varphi(m)}&amp;\text{if }\gcd(a,m)=1\\ a^b&amp;\text{if }\gcd(a,m)\neq 1,b&lt;\varphi(m)\\ a^{b\ \mathrm{mod}\ \varphi(m)+\varphi(m)}&amp;\text{if }\gcd(a,m)\neq 1,b\geq\varphi(m)\end{cases}\ (\mathrm{mod}\ m)</span><script type="math/tex">a^b\equiv\begin{cases}a^{b\ \mathrm{mod}\ \varphi(m)}&\text{if }\gcd(a,m)=1\\ a^b&\text{if }\gcd(a,m)\neq 1,b<\varphi(m)\\ a^{b\ \mathrm{mod}\ \varphi(m)+\varphi(m)}&\text{if }\gcd(a,m)\neq 1,b\geq\varphi(m)\end{cases}\ (\mathrm{mod}\ m)</script></span>$</p>
<p>证明十分显然，略。</p>
<hr />
<ul>
<li>若正整数 <span class="arithmatex"><span class="MathJax_Preview">a,n</span><script type="math/tex">a,n</script></span> 互质，则满足 <span class="arithmatex"><span class="MathJax_Preview">a^x\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^x\equiv 1\ (\mathrm{mod}\ n)</script></span> 的最小正整数 <span class="arithmatex"><span class="MathJax_Preview">x_0</span><script type="math/tex">x_0</script></span> 是 <span class="arithmatex"><span class="MathJax_Preview">\varphi(n)</span><script type="math/tex">\varphi(n)</script></span> 的约数。</li>
</ul>
<p>反证法，假设满足 <span class="arithmatex"><span class="MathJax_Preview">a^x\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^x\equiv 1\ (\mathrm{mod}\ n)</script></span> 的最小正整数 <span class="arithmatex"><span class="MathJax_Preview">x_0</span><script type="math/tex">x_0</script></span> 不能整除 <span class="arithmatex"><span class="MathJax_Preview">\varphi(n)</span><script type="math/tex">\varphi(n)</script></span>.</p>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">\varphi(n)=qx_0+r\ (0&lt;r&lt;x_0)</span><script type="math/tex">\varphi(n)=qx_0+r\ (0<r<x_0)</script></span>，因为 <span class="arithmatex"><span class="MathJax_Preview">a^{x_0}\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^{x_0}\equiv 1\ (\mathrm{mod}\ n)</script></span>，所以 <span class="arithmatex"><span class="MathJax_Preview">a^{qx_0}\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^{qx_0}\equiv 1\ (\mathrm{mod}\ n)</script></span>. 根据欧拉定理 <span class="arithmatex"><span class="MathJax_Preview">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</span><script type="math/tex">a^{\varphi(n)}\equiv 1\ (\mathrm{mod}\ n)</script></span>，所以 <span class="arithmatex"><span class="MathJax_Preview">a^r\equiv 1\ (\mathrm{mod}\  n)</span><script type="math/tex">a^r\equiv 1\ (\mathrm{mod}\  n)</script></span>. 这与 <span class="arithmatex"><span class="MathJax_Preview">x_0</span><script type="math/tex">x_0</script></span> 最小矛盾。故假设不成立，原命题成立。</p>
<h3 id="_12">中国剩余定理</h3>
<p>设 <span class="arithmatex"><span class="MathJax_Preview">m_1,m_2,\dots,m_n</span><script type="math/tex">m_1,m_2,\dots,m_n</script></span> 是两两互质的整数，<span class="arithmatex"><span class="MathJax_Preview">m=\displaystyle\prod_{i=1}^n m_i,M_i=\frac{m}{m_i},t_i</span><script type="math/tex">m=\displaystyle\prod_{i=1}^n m_i,M_i=\frac{m}{m_i},t_i</script></span> 是线性同余方程 <span class="arithmatex"><span class="MathJax_Preview">M_it_i\equiv 1\ (\mathrm{mod}\ m_i)</span><script type="math/tex">M_it_i\equiv 1\ (\mathrm{mod}\ m_i)</script></span> 的一个解。对于任意的 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个整数，方程组</p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{cases}x\equiv a_1\ (\mathrm{mod}\ m_1) \\ x\equiv a_2\ (\mathrm{mod}\ m_2)\\ \ \ \ \ \ \ \ \ \ \ \ \ \vdots\\ x\equiv a_n\ (\mathrm{mod}\ m_n)\end{cases}</div>
<script type="math/tex; mode=display">\begin{cases}x\equiv a_1\ (\mathrm{mod}\ m_1) \\ x\equiv a_2\ (\mathrm{mod}\ m_2)\\ \ \ \ \ \ \ \ \ \ \ \ \ \vdots\\ x\equiv a_n\ (\mathrm{mod}\ m_n)\end{cases}</script>
</div>
<p>有整数解，解为 <span class="arithmatex"><span class="MathJax_Preview">x=\displaystyle\sum_{i=1}^{n}a_iM_it_i</span><script type="math/tex">x=\displaystyle\sum_{i=1}^{n}a_iM_it_i</script></span>，通解可以表示为 <span class="arithmatex"><span class="MathJax_Preview">x+km(k\in\Z)</span><script type="math/tex">x+km(k\in\Z)</script></span>，最小非负整数解为 <span class="arithmatex"><span class="MathJax_Preview">x\ \mathrm{mod}\ m</span><script type="math/tex">x\ \mathrm{mod}\ m</script></span>.</p>
<p>证明：因为 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle M_i=\frac{m}{m_i}</span><script type="math/tex">\displaystyle M_i=\frac{m}{m_i}</script></span> 是除了 <span class="arithmatex"><span class="MathJax_Preview">m_i</span><script type="math/tex">m_i</script></span> 之外所有模数的倍数，所以 <span class="arithmatex"><span class="MathJax_Preview">\forall k\neq i,a_iM_it_i\equiv 0\ (\mathrm{mod}\ m_i)</span><script type="math/tex">\forall k\neq i,a_iM_it_i\equiv 0\ (\mathrm{mod}\ m_i)</script></span>，<span class="arithmatex"><span class="MathJax_Preview">\\ \ \  \ \ \ \ \  \ \ \ \text{}</span><script type="math/tex">\\ \ \  \ \ \ \ \  \ \ \ \text{}</script></span> 所以代入 <span class="arithmatex"><span class="MathJax_Preview">x=\displaystyle\sum_{i=1}^{n}a_iM_it_i</span><script type="math/tex">x=\displaystyle\sum_{i=1}^{n}a_iM_it_i</script></span>，原方程组成立。</p>
<h3 id="_13">威尔逊定理</h3>
<ul>
<li><span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为素数 <span class="arithmatex"><span class="MathJax_Preview">\xLeftrightarrow{}(p-1)!\equiv -1\ (\mathrm{mod}\ p)</span><script type="math/tex">\xLeftrightarrow{}(p-1)!\equiv -1\ (\mathrm{mod}\ p)</script></span></li>
</ul>
<p>证明：</p>
<ol>
<li>充分性</li>
</ol>
<p>对于 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 不是素数的情况，有 <span class="arithmatex"><span class="MathJax_Preview">\begin{cases}
   p=1 &amp; (1-1)!\equiv 0\ (\mathrm{mod}\ 1) \\
   p=4 &amp; (4-1)!\equiv 2\ (\mathrm{mod}\ 4) \\
   p&gt;4 &amp; 分类讨论得出\ (p-1)!\equiv 0\ (\mathrm{mod}\ p)
   \end{cases}</span><script type="math/tex">\begin{cases}
   p=1 & (1-1)!\equiv 0\ (\mathrm{mod}\ 1) \\
   p=4 & (4-1)!\equiv 2\ (\mathrm{mod}\ 4) \\
   p>4 & 分类讨论得出\ (p-1)!\equiv 0\ (\mathrm{mod}\ p)
   \end{cases}</script></span></p>
<p>(a) 当 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为完全平方数。</p>
<pre><code>则 $p=k^2$ 且 $k&gt;2$，用相减法比较 $2k$ 与 $p$ 的大小得 $2k&lt;p$，于是有

$$\begin{aligned}(p-1)!&amp;=1\times 2\times\dots\times k\times\dots\times 2k\times\dots\times (p-1)\\ &amp;=2nk^2\\&amp;=2np\end{aligned}$$

所以 $(p-1)!\equiv 0\ (\mathrm{mod}\ p)$ 且 $p$ 为完全平方数。

(b) 当 $p$ 不为完全平方数。

则 $p$ 可以表示为两个不相等的数 $a$ 和 $b$ 的乘积，设 $a&lt;b$，则有 $p=ab,1&lt;a&lt;b&lt;p$

$$\begin{aligned}(p-1)!&amp;=1\times 2\times\dots\times a\times\dots\times b\times\dots\times (p-1)\\&amp;=a\times b\times n\\ &amp;=np\end{aligned}$$

所以 $(p-1)!\equiv 0\ (\mathrm{mod}\ p)$ 且 $p$ 不为完全平方数。
</code></pre>
<ol>
<li>必要性</li>
</ol>
<p>当 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 为素数时，考虑二次剩余式 <span class="arithmatex"><span class="MathJax_Preview">x^2\equiv 1\ (\mathrm{mod}\ p)</span><script type="math/tex">x^2\equiv 1\ (\mathrm{mod}\ p)</script></span>，化简得 <span class="arithmatex"><span class="MathJax_Preview">(x-1)(x+1)\equiv 0\ (\mathrm{mod}\ p)</span><script type="math/tex">(x-1)(x+1)\equiv 0\ (\mathrm{mod}\ p)</script></span></p>
<p>于是 <span class="arithmatex"><span class="MathJax_Preview">x\equiv 1\ (\mathrm{mod}\ p)</span><script type="math/tex">x\equiv 1\ (\mathrm{mod}\ p)</script></span> 或 <span class="arithmatex"><span class="MathJax_Preview">x\equiv p-1\ (\mathrm{mod}\ p)</span><script type="math/tex">x\equiv p-1\ (\mathrm{mod}\ p)</script></span>。现在先抛开 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span> 不管，</p>
<p><span class="arithmatex"><span class="MathJax_Preview">\forall a\in [2,p-2]</span><script type="math/tex">\forall a\in [2,p-2]</script></span>，必然存在一个和它不相等的逆元 <span class="arithmatex"><span class="MathJax_Preview">a^{-1}\in[2,p-2]</span><script type="math/tex">a^{-1}\in[2,p-2]</script></span>，满足 <span class="arithmatex"><span class="MathJax_Preview">aa^{-1}\equiv 1\ (\mathrm{mod}\ p)</span><script type="math/tex">aa^{-1}\equiv 1\ (\mathrm{mod}\ p)</script></span></p>
<p>所以必然有 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{p-3}{2}</span><script type="math/tex">\displaystyle\frac{p-3}{2}</script></span> 对数相乘的乘积为 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>，即 <span class="arithmatex"><span class="MathJax_Preview">(p-2)!\equiv 1\ (\mathrm{mod}\ p)</span><script type="math/tex">(p-2)!\equiv 1\ (\mathrm{mod}\ p)</script></span></p>
<p>等式两边同时乘 <span class="arithmatex"><span class="MathJax_Preview">p-1</span><script type="math/tex">p-1</script></span> 就得到威尔逊定理。</p>
<p>例题：<span class="arithmatex"><span class="MathJax_Preview">n\in\N^*</span><script type="math/tex">n\in\N^*</script></span> 且 <span class="arithmatex"><span class="MathJax_Preview">n\leq 10^6</span><script type="math/tex">n\leq 10^6</script></span>，求 <span class="arithmatex"><span class="MathJax_Preview">S_n</span><script type="math/tex">S_n</script></span>.</p>
<div class="arithmatex">
<div class="MathJax_Preview">S_n=\displaystyle\sum_{k=1}^{n}\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor</div>
<script type="math/tex; mode=display">S_n=\displaystyle\sum_{k=1}^{n}\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor</script>
</div>
<p>令 <span class="arithmatex"><span class="MathJax_Preview">d=3k+7</span><script type="math/tex">d=3k+7</script></span>，原式化简为</p>
<div class="arithmatex">
<div class="MathJax_Preview">S_n=\displaystyle\sum_{k=1}^{n}\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor</div>
<script type="math/tex; mode=display">S_n=\displaystyle\sum_{k=1}^{n}\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor</script>
</div>
<p>由威尔逊定理，当 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> 为素数时，<span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{(d-1)!+1}{d}</span><script type="math/tex">\displaystyle\frac{(d-1)!+1}{d}</script></span> 必然是整数，而 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\left\lfloor\frac{(d-1)!}{d}\right\rfloor</span><script type="math/tex">\displaystyle\left\lfloor\frac{(d-1)!}{d}\right\rfloor</script></span> 必然比 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{(d-1)!+1}{d}</span><script type="math/tex">\displaystyle\frac{(d-1)!+1}{d}</script></span> 小 <span class="arithmatex"><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>，于是有：</p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{cases}p\ 为素数 &amp; \displaystyle\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor=1 \\ p\ 为合数 &amp; \displaystyle\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor=0\end{cases}</div>
<script type="math/tex; mode=display">\begin{cases}p\ 为素数 & \displaystyle\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor=1 \\ p\ 为合数 & \displaystyle\left\lfloor\frac{(d-1)!+1}{d}-\left\lfloor\frac{(d-1)!}{d}\right\rfloor\right\rfloor=0\end{cases}</script>
</div>
<p>所以只需统计 <span class="arithmatex"><span class="MathJax_Preview">[1,3\times 10^6+7]</span><script type="math/tex">[1,3\times 10^6+7]</script></span> 中的素数即可得出答案。</p>
<h2 id="_14">拉格朗日定理</h2>
<p>若 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 是质数，则对于模 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span> 意义下的 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 次整系数多项式 <span class="arithmatex"><span class="MathJax_Preview">f(x)=a_nx^n+a_{n-1}x^{n-1}+\dots+a_0(p\nmid a_n)</span><script type="math/tex">f(x)=a_nx^n+a_{n-1}x^{n-1}+\dots+a_0(p\nmid a_n)</script></span> 同余方程 <span class="arithmatex"><span class="MathJax_Preview">f(x)\equiv 0(\mathrm{mod}\ p)</span><script type="math/tex">f(x)\equiv 0(\mathrm{mod}\ p)</script></span> 至多有 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个不同的解。</p>
<!-- 数学 -->
<!-- 物理 -->
<!-- 化学 -->
<!-- 生物 -->
<!-- 教育 -->
<!-- 联合国与国际机构 -->
<!-- 欧洲联盟与地区组织 -->
</article>