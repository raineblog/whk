<article class="mkdocs-fragment"
         data-title="多项式科技"
         data-url="science/polynomial/2/">
  <h1 id="_1">多项式科技</h1>
<h2 id="_2">生成函数</h2>
<p>序列 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> （有穷无穷均可）的普通生成函数定义为形式幂级数：<span class="arithmatex"><span class="MathJax_Preview">\displaystyle F(x)=\sum_na_nx^n</span><script type="math/tex">\displaystyle F(x)=\sum_na_nx^n</script></span>。例如：</p>
<ol>
<li><span class="arithmatex"><span class="MathJax_Preview">a=\lang1,2,3\rang</span><script type="math/tex">a=\lang1,2,3\rang</script></span> 的普通生成函数是 <span class="arithmatex"><span class="MathJax_Preview">1+2x+3x^2</span><script type="math/tex">1+2x+3x^2</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">a=\lang1,1,1,\dots\rang</span><script type="math/tex">a=\lang1,1,1,\dots\rang</script></span> 的普通生成函数是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}x^n</span><script type="math/tex">\displaystyle\sum_{n\geq 0}x^n</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">a=\lang1,2,4,8,16,\dots\rang</span><script type="math/tex">a=\lang1,2,4,8,16,\dots\rang</script></span> 的生成函数是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}2^nx^n</span><script type="math/tex">\displaystyle\sum_{n\geq 0}2^nx^n</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">a=\lang1,3,5,7,9\rang</span><script type="math/tex">a=\lang1,3,5,7,9\rang</script></span> 的生成函数是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}(2n+1)x^n</span><script type="math/tex">\displaystyle\sum_{n\geq 0}(2n+1)x^n</script></span></li>
</ol>
<p>换句话说，如果序列 <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 有通项公式，那么它的普通生成函数的系数就是通项公式。</p>
<h3 id="_3">基本运算</h3>
<p>两个序列 <span class="arithmatex"><span class="MathJax_Preview">a,b</span><script type="math/tex">a,b</script></span> 的生成函数 <span class="arithmatex"><span class="MathJax_Preview">F(x),G(x)</span><script type="math/tex">F(x),G(x)</script></span>，则 <span class="arithmatex"><span class="MathJax_Preview">F(x)\pm G(x)</span><script type="math/tex">F(x)\pm G(x)</script></span> 是序列 <span class="arithmatex"><span class="MathJax_Preview">\lang a_n\pm b_n\rang</span><script type="math/tex">\lang a_n\pm b_n\rang</script></span> 的生成函数。</p>
<div class="arithmatex">
<div class="MathJax_Preview">F(x)\pm G(x)=\sum_{n}(a_n\pm b_n)x^n</div>
<script type="math/tex; mode=display">F(x)\pm G(x)=\sum_{n}(a_n\pm b_n)x^n</script>
</div>
<p>乘法运算即卷积，推出 <span class="arithmatex"><span class="MathJax_Preview">F(x)G(x)</span><script type="math/tex">F(x)G(x)</script></span> 是序列 <span class="arithmatex"><span class="MathJax_Preview">\left\lang\displaystyle\sum_{i=0}^na_ib_{n-i}\right\rang</span><script type="math/tex">\left\lang\displaystyle\sum_{i=0}^na_ib_{n-i}\right\rang</script></span> 的生成函数。</p>
<div class="arithmatex">
<div class="MathJax_Preview">F(x)G(x)=\sum_nx^n\sum_{i=0}^na_ib_{n-i}</div>
<script type="math/tex; mode=display">F(x)G(x)=\sum_nx^n\sum_{i=0}^na_ib_{n-i}</script>
</div>
<h4 id="toto">形式幂级数形式 <span class="arithmatex"><span class="MathJax_Preview">\to</span><script type="math/tex">\to</script></span> 封闭形式</h4>
<p>例如 <span class="arithmatex"><span class="MathJax_Preview">a=\lang1,1,1,\dots\rang</span><script type="math/tex">a=\lang1,1,1,\dots\rang</script></span> 的普通生成函数是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle F(x)=\sum_{n\geq 0}x^n</span><script type="math/tex">\displaystyle F(x)=\sum_{n\geq 0}x^n</script></span>，可以发现 <span class="arithmatex"><span class="MathJax_Preview">F(x)x+1=F(x)</span><script type="math/tex">F(x)x+1=F(x)</script></span>，于是解方程得到 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle F(x)=\frac{1}{1-x}</span><script type="math/tex">\displaystyle F(x)=\frac{1}{1-x}</script></span>，这就是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}x^n</span><script type="math/tex">\displaystyle\sum_{n\geq 0}x^n</script></span> 的封闭形式。</p>
<p>又例如等比数列 <span class="arithmatex"><span class="MathJax_Preview">\lang1,p,p^2,\dots\rang</span><script type="math/tex">\lang1,p,p^2,\dots\rang</script></span> 的生成函数 <span class="arithmatex"><span class="MathJax_Preview">F(x)=\displaystyle\sum_{n\geq 0}p^nx^n</span><script type="math/tex">F(x)=\displaystyle\sum_{n\geq 0}p^nx^n</script></span>，有 <span class="arithmatex"><span class="MathJax_Preview">F(x)px+1=F(x)</span><script type="math/tex">F(x)px+1=F(x)</script></span> 得 <span class="arithmatex"><span class="MathJax_Preview">F(x)=\displaystyle\frac{1}{1-px}</span><script type="math/tex">F(x)=\displaystyle\frac{1}{1-px}</script></span>.</p>
<p><span class="arithmatex"><span class="MathJax_Preview">a=\lang 1,0,1,0,1,\dots\rang</span><script type="math/tex">a=\lang 1,0,1,0,1,\dots\rang</script></span> 的 <span class="arithmatex"><span class="MathJax_Preview">F(x)=\displaystyle\sum_{n\geq 0}x^{2n}=\frac{1}{1-x^2}</span><script type="math/tex">F(x)=\displaystyle\sum_{n\geq 0}x^{2n}=\frac{1}{1-x^2}</script></span></p>
<p><span class="arithmatex"><span class="MathJax_Preview">a=\lang 1,2,3,4,\dots\rang</span><script type="math/tex">a=\lang 1,2,3,4,\dots\rang</script></span> 的 <span class="arithmatex"><span class="MathJax_Preview">F(x)=\displaystyle\sum_{n\geq 0}(n+1)x^n=\sum_{n\geq 0}(x^n)'=\left(\frac{1}{1-x}\right)'=\frac{1}{(1-x)^2}</span><script type="math/tex">F(x)=\displaystyle\sum_{n\geq 0}(n+1)x^n=\sum_{n\geq 0}(x^n)'=\left(\frac{1}{1-x}\right)'=\frac{1}{(1-x)^2}</script></span></p>
<p><span class="arithmatex"><span class="MathJax_Preview">a_n=\begin{pmatrix}m\\n\end{pmatrix}</span><script type="math/tex">a_n=\begin{pmatrix}m\\n\end{pmatrix}</script></span> 的 <span class="arithmatex"><span class="MathJax_Preview">F(x)=\displaystyle\sum_{n\geq 0}\begin{pmatrix}m\\n\end{pmatrix}x^n=(1+x)^m</span><script type="math/tex">F(x)=\displaystyle\sum_{n\geq 0}\begin{pmatrix}m\\n\end{pmatrix}x^n=(1+x)^m</script></span></p>
<p><span class="arithmatex"><span class="MathJax_Preview">Fib</span><script type="math/tex">Fib</script></span> 数列定义为 <span class="arithmatex"><span class="MathJax_Preview">a_0=0,a_1=1,a_n=a_{n-1}+a_{n-2}</span><script type="math/tex">a_0=0,a_1=1,a_n=a_{n-1}+a_{n-2}</script></span>，于是有</p>
<div class="arithmatex">
<div class="MathJax_Preview">F(x)=xF(x)+x^2F(x)-a_0x+a_1x+a_0\implies F(x)=\frac{x}{1-x-x^2}</div>
<script type="math/tex; mode=display">F(x)=xF(x)+x^2F(x)-a_0x+a_1x+a_0\implies F(x)=\frac{x}{1-x-x^2}</script>
</div>
<h4 id="_4">应用</h4>
<ol>
<li>在许多不同种类的食物中选出 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 个，计算方案数。每种食物的限制如下：</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align: center;">汉堡：偶数个</th>
<th style="text-align: center;">可乐：不超高一个</th>
<th style="text-align: center;">鸡腿：不超过两个</th>
<th style="text-align: center;">蜜桃多：奇数个</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">鸡块：<span class="arithmatex"><span class="MathJax_Preview">4</span><script type="math/tex">4</script></span> 的倍数个</td>
<td style="text-align: center;">包子：不超过三个</td>
<td style="text-align: center;">土豆片炒肉：不超过一个</td>
<td style="text-align: center;">面包：<span class="arithmatex"><span class="MathJax_Preview">3</span><script type="math/tex">3</script></span> 的倍数个</td>
</tr>
</tbody>
</table>
<p>构造生成函数：</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}x^{2n}=\frac{1}{1-x^2}</span><script type="math/tex">\displaystyle\sum_{n\geq 0}x^{2n}=\frac{1}{1-x^2}</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">1+x</span><script type="math/tex">1+x</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle 1+x+x^2=\frac{1-x^3}{1-x}</span><script type="math/tex">\displaystyle 1+x+x^2=\frac{1-x^3}{1-x}</script></span></th>
<th style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{x}{1-x^2}</span><script type="math/tex">\displaystyle\frac{x}{1-x^2}</script></span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sum_{n\geq 0}x^{4n}=\frac{1}{1-x^4}</span><script type="math/tex">\displaystyle\sum_{n\geq 0}x^{4n}=\frac{1}{1-x^4}</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle 1+x+x^2+x^3=\frac{1-x^4}{1-x}</span><script type="math/tex">\displaystyle 1+x+x^2+x^3=\frac{1-x^4}{1-x}</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">1+x</span><script type="math/tex">1+x</script></span></td>
<td style="text-align: center;"><span class="arithmatex"><span class="MathJax_Preview">\displaystyle\frac{1}{1-x^3}</span><script type="math/tex">\displaystyle\frac{1}{1-x^3}</script></span></td>
</tr>
</tbody>
</table>
<p>全部乘起来得到答案的生成函数：</p>
<div class="arithmatex">
<div class="MathJax_Preview">F(x)=\frac{(1+x)(1-x^3)x(1-x^4)(1+x)}{(1-x^2)(1-x)(1-x^2)(1-x^4)(1-x)(1-x^3)}=\frac{x}{(1-x)^4}=\sum_{n\geq 1}\begin{pmatrix}n+2\\n-1\end{pmatrix}x^n</div>
<script type="math/tex; mode=display">F(x)=\frac{(1+x)(1-x^3)x(1-x^4)(1+x)}{(1-x^2)(1-x)(1-x^2)(1-x^4)(1-x)(1-x^3)}=\frac{x}{(1-x)^4}=\sum_{n\geq 1}\begin{pmatrix}n+2\\n-1\end{pmatrix}x^n</script>
</div>
<p>于是答案 <span class="arithmatex"><span class="MathJax_Preview">=\begin{pmatrix}n+2\\n-1\end{pmatrix}=\begin{pmatrix}n+2\\3\end{pmatrix}</span><script type="math/tex">=\begin{pmatrix}n+2\\n-1\end{pmatrix}=\begin{pmatrix}n+2\\3\end{pmatrix}</script></span></p>
<ol>
<li><span class="arithmatex"><span class="MathJax_Preview">a_{n+1}+a_n=2^n,a_0=0</span><script type="math/tex">a_{n+1}+a_n=2^n,a_0=0</script></span>，求通项。</li>
</ol>
<p><span class="arithmatex"><span class="MathJax_Preview">f(x)=\displaystyle\sum_{n=0}^{+\infty}a_nx^n</span><script type="math/tex">f(x)=\displaystyle\sum_{n=0}^{+\infty}a_nx^n</script></span>，原式变为 <span class="arithmatex"><span class="MathJax_Preview">x^{-1}(a_{n+1}x^{n+1})+a_nx^n=(2x)^n</span><script type="math/tex">x^{-1}(a_{n+1}x^{n+1})+a_nx^n=(2x)^n</script></span>，再求和有</p>
<div class="arithmatex">
<div class="MathJax_Preview">\displaystyle\sum_{n=0}^{+\infty}x^{-1}(a_{n+1}x^{n+1})+\sum_{n=0}^{+\infty}(a_nx^n)=\sum_{n=0}^{+\infty}(2x)^n=\frac{1}{1-2x}\implies (\frac{1}{x}+1)f(x)=\frac{1}{1-2x}</div>
<script type="math/tex; mode=display">\displaystyle\sum_{n=0}^{+\infty}x^{-1}(a_{n+1}x^{n+1})+\sum_{n=0}^{+\infty}(a_nx^n)=\sum_{n=0}^{+\infty}(2x)^n=\frac{1}{1-2x}\implies (\frac{1}{x}+1)f(x)=\frac{1}{1-2x}</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">f(x)=\frac{x}{(1-2x)(1+x)}=\frac{1}{3}(\frac{1}{1-2x}-\frac{1}{1+x})=\frac{1}{3}\sum_{n=0}^{+\infty}[2^n-(-1)^n]x^n</div>
<script type="math/tex; mode=display">f(x)=\frac{x}{(1-2x)(1+x)}=\frac{1}{3}(\frac{1}{1-2x}-\frac{1}{1+x})=\frac{1}{3}\sum_{n=0}^{+\infty}[2^n-(-1)^n]x^n</script>
</div>
<p>于是 <span class="arithmatex"><span class="MathJax_Preview">\displaystyle a_n=\frac{1}{3}[2^n-(-1)^n]</span><script type="math/tex">\displaystyle a_n=\frac{1}{3}[2^n-(-1)^n]</script></span>.</p>
<ol>
<li>卡特兰数：一个 <span class="arithmatex"><span class="MathJax_Preview">n\times n</span><script type="math/tex">n\times n</script></span> 的方阵从 <span class="arithmatex"><span class="MathJax_Preview">(0,0)</span><script type="math/tex">(0,0)</script></span> 走到 <span class="arithmatex"><span class="MathJax_Preview">(n,n)</span><script type="math/tex">(n,n)</script></span>，不经过对角线的方案数，记作 <span class="arithmatex"><span class="MathJax_Preview">C_n</span><script type="math/tex">C_n</script></span>。</li>
</ol>
<p>有如下关系：<span class="arithmatex"><span class="MathJax_Preview">C_n=\displaystyle\sum_{k=0}^nC_{n-k}C_k</span><script type="math/tex">C_n=\displaystyle\sum_{k=0}^nC_{n-k}C_k</script></span>，构造 <span class="arithmatex"><span class="MathJax_Preview">f(x)=\displaystyle\sum_{n=0}^{+\infty}C_nx^n</span><script type="math/tex">f(x)=\displaystyle\sum_{n=0}^{+\infty}C_nx^n</script></span>，有</p>
<div class="arithmatex">
<div class="MathJax_Preview">f^2(x)=C_0^2+(C_0C_1+C_1C_0)x+\dots\implies xf^2(x)+C_0=f(x)\implies f(x)=\frac{1-\sqrt{1-4x} }{2x}</div>
<script type="math/tex; mode=display">f^2(x)=C_0^2+(C_0C_1+C_1C_0)x+\dots\implies xf^2(x)+C_0=f(x)\implies f(x)=\frac{1-\sqrt{1-4x} }{2x}</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">\implies f(x)=\frac{1-\left\{1+\displaystyle\sum_{k=1}^{+\infty}\left[-2\begin{pmatrix}2k-2\\ k-1\end{pmatrix}\right]x^k\right\}}{2x}=\sum_{k=0}^{+\infty}\frac{\begin{pmatrix}2k\\k\end{pmatrix}x^k}{k+1}\implies\red{\boxed{C_n=\frac{\begin{pmatrix}2n\\n\end{pmatrix}}{n+1}}}</div>
<script type="math/tex; mode=display">\implies f(x)=\frac{1-\left\{1+\displaystyle\sum_{k=1}^{+\infty}\left[-2\begin{pmatrix}2k-2\\ k-1\end{pmatrix}\right]x^k\right\}}{2x}=\sum_{k=0}^{+\infty}\frac{\begin{pmatrix}2k\\k\end{pmatrix}x^k}{k+1}\implies\red{\boxed{C_n=\frac{\begin{pmatrix}2n\\n\end{pmatrix}}{n+1}}}</script>
</div>
<!-- 数学 -->
<!-- 物理 -->
<!-- 化学 -->
<!-- 生物 -->
<!-- 教育 -->
<!-- 联合国与国际机构 -->
<!-- 欧洲联盟与地区组织 -->
</article>