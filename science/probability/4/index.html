<article class="mkdocs-fragment"
         data-title="组合数学"
         data-url="science/probability/4/">
  <h1 id="_1">组合数学</h1>
<center>
<p>组合数学是一门古老而迷人的学科。</p>
<p>传说早在 $\texttt{114514}$ 年前，<br>
一位名为忆哀的神灵来到地球，<br>
发现了人类——另一种有智慧的物种。</p>
<p>她觉得这很有趣，为了加速人类文明的发展，<br>
她向人间传下了一类计数问题——十二重计数，<br>
这也正是组合数学的开端。</p>
<p>而只有搞明白这类问题，才能在组合数学上继续深入。</p>
</center>
<h2 id="_2">基础内容</h2>
<h3 id="_3">四大原理</h3>
<p>加法原理：分类相加，</p>
<p>$$
N=\sum m_n
$$</p>
<p>乘法原理：分步相乘，</p>
<p>$$
N=\prod m_n
$$</p>
<p>减法原理：正难则反，</p>
<p>$$
|A|=|S|-|S\setminus A|,A\subseteq S
$$</p>
<p>除法原理：反悔划分。</p>
<p>这玩意想不明白回初赛重造。</p>
<p>注：本文将会偶尔用到大型运算符，不清楚的见我数列进阶。</p>
<h3 id="_4">经典例题</h3>
<ul>
<li>从 $A\to B$ 有 $2$ 条路，$B\to D$ 有 $3$ 条路；</li>
<li>从 $A\to C$ 有 $4$ 条路，$C\to D$ 有 $5$ 条路。</li>
</ul>
<p>问：从 $A\to D$ 一共有几条路？</p>
<p>解：</p>
<p>$$
2\times3+4\times5=26
$$</p>
<p>完毕！</p>
<h3 id="_5">经典应用：因数个数</h3>
<p>例题，$2160$ 有多少个不同的正因数。</p>
<p>分解质因数，</p>
<p>$$
\begin{aligned}
2160&amp;=2\times5\times 216\
&amp;=2^4\times5\times 27\
&amp;=2<sup>4\times3</sup>3\times5
\end{aligned}
$$</p>
<p>注意到每一个指数一次比他小的都是其因数，</p>
<p>因数个数，</p>
<p>$$
(4+1)(3+1)(1+1)=40
$$</p>
<p>In general:</p>
<p>$$
N=p_1<sup c_2="c_2">{c_1}p_2</sup>
$$}\dots p_k^{c_k</p>
<p>对于，</p>
<p>$$
\forall p_i\in\mathbb P,p_i\neq p_j(i\neq j)
$$</p>
<p>那么，任意，</p>
<p>$$
M=p_1<sup b_2="b_2">{b_1}p_2</sup>
$$}\dots p_k^{b_k</p>
<p>对于，</p>
<p>$$
\forall b_i\le c_i
$$</p>
<p>的 $M$ 都是 $N$ 的因数，因数个数为，</p>
<p>$$
\mathit{cnt}=(c_1+1)(c_2+1)\dots(c_k+1)
$$</p>
<h3 id="_6">经典应用：子集个数</h3>
<p>对于集合，</p>
<p>$$
A={1,2,3,\dots,10}
$$</p>
<p>其子集个数是多少？</p>
<p>对于每一个数，其要么出现在子集中，要么不出现，</p>
<p>因此，子集个数，</p>
<p>$$
2^{10}
$$</p>
<blockquote>
<p>In general:</p>
<p>大小为 $N$ 的集合，其，</p>
<ul>
<li>子集个数：$2^N$；</li>
<li>真子集个数：$2^N-1$；</li>
<li>非空子集个数：$2^N-1$；</li>
<li>非空真子集个数：$2^N-2$。</li>
</ul>
</blockquote>
<h2 id="_7">排列数和组合数</h2>
<h3 id="_8">排列数</h3>
<p>定义，排列数为 $A(n,m)$ 表示：</p>
<ul>
<li>从 $n$ 个物品中，选出 $m$ 个进行排列的方案数。</li>
</ul>
<p>也记为，$A\begin{smallmatrix}n\m\end{smallmatrix}$，但是这样太麻烦了，我不喜欢（</p>
<p>早年时期也记为 $P(n,m)$，P 表示 Permutation（排列）。</p>
<h4 id="_9">定义式</h4>
<p>按照定义，我们一次分析第 $i$ 个选哪个，</p>
<p>$$
\def\arraystretch{1.2}
\begin{array}{|c|c|}\hline
\bm{i}&amp;\small\texttt{方案数}\\hline
1&amp;n\\hline
2&amp;n-1\\hline
3&amp;n-2\\hline
\dots&amp;\dots\\hline
m&amp;n-m+1\\hline
\end{array}
$$</p>
<p>因此，总方案数，</p>
<p>$$
A(n,m)=n(n-1)(n-2)\dots(n-m+1)
$$</p>
<p>这个是经典公式，即，</p>
<ul>
<li>从 $n$ 开始，往下数 $m$ 个相乘。</li>
</ul>
<p>我们知道阶乘的定义为，</p>
<p>$$
x!=x(x-1)(x-2)\dots1
$$</p>
<p>因此，类似的，</p>
<p>$$
\boxed{A(n,m)={n!\over(n-m)!}}
$$</p>
<p>由此，当 $m=n$ 时，</p>
<p>$$
A(n,n)=n!=n(n-1)(n-2)\dots1
$$</p>
<p>注意到其实后面的 $1$ 没啥用（</p>
<p>特殊的，我们定义，</p>
<p>$$
0!=1
$$</p>
<p>而一般默认 $A(n,m)$ 中 $n\ge m$，若大于了，规定为零。</p>
<p>至于为什么这么定义，从组合意义上是显然的，也可以参见下降幂。</p>
<h3 id="_10">组合数</h3>
<p>定义，组合数为 $C(n,m)$ 表示：</p>
<ul>
<li>从 $n$ 个物品中，选出 $m$ 个进行排列的方案数。</li>
</ul>
<p>也记为 $C\begin{smallmatrix}n\m\end{smallmatrix}$，C 表示 Combination（组合），学术上一般记为，</p>
<p>$$
{n\choose m}
$$</p>
<h4 id="_11">定义式</h4>
<p>有些教材会先讲组合数，原因就是，</p>
<p>我们在排列中，从 $n$ 个物品中选择 $m$ 个进行排列，</p>
<p>这个本质其实是两个步骤，</p>
<ol>
<li>从 $n$ 个物品中选择 $m$ 个，即 $C(n,m)$；</li>
<li>将这 $m$ 个进行排列，即 $A(m,m)=m!$。</li>
</ol>
<p>因此，</p>
<p>$$
A(n,m)=C(n,m)\times A(m,m)
$$</p>
<p>$$
\boxed{C(n,m)={A(n,m)\over A(m,m)}={n!\over(n-m)!m!}}
$$</p>
<p>这个思路其实更加连贯。</p>
<h4 id="_12">拓展</h4>
<p>有，$m!$ 整除任何连续的 $m$ 个整数的乘积。</p>
<p>证明，构造组合数。</p>
<h3 id="_13">一些性质</h3>
<p>注意到组合数有更好的性质，所以下面主要是组合数的性质，</p>
<hr />
<p>从定义可得，</p>
<p>$$
\boxed{\tag1{n\choose m}={n\choose n-m}}
$$</p>
<p>从 $n$ 个里面选 $m$ 个，等价于找出来 $n-m$ 个不选。</p>
<hr />
<p>同样是定义得出，</p>
<p>$$
\boxed{{n\choose m}={n\over m}{n-1\choose m-1}\tag{1 II}}
$$</p>
<p>因此我们打了一个可爱的 Tag。</p>
<hr />
<p>同样是定义得出，</p>
<p>$$
\boxed{{n\choose m}{m\choose k}={n\choose k}{n-k\choose m-k}}\tag{1 III}
$$</p>
<p>表示 $n$ 选 $m$，$m$ 选 $k$ 表示 $n$ 直接选 $k$ 然后再把 $m-k$ 补回去。</p>
<p>因此我们又打了一个可爱的 Tag。</p>
<hr />
<p>经典递推式，</p>
<p>$$
\boxed{\tag2{n\choose m}={n-1\choose m}+{n-1\choose m-1}}
$$</p>
<p>相当于 $n$ 个选 $m$ 个，分讨其中一个选不选，可用于裂项。</p>
<hr />
<p>另外有类比上面的，</p>
<p>$$
\boxed{A_n<sup>m=A_{n-1}</sup>m+mA_{n-1}^{m-1}\tag{2 II}}
$$</p>
<p>相当于 $n$ 个选 $m$ 个进行排列，分讨第 $n$ 个选不选。</p>
<hr />
<p>下面是一些用到了大型运算符的性质，</p>
<p>$$
\boxed{\sum_{i=0}^n{n\choose i}=2\tag3}
$$</p>
<p>表示从 $n$ 个中，任意选 $0\sim n$ 个，自然就是 $2^n$ 种。</p>
<hr />
<p>一个裂项的题。</p>
<p>$$
\boxed{\sum_{i=m}^{2m}{i\choose m}={2m+1\choose m}\tag4}
$$</p>
<p>考虑裂项，</p>
<p>$$
{2m+1\choose m}={2m\choose m}+{2m\choose m-1}={2m\choose m}+{2m-1\choose m-1}+{2m-1\choose m-2}=\dots
$$</p>
<p>用大型运算符表示，注意到选 $0$ 个可以随便换。</p>
<p>$$
{2m+1\choose m}=\sum_{i=0}^{m-1}{2m-i\choose m-i}+{m+1\choose 0}=\sum_{i=0}^m{2m-i\choose m-i}
$$</p>
<p>对里面的应用 $(1)$，得到，</p>
<p>$$
{2m+1\choose m}=\sum_{i=0}^m{2m-i\choose m}=\sum_{0\le i\le m}{2m-i\choose m}
$$</p>
<p>应用一些技巧（注意到 $2m-i$ 是的一个 Permutation），</p>
<p>$$
{2m+1\choose m}=\sum_{0\le 2m-i\le m}{2m-(2m-i)\choose m}=\sum_{i=m}^{2m}{i\choose m}
$$</p>
<p>Q.E.D.</p>
<p>同样的，两边乘上 $m!$ 就得到了排列的版本。</p>
<h4 id="_14">补充：解方程问题</h4>
<p>解方程，</p>
<p>$$
{n\choose a}={n\choose b}
$$</p>
<p>首先，若，</p>
<p>$$
a=b
$$</p>
<p>那么是显然的，否则，应用性质 $(1)$，得，</p>
<p>$$
a+b=n
$$</p>
<p>自然也是显然的。</p>
<h2 id="_15">二项式定理</h2>
<h3 id="_16">基本形式</h3>
<p>$$
\boxed{(a+b)<sup>n=\sum_{i=0}</sup>n{n\choose i}a<sup>{n-i}b</sup>n}
$$</p>
<p>令 $b=1$ 可以得出最能体现性质的形式，</p>
<p>$$
\boxed{(a+1)<sup>n=\sum_{i=0}</sup>n{n\choose i}a^n}
$$</p>
<p>二项式定理也可以很容易扩展为多项式的形式：</p>
<p>$$
\boxed{(x_1+\dots+x_k)^n=\sum_{n_1+\dots+n_k=n}{n\choose n_1,\dots,n_k}x_1^{n_1}\dots x_n^{n_k}}
$$</p>
<p>有性质，</p>
<p>$$
\boxed{\sum_{n_1+\dots+n_k=n}{n\choose n_1,\dots,n_k}=k^n}
$$</p>
<p>问：下面这个有什么用？</p>
<p>答：可以用来检验你展开的对不对。</p>
<h3 id="_17">杨辉三角</h3>
<p>递推式，</p>
<p>$$
a_{i,1}=a_{i,i}=1\
a_{i,j}=a_{i-1,j-1}+a_{i-1,j}
$$</p>
<p>注意到形如组合数的形式，</p>
<p>$$
\def\qq{\quad}
\begin{array}{r|c}
1&amp;1\\hline
2&amp;1\qq1\\hline
3&amp;1\qq2\qq1\\hline
4&amp;1\qq3\qq3\qq1\\hline
5&amp;1\qq4\qq6\qq4\qq1\\hline
6&amp;1\qq5\qq10\qq10\qq5\qq1\\hline
7&amp;1\qq6\qq15\qq20\qq15\qq6\qq1\\hline
8&amp;1\qq7\qq21\qq35\qq35\qq21\qq7\qq1\\hline
9&amp;1\qq8\qq28\qq56\qq70\qq56\qq28\qq8\qq1\\hline
10&amp;1\qq9\qq36\qq84\qq126\qq126\qq84\qq36\qq9\qq1\\hline
11&amp;1\qq10\qq45\qq120\qq210\qq252\qq210\qq120\qq45\qq10\qq1\
\end{array}
$$</p>
<p>其中第 $i$ 行第 $j$ 个数，表示的是 $(a+1)^{i-1}$ 的 $j-1$ 次项系数。</p>
<h3 id="_18">一些性质</h3>
<p>我们讨论二项式系数，</p>
<p>$$
\boxed{{n\choose 0},{n\choose 1}.\dots,{n\choose n}}
$$</p>
<blockquote>
<p>提示：二项式系数只是组合数，但是提到系数就需要把具体的数字的系数乘进去，比如说 $(3a+2)^2$ 的第一项的二项式系数是 $C(2,0)=1$，但是系数是 $3^2\times1=9$。</p>
</blockquote>
<p>中的单调性，设，</p>
<p>$$
f(n,k)={n\choose k}
$$</p>
<p>则若，</p>
<p>$$
q={f(n,k+1)\over f(n,k)}
$$</p>
<p>考虑化简，</p>
<p>$$
q={f(n,k+1)\over f(n,k)}={n!\over(k+1)!(n-k-1)!}\times{k!(n-k)!\over n!}={n-k\over k+1}
$$</p>
<p>讨论，</p>
<ul>
<li>
<p>函数单增：$q&gt;1\Rightarrow k&lt;\dfrac{n-1}{2}$；</p>
</li>
<li>
<p>函数单减：$q&lt;1\Rightarrow k&gt;\dfrac{n-1}{2}$。</p>
</li>
</ul>
<p>据此，我们得出其单增、单减区间为，</p>
<p>$$
\left[0,{n-1\over2}\right]
,
\left({n-1\over2},n\right]
$$</p>
<p>应用顶、底函数，化简，</p>
<p>$$
\boxed{
\left[0,\left\lfloor{n\over2}\right\rfloor\right]
,
\left[\left\lceil{n\over2}\right\rceil,n\right]
}
$$</p>
<p>因此注意到，</p>
<ul>
<li>若 $n$ 是偶数，那么存在有唯一的极大值点 $n/2$；</li>
<li>若 $n$ 是奇数，那么存在有 $(n+1)/2,(n-1)/2$ 两个极大值点。</li>
</ul>
<h3 id="_19">一些好玩的题</h3>
<p>在，</p>
<p>$$
(x+y)(x-y)^5
$$</p>
<p>的展开式中，求下列各式的系数。</p>
<p>我们注意到原式，</p>
<p>$$
(x+y)(x-y)<sup>5=x(x-y)</sup>5+y(x-y)^5
$$</p>
<p>那么如果要求，</p>
<p>$$
x<sup 6-n="6-n">ny</sup>
$$</p>
<p>其实就是前一项的 $x<sup 6-n="6-n">{n-1}(-y)</sup>$ 的系数，</p>
<p>加上后一项  $x<sup 5-n="5-n">n(-y)</sup>$ 的系数，就是</p>
<p>$$
\begin{aligned}
(-1)<sup 5-n="5-n">{6-n}{5\choose6-n}+(-1)</sup>\
=-1^n\left[{5\choose6-n}-{5\choose5-n}\right]
\end{aligned}
$$}{5\choose5-n</p>
<p>好玩吧（？</p>
<h3 id="_20">二项式定理做题套路</h3>
<p>我们知道，</p>
<p>$$
(x_1,x_2,x_3)^n
$$</p>
<p>展开，相当于考虑每一个 $k_1+k_2+k_3=n$，</p>
<p>去找，</p>
<p>$$
{n\choose k_1,k_2,k_3}x_1<sup k_2="k_2">{k_1}x_2</sup>
$$}x_3^{k_3</p>
<p>这么一个贡献，那么我们整理一下，例题：</p>
<p>$$
(x-1+px<sup>2)</sup>6
$$</p>
<p>的展开式中，$x^5$ 项系数最大时的 $p$ 的值。</p>
<p>我们考虑先确定 $x_5$ 的系数，我们知道，可行的能配出来的有，</p>
<p>$$
\begin{aligned}
&amp;&amp;(x&amp;-&amp;1&amp;+&amp;p&amp;x<sup>2)</sup>6\\hline
(1)&amp;  &amp;1&amp; &amp;3&amp; &amp;2&amp;\
(2)&amp;  &amp;3&amp; &amp;2&amp; &amp;1&amp;\
(3)&amp;  &amp;5&amp; &amp;1&amp; &amp;0&amp;
\end{aligned}
$$</p>
<p>下面的表示可以配出 $x^5$ 的系数。</p>
<p>我们把上标看成一共选几个物品，把下面的看成每类物品提供几个。</p>
<p>那么这几个分别对答案的贡献为，</p>
<p>$$
\begin{aligned}
(1)&amp;:-60p^2\
(2)&amp;:60p\
(3)&amp;:-6
\end{aligned}
$$</p>
<p>合在一起系数为，</p>
<p>$$
-60p^2+60p-6
$$</p>
<p>取最大值时，</p>
<p>$$
p={1\over 2}
$$</p>
<p>这是很直观的。</p>
<h3 id="_21">推导组合性质</h3>
<p>形式一：</p>
<p>$$
\boxed{(a+1)<sup>n=\sum_{i=0}</sup>n{n\choose i}a^i}
$$</p>
<p>带入 $a=1$，</p>
<p>$$
\boxed{\sum_{i=0}^n{n\choose i}=2^n}
$$</p>
<p>带入 $a=2$，</p>
<p>$$
\boxed{\sum_{i=0}^n{n\choose i}2<sup>i=3</sup>n}
$$</p>
<p>带入 $a=-1$，</p>
<p>$$
\boxed{\sum_{i=0}<sup>n(-1)</sup>i{n\choose i}=[n=0]}
$$</p>
<p>上式，假定 $n\neq0$，则，</p>
<p>$$
\sum_{i=0}<sup>n(-1)</sup>i{n\choose i}=0
$$</p>
<p>我们假定 $n$ 是偶数，那么移项，</p>
<p>$$
{n\choose0}+{n\choose2}+\dots+{n\choose n}={n\choose1}+{n\choose 3}+\dots+{n\choose n-1}
$$</p>
<p>且左右相加等于 $2^n$，那么左右都等于 $2^{n-1}$，即，</p>
<p>$$
{n\choose0}+{n\choose2}+\dots+{n\choose n}=2^{n-1}
$$</p>
<p>$$
{n\choose1}+{n\choose 3}+\dots+{n\choose n-1}=2^{n-1}
$$</p>
<p>对于 $n$ 为正偶数。</p>
<p>类比 $n$ 为正奇数，</p>
<p>$$
{n\choose0}+{n\choose2}+\dots+{n\choose n-1}={n\choose1}+{n\choose 3}+\dots+{n\choose n}
$$</p>
<p>同理，</p>
<p>$$
{n\choose0}+{n\choose2}+\dots+{n\choose n-1}=2^{n-1}
$$</p>
<p>$${n\choose1}+{n\choose 3}+\dots+{n\choose n}=2^{n-1}
$$</p>
<p>总结一下，</p>
<p>$$
\boxed{{n\choose0}+{n\choose2}+\dots=2^{n-1}}
$$</p>
<p>$$
\boxed{{n\choose1}+{n\choose 3}+\dots=2^{n-1}}
$$</p>
<p>省略号表示加到小于等于 $n$ 为止。</p>
<p>但是注意到我们规定的后面都为零，因此当成无限加也可以（</p>
<h2 id="_22">进阶内容</h2>
<h3 id="_23">容斥原理</h3>
<h4 id="_24">理论</h4>
<blockquote>
<p>容斥原理是一种应用在集合上的较常用的计数方法，其基本思想是：</p>
<p>先不考虑重叠的情况，把包含于某内容中的所有对象的数目先计算出来（容），</p>
<p>然后再把计数时重复计算的数目排斥出去（斥），使得计算的结果既无遗漏又无重复。</p>
<p>容斥原理的核心计数规则可以叙述为：奇加偶减。</p>
</blockquote>
<p>例题，将甲乙丙丁四个老师分配到 ABCD 四个班。</p>
<p>要求甲不能在 A，丁不能在 B，求总分配方案数。</p>
<p>用不考虑限制的方案数，减去甲在 A 的，减去丁在 B 的。</p>
<p>注意到甲在 A 且 丁在 B，我们是减了两边的，因此加上一次，</p>
<p>$$
4!-2\times3!+2!=24-2\times 6+2=14
$$</p>
<p>完毕！</p>
<p>In general:</p>
<p>$$\def\abs#1{\left\lvert{#1}\right\rvert}
\abs{\bigcup_{i=1}^{n}A_i}=\sum_{S\in[1,n]\wedge\mathbb Z}(-1)^{\abs S-1}\abs{\bigcap_{i\in S}A_i}
$$</p>
<p>简化的形式，</p>
<p>$$
|A\cup B\cup C|=|A|+|B|+|C|-|A\cap B|-|A\cap C|-|B\cap C|+|A\cap B\cap C|
$$</p>
<h4 id="_25">配合数论知识</h4>
<p>众所周知，$1\sim n$ 中 $k$ 的倍数有，</p>
<p>$$
\left\lfloor{n\over k}\right\rfloor
$$</p>
<p>好的，你已经会 $1+1=2$ 了，让我们来看一下这个题，</p>
<p>在 $1\sim1000$ 中，有多少个数，既不是 $3$ 的倍数，也不是 $5$ 的倍数。</p>
<p>容易发现，设集合 $A=#[{\small\sf{是 3 的倍数}}]$，$B=#[{\small\sf{是 5 的倍数}}]$，则，</p>
<p>$$
\def\floor#1{\left\lfloor{#1}\right\rfloor}
|A|=\floor{1000\over3}=333\[0.5em]
|B|=\floor{1000\over5}=200\[0.5em]
|A\cup B|=\floor{1000\over15}=66\[0.5em]
|A\cap B|=|A|+|B|-|A\cup B|=467
$$</p>
<p>那么我们再取一下补集，答案就是 $533$。</p>
<h3 id="_26">鸽巢原理</h3>
<p>此处不讨论第一、第二鸽巢原理。</p>
<p>将 $n+1$ 个物体划分为 $n$ 组，那么有至少一组有两个及以上的物体。</p>
<blockquote>
<p>In general:</p>
<p>将 $n$ 个物体划分为 $k$ 组，那么有至少一组有大于等于 $\left \lceil \dfrac{n}{k} \right \rceil$ 个物品。</p>
<p>最差原则：即考虑所有可能情况中，最不利于某件事情发生的情况。也就是最差的情况都能被满足，那么其余所有的情况都比最差的要好，连最差的都能满足，则说明其余所有情况也都能满足，也就是任意情况都能满足。</p>
</blockquote>
<h3 id="_27">多重集</h3>
<h4 id="_28">概念</h4>
<p>多重集或可重集是集合概念的推广。</p>
<ul>
<li>
<p>在一个集合中，相同的元素只能出现一次，因此只能显示出有或无的属性。</p>
</li>
<li>
<p>在多重集之中，同一个元素可以出现多次，因此可以显示出元素的个数。</p>
</li>
</ul>
<p>我们可以将其表示为，</p>
<p>$$
{a_1,a_1,\dots,a_1,a_2,\dots}
$$</p>
<p>为了简便，下文中我们这么表示，</p>
<p>$$
{n_1\cdot a_1,n_2\cdot a_2,\dots}
$$</p>
<h4 id="_29">多重集的排列数</h4>
<p>多重集 $S={n_1\cdot a_1,n_2\cdot a_2,\cdots,n_k\cdot a_k}$ 的全排列个数为，</p>
<p>$$
{n\choose n_1,n_2,\dots,n_k}={n!\over\prod_{1\le i\le k}n_i}
$$</p>
<p>这个全排列数被称为<strong>多重集的排列数</strong>，多被称为<strong>多重组合数</strong>。</p>
<p>注意到，</p>
<p>$$
{n\choose m}={n\choose m,n-m}
$$</p>
<p>但是后面的不常用。</p>
<p>在 $n_1+n_2+\dots=n$ 的情况下，</p>
<p>其直观意义就是，从 $n$ 个中，先选出 $n_1$ 个，再选出 $n_2$ 个，……。</p>
<p>也就是说，我们用弱化的形式，若 $n_1+n_2+n_3=n$，</p>
<p>$$
{n\choose n_1,n_2,n_3}={n\choose n_1}{n-n_1\choose n_2}{n-n_1-n_2\choose n_3}
$$</p>
<p>请注意区分，类似</p>
<p>$$
{6\choose 2,2,2}
$$</p>
<p>和，</p>
<p>$$
{6\choose 2,2}
$$</p>
<p>因为其不符合我们上面的和为 $n$ 的要求。</p>
<h4 id="_30">多重集的组合数</h4>
<p>请注意区分<strong>多重组合数</strong>（多重集的排列数）和<strong>多重集的组合数</strong>，他们是完全不同的。</p>
<p>我们类推组合数，以及多重集的排列数，定义如下：</p>
<p>有多重集 $S={n_1\cdot a_1,n_2\cdot a_2,\cdots,n_k\cdot a_k}$ ，那么对于整数 $r$，</p>
<hr />
<p>若 $r$ 满足，$r&lt;n_i,\forall i\in[1,k]$（注意这个很重要！），</p>
<p>从 $S$ 中选择 $r$ 个元素组成一个多重集的方案数就是<strong>多重集的组合数</strong>。</p>
<p>这个问题等价于 $x_1+x_2+\dots+x_k=r$ 的非负整数解的数目，可以用插板法解决，答案为，</p>
<p>$$
{r+k-1\choose k-1}
$$</p>
<hr />
<p>若 $r$ 满足，$r&lt;n,n=\sum_{i=1}^kn_i$（也就是没有限制了），</p>
<p>则问题可以很容易转化为求解带限制的线性方程，</p>
<p>$$
\forall i\in[1,k],x_i\le n_i,\sum_{i=1}^nx_i=r
$$</p>
<p>好，然而这个过于复杂，我们跳过。</p>
<h3 id="_31">圆排列</h3>
<p>定义 $n$ 个人全部来围成一圈，所有的排列数记为 $Q(n,n)$。</p>
<p>考虑其中已经排好的一圈，从不同位置断开，又变成不同的队列。</p>
<p>所以有，</p>
<p>$$
Q(n,n)={A(n,n)\over n}={n!\over n}=(n-1)!
$$</p>
<p>我们继续类推，即 $Q(n,m)$ 为 $n$ 选 $m$ 个人排成一圈的方案数，</p>
<p>考虑先分组再分配的方案，</p>
<p>$$
Q(n,m)=C(n,m)Q(m,m)={C(n,m)A(m,m)\over m}={A(n,m)\over m}
$$</p>
<p>注意到这里和前面是非常融洽的，我们继续，易得，</p>
<p>$$
Q(n,m)={A(n,m)\over m}={n!\over m(n-m)!}
$$</p>
<h3 id="_32">错位排列</h3>
<p>错位排列是没有任何元素出现在其有序位置的排列，即，</p>
<p>即，对于 $1\sim n$ 的排列 $P$，如果对于所有 $i$ 满足 $P_i\neq i$，则称 $P$ 是 $n$ 的错位排列。</p>
<p>例如，三元错位排列有 ${2,3,1}$ 和 ${3,1,2}$。</p>
<p>我们记 $n$ 元错位排列的方案数有 $D_n$ 种，</p>
<p>有前几项（<a href="https://oeis.org/A000166">A000166 - OEIS</a>）：$1, 0, 1, 2, 9, 44, 265$。</p>
<p>以下是其常用性质，有封闭形式，推导略，</p>
<p>$$
D_n=n!\sum_{k=0}<sup>n{(-1)</sup>k\over k!}
$$</p>
<p>有递推式，</p>
<p>$$
D_n=(n-1)(D_{n-1}+D_{n-2})
$$</p>
<p>这个是经典形式，一个不严谨的证明：</p>
<ul>
<li>
<p>假定第 $n$ 个先放在 $n$ 位置，</p>
</li>
<li>
<p>若前面的所有已经错位，那么随便找一个，和 $n$ 交换即可满足要求，方案数 $(n-1)D_{n-1}$；</p>
</li>
<li>
<p>若前面的只剩一个没有错位，那么和这个交换，即可满足条件，方案数 $(n-1)D_{n-2}$；</p>
</li>
<li>
<p>总方案数：$D_n=(n-1)(D_{n-1}+D_{n-2})$。</p>
</li>
<li>可以证明，不存在其他在一步内的构造方案。</li>
</ul>
<p>还有一些惊人观察力的性质，</p>
<p>设 $P_n$ 表示所有排列中，为错位排列的概率，即，</p>
<p>$$
P_n={D_n\over A(n,n)}={D_n\over n!}
$$</p>
<p>有性质，</p>
<p>$$
\lim_{n\to\infty}P_n={1\over e}
$$</p>
<p>或者也可以表述为，</p>
<p>$$
P=\lim_{n\to\infty}{D_n\over n!}={1\over e}
$$</p>
<p>由此推知，</p>
<p>$$
D_n=\left\lfloor{n!\over e}\right\rfloor
$$</p>
<p>这一个近似求解。</p>
<h3 id="_33">卡特兰数</h3>
<h4 id="_34">概念</h4>
<p>卡特兰数可以表示一类组合问题，</p>
<p><img alt="" src="https://cdn.luogu.com.cn/upload/image_hosting/s1kfe1dc.png" /></p>
<p>其情景有，</p>
<ul>
<li>
<p>如上图，从左下走到右上，不穿过对角线的方案数；</p>
</li>
<li>
<p>有 $n$ 个元素，编号 $1\sim n$，出入栈的方案数；</p>
</li>
</ul>
<h4 id="_35">推导</h4>
<p>在上述图像中，容易知道，不考虑限制的方案数为，</p>
<p>$$
{2n\choose n}
$$</p>
<p>种，表示 $2n$ 步中选择 $n$ 步表示往上走。</p>
<p>考虑不合法情况（右上角），容易发现我们把图像从第一次穿越对角线开始翻折，</p>
<p>一定会最终落在终点的左上角位置，因此，不合法方案数为，</p>
<p>$$
{2n\choose n+1}
$$</p>
<p>总方案数为，</p>
<p>$$
\boxed{C_n={2n\choose n}-{2n\choose n+1}}
$$</p>
<p>一个经典公式，考虑继续推导，</p>
<p>$$
\begin{aligned}
C_n&amp;={2n\choose n}-{2n\choose n+1}\
&amp;={(2n)!\over n!n!}-{(2n)!\over (n+1)!(n-1)!}\
&amp;={(2n)!\over n!n!}-{(2n)!\over n!n!}\cdot{n\over n+1}\
&amp;={1\over n+1}\cdot{(2n)!\over n!n!}\
&amp;={1\over n+1}{2n\choose n}
\end{aligned}
$$</p>
<p>即经典公式，</p>
<p>$$
\boxed{C_n={1\over n+1}{2n\choose n}}
$$</p>
<p>还有不常用公式，</p>
<p>$$
C_n=C_{n-1}\cdot{4n-2\over n+1}
$$</p>
<p>有卡特兰数列（<a href="https://oeis.org/A000108">A000108 - OEIS</a>），</p>
<p>$$
1, 1, 2, 5, 14, 42, 132,\dots
$$</p>
<h3 id="lucas">Lucas 定理</h3>
<p>对于素数 $p$，</p>
<p>$$
{n\choose m}\equiv{n\bmod p\choose m\bmod p}\cdot{\lfloor n/p\rfloor\choose\lfloor m/p\rfloor}\pmod p
$$</p>
<p>或用更不直观的表达（？</p>
<p>对于 $n,m$ 在 $p$ 进制下有表示，</p>
<p>$$
\begin{cases}
n&amp;=a_0+a_1p+\dots+a_kp^k\
m&amp;=b_0+b_0p+\dots+b_kp^k
\end{cases}
$$</p>
<p>那么，</p>
<p>$$
{n\choose m}=\prod_{i=0}^k{a_i\choose b_i}
$$</p>
<p>可以用于推导一些模意义下的性质。</p>
<h3 id="_36">广义二项式定理</h3>
<p>对于实数 $n$，</p>
<p>$$
(a+b)<sup _underline="\underline" k="k">n=\sum_i{n</sup>x}\over k!<sup>{n-k}y</sup>k
$$</p>
<p>似乎用处不大。</p>
<h2 id="_37">常见解题技巧和模型</h2>
<p>我会在一个单独的技巧里面穿插一些与其不相关的。</p>
<p>目的是让你知道，模型不是全都直接套的，而是看情况。</p>
<p>（有的时候其实枚举更快（？</p>
<h3 id="_38">特殊优先策略</h3>
<p>情景就是你事情最多我就特殊处理你。</p>
<p>不一定是优先，也可以是后置处理（插空法）。</p>
<h4 id="_39">例题一</h4>
<p>六个人排队，甲不在排头。</p>
<p>Solution 1：考虑甲只有 $5$ 种方法，剩下五个人排列插入即可。</p>
<p>$$
5\times A(5,5)=600
$$</p>
<p>Solution 2：插空法，五个人排好后，甲插入除了开头的一个空。</p>
<p>$$
A(5,5)\times C(5,1)=600
$$</p>
<h4 id="_40">例题二</h4>
<p>六个人排队，甲不在队头，丁（？）不在队尾。</p>
<p>直接插空法，我们先放甲，</p>
<p>$$
A(4,4)\times C(4,1)\times C(5,1)=480
$$</p>
<p>但是还有一种情况，甲先选了队头，但是丁插她前面了（？</p>
<p>$$
A(4,4)=24
$$</p>
<p>总答案为，</p>
<p>$$
280+24=504
$$</p>
<h4 id="_41">例题三</h4>
<p>六个人排队，甲不在队头，丁不在队尾，且甲丁 xql 不相邻（？。</p>
<p>我们这个做法的优势体现了。</p>
<p>我们还是插空法，先放甲，注意此时出问题了。</p>
<p>我们再分讨，若甲选了队尾，</p>
<p>$$
A(4,4)\times C(4,1)=96
$$</p>
<p>否则，甲没选队尾，</p>
<p>$$
A(4,4)\times C(3,1)\times C(3,1)=216
$$</p>
<p>那么总有。</p>
<p>$$
96+216=312
$$</p>
<p>种。</p>
<h3 id="_42">等效替代策略</h3>
<p>当我们需要计算一些带特殊条件的方案数时，可以用一些等价替代的方法。</p>
<p>具体来讲，我们构造一个双射，将每一种原问题的方案映射为新问题的一种方案，并使答案更容易计算。</p>
<p>常用的有捆绑法、插空法、隔板法等。</p>
<h4 id="_43">捆绑法</h4>
<p>有七个人站队拍照，甲和乙要求相邻，丙和丁要求相邻，求方案数。</p>
<p>注意到我们把甲和乙替换为他们的儿子，丙和丁替换为他们的女儿，那么我们将这 $5$ 个新人排列，</p>
<p>$$
A_5^5=5\times4\times3\times2\times1=120
$$</p>
<p>然后把儿子替换为甲和乙，把女儿替换为丙和丁，那么这两个小组分别再排列，总答案为，</p>
<p>$$
A^5_5\times A^2_2\times A_2^2=480
$$</p>
<p>种，那么这就是捆绑法。</p>
<h4 id="_44">插空法</h4>
<p>有七个人拍照，由于甲和乙关系很好，他们要求不相邻，求方案数。</p>
<p>注意到我们先不管甲和乙，排列数，</p>
<p>$$
A_5^5=5\times4\times3\times2\times1=120
$$</p>
<p>然后把甲和乙插进这 $5$ 个人形成的 $6$ 个空中，总答案为，</p>
<p>$$
A_5^5\times A_2^2=240
$$</p>
<p>种，那么这就是插空法。</p>
<p>例题：现在五个人顺序已确定，插入两人，共有几种方案。</p>
<ul>
<li>若相邻，捆绑插空，$C_6^1=6$ 种。</li>
<li>不相邻，上文已述，$240$ 种。</li>
</ul>
<p>那么，显然这两个没有交集，我们直接加一起，总答案为 $246$ 种。</p>
<h4 id="_45">插板法</h4>
<p>插板法是用于求一类给相同元素分组的方案数的一种技巧。</p>
<p>同时，也可以用于求一类线性不定方程的解（正整数解、非负整数解）的组数。</p>
<p>$$
\mathsf{\bold{情况一：正整数解}}
$$</p>
<p>求：</p>
<p>$$
x_1+x_2+\dots+x_k=n
$$</p>
<p>的正整数解的解的组数。</p>
<blockquote>
<p>情景：<br />
把 $n$ 个小球分成 $k$ 个不同的组，每组个数不为零，求情况数。</p>
</blockquote>
<p>考虑拿 $k-1$ 块板子插入到 $n$ 个元素两两形成的 $n-1$ 个空里面，因此答案就是，</p>
<p>$$
\boxed{{n-1\choose k-1}}
$$</p>
<p>$$
\mathsf{\bold{情况二：非负整数解}}
$$</p>
<p>求：</p>
<p>$$
x_1+x_2+\dots+x_k=n
$$</p>
<p>的非负整数解的解的组数。</p>
<blockquote>
<p>情景：<br />
把 $n$ 个小球分成 $k$ 个不同的组，每组个数可以为零，求情况数。</p>
</blockquote>
<p>我们还是用 $k-1$ 个板子来分成 $k$ 组，但是可以为零。</p>
<p>不妨令 $y_i=x_i+1$，那么原方程，</p>
<p>$$
y_1+y_2+\dots+y_k=n+k
$$</p>
<p>注意到 $y_i$ 就一定是正整数了，答案为，</p>
<p>$$
\boxed{{n+k-1\choose k-1}}
$$</p>
<p>情景就是我们借给他 $k$ 个元素，那么选完之后再删掉这几个，就行了。</p>
<p>$$
\mathsf{\bold{情况三：不等式}}
$$</p>
<p>求：</p>
<p>$$
x_1+x_2+\dots+x_k\le n
$$</p>
<p>的非负整数解的解的组数。</p>
<p>注意到原式等价于，再加上一个非负整数，</p>
<p>$$
x_1+x_2+\dots+x_k+x_{k+1}=n
$$</p>
<p>于是，答案为，</p>
<p>$$
{n+k\choose k}
$$</p>
<p>$$
\mathsf{\bold{例题一：简单应用}}
$$</p>
<p>有 $10$ 球分给 $4$ 人，甲必须有，方案数。</p>
<p>相当于，</p>
<p>$$
x_1+x_2+x_3+x_4=10
$$</p>
<p>其中 $x_1\ge1$，另 $y_1=x_1-1$，则，</p>
<p>$$
y_1+x_2+x_3+x_4=9
$$</p>
<p>对于非负整数解个数，即，</p>
<p>$$
{12\choose 3}={12\times11\times10\over3\times2\times1}=220
$$</p>
<p>$$
\mathsf{\bold{例题二：配合容斥原理}}
$$</p>
<p>这一部分配合容斥是经典套路了。</p>
<p>题目，$24$ 个小球分给 $3$ 个盒子，要求每个盒子至少一个且互不相同，求方案数。</p>
<p>容易发现，记，</p>
<p>$$
a+b+c=24
$$</p>
<p>答案即为，</p>
<p>$$
\def\card#1{#[#1]}
\card{}-\card{a=b}-\card{a=c}-\card{b=c}+2\times\card{a=b=c}\
$$</p>
<p>注：为了简写，两两不等的省略。我们分别来看，</p>
<p>$$
#[]={23\choose 2}=253\
$$</p>
<p>考虑 $#[x_i=x_j]$ 是多少。</p>
<p>容易发现，即，</p>
<p>$$
2t+x=24
$$</p>
<p>因为都是正整数，因此，</p>
<p>$$
t\in(0,12)
$$</p>
<p>共有 $11$ 种，因此，</p>
<p>$$
\def\card#1{#[#1]}
\card{a=b}=\card{b=c}=\card{a=c}=11\
$$</p>
<p>而，</p>
<p>$$
#[a=b=c]=1
$$</p>
<p>是显然的；因此，答案，</p>
<p>$$
253-33+2=222
$$</p>
<h3 id="_46">先整体后局部策略</h3>
<p>先把一个集合的位置确定，再确定集合内的。</p>
<p>如果是先确定集合内的，再确定集合整体位置，也可以视为插空法的一般形式。</p>
<p>例题：五个男生和五个女生拍照，要求同性相邻（不是同性恋）的方案数。</p>
<p>首先，我们先排男生和女生的次序 $A(2,2)$。</p>
<p>然后男生内部和女生内部分别有 $A(5,5)$ 的方案。</p>
<p>总答案为 $A(2,2)\times A(5,5)\times A(5,5)$。</p>
<h3 id="_47">正难则反策略</h3>
<p>经典的。</p>
<p>例题：班里 $50$ 人选 $5$ 人出去玩，要求正副班长和团支部书记至少一人在内，方案数。</p>
<p>首先我们正着做肯定是枚举那个人在里面，然后随便选。</p>
<p>但是反着做也很简单，我们考虑没有限制的方案数，</p>
<p>$$
{50\choose 5}
$$</p>
<p>但是有一些是不符合条件的，即三个人都不在，那么这个有多少种方案？</p>
<p>$$
{47\choose 5}
$$</p>
<p>那么减掉，</p>
<p>$$
{50\choose 5}-{47\choose 5}
$$</p>
<p>就是总方案数。</p>
<h3 id="_48">成套思想</h3>
<p>若展开式，</p>
<p>$$
(3x-1)<sup>8=a_8x</sup>8+a_7x^7+\dots+a_1x+a_0
$$</p>
<p>求 $a_8+a_6+a_4+a_2+a_0$。</p>
<p>受到上面的启发，我们考虑设，</p>
<p>$$
A=a_8+a_6+a_4+a_2+a_0
$$</p>
<p>$$
B=a_7+a_5+a_3+a_1
$$</p>
<p>我们考虑求出，</p>
<p>$$
\begin{cases}
A+B=\
A-B=
\end{cases}
$$</p>
<p>就可以了。</p>
<p>下面是一些技巧。</p>
<p>我们知道系数 $a_0\sim a_8$ 都是常数（与 $x$ 无关）且一定对所有有意义的 $x$ 成立。</p>
<p>那么这一位置我们可以随意带入 $x$ 以获得这些数的确切关系，比如，</p>
<p>带入 $x=1$，</p>
<p>$$
2^8=a_8+a_7+\dots+a_0
$$</p>
<p>即，</p>
<p>$$
A+B=256
$$</p>
<p>带入 $x=-1$，</p>
<p>$$
4^8=a_8-a_7+\dots+a_0
$$</p>
<p>即，</p>
<p>$$
A-B=2^{16}=65536
$$</p>
<p>那么，易得，</p>
<p>$$
\begin{cases}
A&amp;=32 896\
B&amp;=−32 640
\end{cases}
$$</p>
<h4 id="_49">证明整除问题</h4>
<hr />
<p><strong>例题一</strong></p>
<p>$$
\begin{aligned}
(n+1)<sup>n-1&amp;={n\choose1}n+{n\choose2}n</sup>2+\dots+{n\choose n}n^n\
&amp;=n<sup>2+{n\choose2}n</sup>2+\dots+{n\choose n}n^n
\end{aligned}
$$</p>
<p>可以被 $n^2$ 整除。</p>
<hr />
<p><strong>例题二</strong></p>
<p>我们尝试一些抽象的方法，</p>
<p>$$
99<sup 10="10">{10}-1\equiv(-1)</sup>
$$}-1\equiv1^5-1\equiv0\pmod{100</p>
<p>好玩（</p>
<hr />
<p><strong>例题三</strong></p>
<p>我们尝试一些可爱的方法，</p>
<p>$$
55<sup 55="55">{55}+9\equiv7</sup>+1\equiv0\pmod8
$$}+1\equiv(-1)^{55</p>
<p>好玩（</p>
<p>啊这跑题了（二项式定理哭哭）。</p>
<p>其实一个比较直观的理解方式，就是下面写成待遇出发，</p>
<p>$$
a=qm+r,r\in[0,m)
$$</p>
<p>的形式，那么二项式定理，后面所有项都有模数的倍数，消去即得。</p>
<hr />
<h4 id="_50">伯努利不等式</h4>
<p>简单形式，对于实数 $x\ge-1$，</p>
<ul>
<li>若 $n\ge1$，则 $(1+x)^n\ge1+nx$；</li>
<li>若 $0\le n\le1$，则 $(1+x)^n\le1+nx$。</li>
</ul>
<p>可以看到等号成立当且仅当 $n = 0,1$ 或 $x = 0$ 时。</p>
<p>二项式定理展开丢掉后面的项即可。</p>
<h3 id="_51">倍缩法和可重策略</h3>
<p>例题：$7$ 个人排队，甲乙丙顺序一定的情况下的方案数。</p>
<p>也可以鉴定为，甲乙丙顺序不重要的方案数。</p>
<p>我们可以用 $7$ 个人排列的方案数，除去甲乙丙的方案数。</p>
<p>意义就是，排列完 $A(7,7)$，每 $A(3,3)$ 个就可以分为一组，</p>
<p>这一组内，除甲乙丙外顺序相同。</p>
<p>对于这若干个组，除去这个 $A(3,3)$ 就是答案，</p>
<p>$$
{A(7,7)\over A(3,3)}=A(7,4)=7\times6\times5\times4=840
$$</p>
<p>可重集会具体讲。</p>
<h3 id="_52">多排问题直排策略</h3>
<p>六个人照相排队，分两排，每排三人，共有几种排队方式。</p>
<p>Solution 1：先选三人，排列；剩下三人排列。</p>
<p>$$
\begin{aligned}
C(6,3)A(3,3)A(3,3)\
={6\times5\times4\over3\times2\times1}\times3\times2\times1\times3\times2\times1\
=6\times5\times4\times3\times2\times1=720
\end{aligned}
$$</p>
<p>Solution 2：注意到等价于六个人排列，后三个自动补到后一排。</p>
<p>$$
A(6,6)=6\times5\times4\times3\times2\times1=720
$$</p>
<p>总结：这种分组但是每组有区别的，可以合在一起考虑。</p>
<h3 id="_53">模型和穷举策略</h3>
<p>模型，即将问题归纳为多个已有模型的组合。</p>
<p>穷举，即枚举，一般是结合先分组再分配、特殊优先处理。</p>
<h3 id="_54">模型一：排数问题</h3>
<p>例题：用 $0\sim9$ 可以排成多少个，</p>
<hr />
<p><strong>不同的三位数</strong>：</p>
<p>Sol1：$999-100+1=900$。<br />
Sol2：$9\times10\times10=900$，即第一位除了 $0$，后面随意。</p>
<hr />
<p><strong>没有重复数字的三位数</strong>：</p>
<p>Sol：$9\times9\times8=648$。</p>
<hr />
<p><strong>没有重复数字的三位奇／偶数</strong>：</p>
<p>奇数：最后一位 $1,3,5,7,9$。<br />
共有 $5\times8\times8=320$ 种数字。</p>
<p>偶数：最后一位 $0,2,4,6,8$。<br />
若是 $0$，有 $9\times8=72$ 种数字。<br />
否则 $4\times8\times8=256$ 种数字。<br />
共有 $72+256=328$ 种数字。</p>
<hr />
<p>加强：<strong>没有重复数字的 $&gt;300$ 的三位偶数</strong>：</p>
<p>Sol：正难则反，用 $328$ 减去小于等于的。</p>
<p>第一位 $1$：$5\times8=40$；<br />
第一位 $2$：$4\times8=32$。</p>
<p>答案：$328-40-32=256$。</p>
<hr />
<h3 id="_55">模型二：球盒模型</h3>
<p>注：因为作者懒得改下面不严谨的地方了，没有说明默认不考虑无解的情况（方案数为零）。</p>
<h4 id="_56">题型一：平均分配</h4>
<p>九个小球分给三个人，求方案数。</p>
<ul>
<li>若人和球都不同。</li>
</ul>
<p>第一个人选 $3$ 个，第二个人从剩下的 $6$ 中中选……</p>
<p>$$
{9\choose3}{6\choose3}{3\choose3}
$$</p>
<p>也记为，</p>
<p>$$
{9\choose3,3,3}
$$</p>
<ul>
<li>若人相同，球不同。</li>
</ul>
<p>注意到相当于人球不同中，每 $A(3,3)$ 个对应一个有效情况。</p>
<p>因此，答案为，</p>
<p>$$
{9\choose3,3,3}\bigg/\begin{matrix}\A(3,3)\end{matrix}
$$</p>
<ul>
<li>若人和球都相同。</li>
</ul>
<p>那么只有一种情况就是每人三个球呗。</p>
<ul>
<li>若人不同，球相同。</li>
</ul>
<p>那么只有一种情况就是每人三个球呗（？</p>
<h4 id="_57">题型二：不完全平均分配</h4>
<p>七球三人，一人 $3$ 球，其他人 $2$ 球，求方案数。</p>
<ul>
<li>若人和球都不同。</li>
</ul>
<p>我们随便类比，答案为，</p>
<p>$$
{7\choose3,2,2}
$$</p>
<p>注意到一定不存在重复。</p>
<ul>
<li>若人相同，球不同。</li>
</ul>
<p>注意到只有大小相同的集合会重复。</p>
<p>具体的，若一个人选了集合 $A$，另一个人选了 $B$。</p>
<p>那么，当且仅当 $|A|=|B|$ 时，交换 $A,B$ 才是等价的。</p>
<p>也就是说我们除去这个数字的大小的 $|A|!$ 才是最终答案。</p>
<p>容易发现我们上一个模型中，除去的 $A(3,3)$ 本质也是一样的。</p>
<p>也就是说上一个模型本质是这个模型的一个子集。</p>
<p>说了这么半天写一下公式把，</p>
<p>$$
{7\choose3,2,2}\bigg/\begin{matrix}\A(2,2)\end{matrix}
$$</p>
<ul>
<li>其他：显然为 $1$ 哦。</li>
</ul>
<h4 id="_58">题型三：完全不平均分配</h4>
<p>本质还是上面的子集，但是注意到 $A(1,1)=1$ 罢了。</p>
<h4 id="_59">题型四：十二重计数法选讲</h4>
<p>有 $n$ 个球，放到 $m$ 个盒子中，求方案数。</p>
<hr />
<p><strong>I. 球不同，盒子不同，无其他限制</strong></p>
<p>每个球可以放到不同的 $m$ 个盒子中，因此答案为，</p>
<p>$$
m^n
$$</p>
<hr />
<p><strong>II. 球不同，盒子不同，每个盒子至多装一个球</strong></p>
<p>显然若 $n&gt;m$ 则无解。</p>
<p>否则，注意到相当于在 $m$ 个盒子中选择 $n$ 个来放球，</p>
<p>$$
C(m,n)P(n,n)=P(m,n)=m^{\underline n}
$$</p>
<p>先分组再分配策略，也可以理解按照顺序每个球可行位置递减。</p>
<hr />
<p><strong>III. 球不同，盒子不同，每个盒子至少装一个球</strong></p>
<p>我们强令 $i$ 个盒子为空，其他盒子无限制。</p>
<p>那么我们容斥，</p>
<p>$$
\sum_{i=0}<sup>m(-1)</sup>i{m\choose i}(m-i)^n
$$</p>
<p>就是答案。</p>
<p>具体的，减去有空的，但是重复了，因此容斥。</p>
<hr />
<p><strong>IV. 球不同，盒子相同，无其他限制</strong></p>
<p>第二类斯特林数 · 行，本文不讲。</p>
<hr />
<p><strong>V. 球不同，盒子相同，每个盒子至多装一个球</strong></p>
<p>注意到答案即为，</p>
<p>$$
[n\le m]
$$</p>
<p>用艾佛森括号表示。</p>
<hr />
<p><strong>VI. 球不同，盒子相同，每个盒子至少装一个球</strong></p>
<p>第二类斯特林数板子题，本文不讲。</p>
<hr />
<p><strong>VII. 球相同，盒子不相同，无其他限制</strong></p>
<p>插板法，</p>
<p>$$
{n+m-1\choose m-1}
$$</p>
<p>即为答案。</p>
<hr />
<p><strong>VIII. 球相同，盒子不相同，每个盒子至多装一个球</strong></p>
<p>我们要选出来 $n$ 个盒子装球，其他的不装球，</p>
<p>$$
{m\choose n}
$$</p>
<p>即为答案。</p>
<hr />
<p><strong>IX. 球相同，盒子不相同，每个盒子至少装一个球</strong></p>
<p>插板法，</p>
<p>$$
{n-1\choose m-1}
$$</p>
<p>即为答案。</p>
<hr />
<p><strong>X. 球相同，盒子相同，无其他限制</strong></p>
<p>划分数问题，过于抽象，不讲。</p>
<hr />
<p><strong>XI. 球相同，盒子相同，每个盒子至多装一个球</strong></p>
<p>和 V. 一样，答案为，</p>
<p>$$
[n\le m]
$$</p>
<p>用艾佛森括号表示。</p>
<hr />
<p><strong>XII. 球相同，盒子相同，每个盒子至少装一个球</strong></p>
<p>同为划分数，不讲。</p>
<h2 id="_60">组合数大型运算推导</h2>
<p>下面默认 $n$ 是任意自然数，一般 $k\le n$。</p>
<hr />
<p>例题一，证明：</p>
<p>$$
\sum_{i=0}<sup>k(-1)</sup>i{n\choose i}=(-1)^k{n-1\choose k}
$$</p>
<p>对于 $n&lt;k$，且 $n,k$ 都是正整数。</p>
<p>很多题解使用了数学归纳法，这里用了一种比较好的方法：扰动法。</p>
<p>考虑证明，</p>
<p>$$
\begin{aligned}
\sum_{i=0}<sup>k(-1)</sup>i{n\choose i}+(-1)^{k+1}{n\choose k+1}&amp;=1+\sum_{i=0}<sup i_1="i+1">k(-1)</sup>\
&amp;=1-\sum_{i=0}}{n\choose i+1<sup>k(-1)</sup>i{n\choose i+1}
\end{aligned}
$$</p>
<p>我们似乎没有思路了，但是注意到，</p>
<p>$$
{n\choose i}+{n\choose i+1}={n+1\choose i+1}
$$</p>
<p>于是，我们移项，</p>
<p>$$
\begin{aligned}
\sum_{i=0}<sup>k(-1)</sup>i{n+1\choose i+1}&amp;=1-(-1)^{k+1}{n\choose k+1}\
\sum_{i=1}<sup i-1="i-1">{k+1}(-1)</sup>\
\sum_{i=1}}{n+1\choose i}&amp;=1-(-1)^{k+1}{n\choose k+1<sup>{k+1}(-1)</sup>i{n+1\choose i}&amp;=-1+(-1)^{k+1}{n\choose k+1}\
\sum_{i=0}<sup>{k+1}(-1)</sup>i{n+1\choose i}&amp;=(-1)^{k+1}{n\choose k+1}\
\end{aligned}
$$</p>
<p>我们令 $n\gets n-1,k\gets k-1$，得，</p>
<p>$$
\begin{aligned}
\sum_{i=0}<sup>k(-1)</sup>i{n\choose i}&amp;=(-1)^k{n-1\choose k}\
\end{aligned}
$$</p>
<p>得证。</p>
<hr />
<p>例题二，证明：</p>
<p>$$
\sum_{k=0}^n{1\over k+1}{n\choose k}={1\over n+1}(2^{n+1}-1)
$$</p>
<p>我们考虑展开里面，</p>
<p>$$
{1\over k+1}{n\choose k}={n!\over(k+1)!(n-k)!}={1\over n+1}\cdot{n+1\choose k+1}
$$</p>
<p>那么我们推导，</p>
<p>$$
\sum_{k=0}^n{1\over k+1}{n\choose k}={1\over n+1}\sum_{k=0}^n{n+1\choose k+1}
$$</p>
<p>我们另 $t=n+1$，右侧变为，</p>
<p>$$
{1\over t}\sum_{k=1}^t{t\choose k}={1\over t}(2^t-1)
$$</p>
<p>重新放回去，即得，</p>
<p>$$
\sum_{k=0}^n{1\over k+1}{n\choose k}={1\over n+1}(2^{n+1}-1)
$$</p>
<hr />
<p>例题三，证明：</p>
<p>$$
\sum_{k=0}<sup>n{(-1)</sup>k\over k+1}{n\choose k}={1\over n+1}
$$</p>
<p>我们根据上一题的结论，</p>
<p>$$
\sum_{k=0}<sup>n{(-1)</sup>k\over k+1}{n\choose k}={1\over n+1}\sum_{k=0}<sup>n(-1)</sup>k{n+1\choose k+1}
$$</p>
<p>继续另 $t=n+1$，右侧变为，</p>
<p>$$
{1\over t}\sum_{k=1}<sup k-1="k-1">t(-1)</sup>}{t\choose k}={1\over t}\left[\sum_{k=0<sup k-1="k-1">t(-1)</sup>
$$}{t\choose k}\right]+{1\over t</p>
<p>根据二项式定理，</p>
<p>$$
(a+1)<sup>t=\sum_{k=0}</sup>ta^k{t\choose k}
$$</p>
<p>带入 $a=-1$，得，</p>
<p>$$
\sum_{k=0}<sup>t(-1)</sup>k{t\choose k}=[t=0]
$$</p>
<p>我们知道 $t&gt;n\ge0$，即右侧一定为 $0$，即，</p>
<p>$$
\sum_{k=0}<sup>n{(-1)</sup>k\over k+1}{n\choose k}={1\over n+1}
$$</p>
<!-- 数学 -->
<!-- 物理 -->
<!-- 化学 -->
<!-- 生物 -->
<!-- 教育 -->
<!-- 联合国与国际机构 -->
<!-- 欧洲联盟与地区组织 -->
</article>